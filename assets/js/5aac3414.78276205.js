"use strict";(globalThis.webpackChunkdoqumentation=globalThis.webpackChunkdoqumentation||[]).push([[8047],{36159(s,e,a){a.r(e),a.d(e,{assets:()=>m,contentTitle:()=>r,default:()=>o,frontMatter:()=>l,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"tutorials/quantum-phase-estimation-qctrl","title":"Quantum Phase Estimation with Q-CTRL\'s Qiskit Functions","description":"Implement Quantum Phase Estimation algorithm on 35 qubits using Q-CTRL Qiskit Function","source":"@site/i18n/tl/docusaurus-plugin-content-docs/current/tutorials/quantum-phase-estimation-qctrl.mdx","sourceDirName":"tutorials","slug":"/tutorials/quantum-phase-estimation-qctrl","permalink":"/tutorials/quantum-phase-estimation-qctrl","draft":false,"unlisted":false,"editUrl":"https://github.com/JanLahmann/doQumentation/tree/main/docs/tutorials/quantum-phase-estimation-qctrl.mdx","tags":[],"version":"current","frontMatter":{"title":"Quantum Phase Estimation with Q-CTRL\'s Qiskit Functions","sidebar_label":"Quantum Phase Estimation with Q-CTRL\'s Qiskit Functions","description":"Implement Quantum Phase Estimation algorithm on 35 qubits using Q-CTRL Qiskit Function","notebook_path":"docs/tutorials/quantum-phase-estimation-qctrl.ipynb"},"sidebar":"tutorialsSidebar","previous":{"title":"Transverse-Field Ising Model with Q-CTRL\'s Performance Management","permalink":"/tutorials/transverse-field-ising-model"},"next":{"title":"Solve the Market Split problem with Kipu Quantum\'s Iskay Quantum Optimizer","permalink":"/tutorials/solve-market-split-problem-with-iskay-quantum-optimizer"}}');var i=a(74848),t=a(28453);const l={title:"Quantum Phase Estimation with Q-CTRL's Qiskit Functions",sidebar_label:"Quantum Phase Estimation with Q-CTRL's Qiskit Functions",description:"Implement Quantum Phase Estimation algorithm on 35 qubits using Q-CTRL Qiskit Function",notebook_path:"docs/tutorials/quantum-phase-estimation-qctrl.ipynb"},r=void 0,m={},c=[{value:"Background",id:"background",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Setup",id:"setup",level:2},{value:"Step 1: Map classical inputs to a quantum problem",id:"step-1-map-classical-inputs-to-a-quantum-problem",level:2},{value:"Step 2: Optimize problem for quantum hardware execution",id:"step-2-optimize-problem-for-quantum-hardware-execution",level:2},{value:"Step 3: Execute using Qiskit primitives",id:"step-3-execute-using-qiskit-primitives",level:2},{value:"Run MPS simulation",id:"run-mps-simulation",level:3},{value:"Run on hardware",id:"run-on-hardware",level:3},{value:"Run on hardware with Fire Opal",id:"run-on-hardware-with-fire-opal",level:3},{value:"Step 4: Post-process and return result in desired classical format",id:"step-4-post-process-and-return-result-in-desired-classical-format",level:2},{value:"References",id:"references",level:2},{value:"Tutorial survey",id:"tutorial-survey",level:2}];function h(s){const e={a:"a",admonition:"admonition",annotation:"annotation",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mspace:"mspace",mstyle:"mstyle",msup:"msup",mtable:"mtable",mtd:"mtd",mtext:"mtext",mtr:"mtr",p:"p",pre:"pre",semantics:"semantics",span:"span",ul:"ul",...(0,t.R)(),...s.components},{OpenInLabBanner:n}=e;return n||function(s,e){throw new Error("Expected "+(e?"component":"object")+" `"+s+"` to be defined: you likely forgot to import, pass, or provide it.")}("OpenInLabBanner",!0),(0,i.jsxs)(i.Fragment,{children:["\n",(0,i.jsx)(e.admonition,{title:"Hindi pa naisalin",type:"note",children:(0,i.jsx)(e.p,{children:"Ang pahinang ito ay hindi pa naisalin. Nakikita mo ang orihinal na bersyon sa Ingles."})}),"\n",(0,i.jsx)(n,{notebookPath:"docs/tutorials/quantum-phase-estimation-qctrl.ipynb"}),"\n","\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"Usage estimate: 40 seconds on a Heron r2 processor. (NOTE: This is an estimate only. Your runtime may vary.)"})}),"\n",(0,i.jsx)(e.h2,{id:"background",children:"Background"}),"\n",(0,i.jsxs)(e.p,{children:["Quantum Phase Estimation (QPE) is a foundational algorithm in quantum computing that forms the basis of many important applications such as Shor\u2019s algorithm, quantum chemistry ground-state energy estimation, and eigenvalue problems.  QPE estimates the phase ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"\u03c6"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\varphi"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"\u03c6"})]})})]})," associated with an eigenstate of a unitary operator, encoded in the relation"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"U"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u2223"}),(0,i.jsx)(e.mi,{children:"\u03c6"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mn,{children:"2"}),(0,i.jsx)(e.mi,{children:"\u03c0"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"\u03c6"})]})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u2223"}),(0,i.jsx)(e.mi,{children:"\u03c6"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"}),(0,i.jsx)(e.mo,{separator:"true",children:","})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"U \\lvert \\varphi \\rangle = e^{2\\pi i \\varphi} \\lvert \\varphi \\rangle,"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,i.jsx)(e.span,{className:"mopen",children:"\u2223"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"\u03c6"}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0747em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8247em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",children:"2"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"\u03c0i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"\u03c6"})]})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"\u2223"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"\u03c6"}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"}),(0,i.jsx)(e.span,{className:"mpunct",children:","})]})]})]})}),"\n",(0,i.jsxs)(e.p,{children:["and determines it to a precision of ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"\u03f5"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"O"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mn,{children:"2"}),(0,i.jsx)(e.mi,{children:"m"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\epsilon = O(1/2^m)"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"\u03f5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord",children:"1/"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord",children:"2"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.6644em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"m"})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]})," using ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"m"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"m"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"m"})]})})]})," counting qubits ",(0,i.jsx)(e.a,{href:"#references",children:"[1]"}),". By preparing these qubits in superposition, applying controlled powers of ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"U"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"U"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"})]})})]}),", and then using the inverse Quantum Fourier Transform (QFT) to extract the phase into binary-encoded measurement outcomes, QPE produces a probability distribution peaked at bitstrings whose binary fractions approximate ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"\u03c6"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\varphi"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"\u03c6"})]})})]}),". In the ideal case, the most likely measurement outcome directly corresponds to the binary expansion of the phase, while the probability of other outcomes decreases rapidly with the number of counting qubits. However, running deep QPE circuits on hardware presents challenges: the large number of qubits and entangling operations make the algorithm highly sensitive to decoherence and gate errors. This results in broadened and shifted distributions of bitstrings, masking the true eigenphase. As a consequence, the bitstring with the highest probability may no longer correspond to the correct binary expansion of  ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"\u03c6"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\varphi"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"\u03c6"})]})})]}),"."]}),"\n",(0,i.jsxs)(e.p,{children:["In this tutorial, we present an implementation of the QPE algorithm using Q-CTRL's Fire Opal error suppression and performance management tools, offered as a Qiskit Function (see the ",(0,i.jsx)(e.a,{href:"/guides/q-ctrl-performance-management",children:"Fire Opal documentation"}),"). Fire Opal automatically applies advanced optimizations, including dynamical decoupling, qubit layout improvements, and error suppression techniques, resulting in higher-fidelity outcomes. These improvements bring hardware bitstring distributions closer to those obtained in noiseless simulations, so that you can reliably identify the correct eigenphase even under the effects of noise."]}),"\n",(0,i.jsx)(e.h2,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsx)(e.p,{children:"Before starting this tutorial, be sure you have the following installed:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Qiskit SDK v1.4 or later, with ",(0,i.jsx)(e.a,{href:"https://docs.quantum.ibm.com/api/qiskit/visualization",children:"visualization"})," support"]}),"\n",(0,i.jsxs)(e.li,{children:["Qiskit Runtime v0.40 or later (",(0,i.jsx)(e.code,{children:"pip install qiskit-ibm-runtime"}),")"]}),"\n",(0,i.jsxs)(e.li,{children:["Qiskit Functions Catalog v0.9.0 (",(0,i.jsx)(e.code,{children:"pip install qiskit-ibm-catalog"}),")"]}),"\n",(0,i.jsxs)(e.li,{children:["Fire Opal SDK v9.0.2 or later (",(0,i.jsx)(e.code,{children:"pip install fire-opal"}),")"]}),"\n",(0,i.jsxs)(e.li,{children:["Q-CTRL Visualizer v8.0.2 or later (",(0,i.jsx)(e.code,{children:"pip install qctrl-visualizer"}),")"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"setup",children:"Setup"}),"\n",(0,i.jsxs)(e.p,{children:["First, authenticate using your ",(0,i.jsx)(e.a,{href:"http://quantum.cloud.ibm.com/",children:"IBM Quantum API key"}),". Then, select the Qiskit Function as follows. (This code assumes you've already ",(0,i.jsx)(e.a,{href:"/guides/functions#install-qiskit-functions-catalog-client",children:"saved your account"})," to your local environment.)"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# Added by doQumentation \u2014 installs packages not in the Binder environment\n%pip install -q qctrlvisualizer\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from qiskit import QuantumCircuit\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport qiskit\nfrom qiskit import qasm2\nfrom qiskit_aer import AerSimulator\nfrom qiskit_ibm_runtime import QiskitRuntimeService\nfrom qiskit_ibm_runtime import SamplerV2 as Sampler\nfrom qiskit.transpiler.preset_passmanagers import generate_preset_pass_manager\nimport qctrlvisualizer as qv\nfrom qiskit_ibm_catalog import QiskitFunctionsCatalog\n\nplt.style.use(qv.get_qctrl_style())\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'catalog = QiskitFunctionsCatalog(channel="ibm_quantum_platform")\n\n# Access Function\nperf_mgmt = catalog.load("q-ctrl/performance-management")\n'})}),"\n",(0,i.jsx)(e.h2,{id:"step-1-map-classical-inputs-to-a-quantum-problem",children:"Step 1: Map classical inputs to a quantum problem"}),"\n",(0,i.jsx)(e.p,{children:"In this tutorial, we illustrate QPE to recover the eigenphase of a known single-qubit unitary. The unitary whose phase we want to estimate is the single-qubit phase gate applied to the target qubit:"}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"U"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"\u03b8"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{fence:"true",children:"("}),(0,i.jsxs)(e.mtable,{rowspacing:"0.16em",columnalign:"center center",columnspacing:"1em",children:[(0,i.jsxs)(e.mtr,{children:[(0,i.jsx)(e.mtd,{children:(0,i.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,i.jsx)(e.mn,{children:"1"})})}),(0,i.jsx)(e.mtd,{children:(0,i.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,i.jsx)(e.mn,{children:"0"})})})]}),(0,i.jsxs)(e.mtr,{children:[(0,i.jsx)(e.mtd,{children:(0,i.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,i.jsx)(e.mn,{children:"0"})})}),(0,i.jsx)(e.mtd,{children:(0,i.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"\u03b8"})]})]})})})]})]}),(0,i.jsx)(e.mo,{fence:"true",children:")"})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"\u03b8"}),(0,i.jsx)(e.mtext,{children:"\u2009"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"}),(0,i.jsx)(e.mtext,{children:"\u2009\u2063"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"})]})]}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"U(\\theta)=\n\\begin{pmatrix}\n1 & 0\\\\[2pt]\n0 & e^{i\\theta}\n\\end{pmatrix}\n= e^{i\\theta\\,|1\\rangle\\!\\langle 1|}."})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"\u03b8"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.6091em",verticalAlign:"-1.0546em"}}),(0,i.jsxs)(e.span,{className:"minner",children:[(0,i.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mtable",children:[(0,i.jsx)(e.span,{className:"col-align-c",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.5546em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3.7146em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord",children:"1"})})]}),(0,i.jsxs)(e.span,{style:{top:"-2.3054em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord",children:"0"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"1.0546em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"arraycolsep",style:{width:"0.5em"}}),(0,i.jsx)(e.span,{className:"arraycolsep",style:{width:"0.5em"}}),(0,i.jsx)(e.span,{className:"col-align-c",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.5546em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3.7146em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord",children:"0"})})]}),(0,i.jsxs)(e.span,{style:{top:"-2.3054em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8491em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"\u03b8"})]})})]})})})})})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"1.0546em"},children:(0,i.jsx)(e.span,{})})})]})})]})}),(0,i.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:")"})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.938em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.938em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"\u03b8"}),(0,i.jsx)(e.span,{className:"mspace mtight",style:{marginRight:"0.1952em"}}),(0,i.jsx)(e.span,{className:"mord mtight",children:"\u22231"}),(0,i.jsx)(e.span,{className:"mclose mtight",children:"\u27e9"}),(0,i.jsx)(e.span,{className:"mspace mtight",style:{marginRight:"-0.1952em"}}),(0,i.jsx)(e.span,{className:"mopen mtight",children:"\u27e8"}),(0,i.jsx)(e.span,{className:"mord mtight",children:"1\u2223"})]})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mord",children:"."})]})]})]})}),"\n",(0,i.jsxs)(e.p,{children:["We prepare its eigenstate ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,i.jsx)(e.mi,{children:"\u03c8"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"|\\psi\\rangle=|1\\rangle"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u2223"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c8"}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u22231"}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})]})]}),". Because ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"|1\\rangle"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u22231"}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})})]})," is an eigenvector of ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"U"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"\u03b8"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"U(\\theta)"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"\u03b8"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})})]})," with eigenvalue ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"\u03b8"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"e^{i\\theta}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8491em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8491em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"\u03b8"})]})})]})})})})})]})]})})]}),", the eigenphase to be estimated is:"]}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"\u03c6"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsx)(e.mi,{children:"\u03b8"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mn,{children:"2"}),(0,i.jsx)(e.mi,{children:"\u03c0"})]})]}),(0,i.jsx)(e.mspace,{}),(0,i.jsx)(e.mspace,{width:"1em"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"m"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"o"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"d"})]}),(0,i.jsx)(e.mspace,{width:"0.3333em"}),(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\varphi = \\frac{\\theta}{2\\pi} \\pmod{1}"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"\u03c6"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.0574em",verticalAlign:"-0.686em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord",children:"2"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c0"})]})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"\u03b8"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mspace allowbreak"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"1em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord mathrm",children:"mod"})})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.3333em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,i.jsxs)(e.p,{children:["We set ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"\u03b8"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mn,{children:"6"})]}),(0,i.jsx)(e.mo,{children:"\u22c5"}),(0,i.jsx)(e.mn,{children:"2"}),(0,i.jsx)(e.mi,{children:"\u03c0"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\theta=\\tfrac{1}{6}\\cdot 2\\pi"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"\u03b8"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.1901em",verticalAlign:"-0.345em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.8451em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"6"})})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"1"})})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.345em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"2"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c0"})]})]})]}),", so the ground-truth phase is ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"\u03c6"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,i.jsx)(e.mn,{children:"6"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\varphi=1/6"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"\u03c6"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1/6"})]})]})]}),". The QPE circuit implements the controlled powers ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"U"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mn,{children:"2"}),(0,i.jsx)(e.mi,{children:"k"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"U^{2^k}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0119em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"1.0119em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",children:"2"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.927em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.931em",marginRight:"0.0714em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"})})]})})})})})]})})})]})})})})})]})]})})]})," by applying controlled phase rotations with angles ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"\u03b8"}),(0,i.jsx)(e.mo,{children:"\u22c5"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mn,{children:"2"}),(0,i.jsx)(e.mi,{children:"k"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\theta\\cdot2^k"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"\u03b8"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8491em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord",children:"2"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8491em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"})})]})})})})})]})]})]})]}),", then applies the inverse QFT to the counting register and measures it. The resulting bitstrings concentrate around the binary representation of ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,i.jsx)(e.mn,{children:"6"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"1/6"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1/6"})]})})]}),"."]}),"\n",(0,i.jsxs)(e.p,{children:["The circuit uses ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"m"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"m"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"m"})]})})]})," counting qubits (to set the estimation precision) plus one target qubit. We begin by defining the building blocks needed to implement QPE: the Quantum Fourier Transform (QFT) and its inverse, utility functions to map between decimal and binary fractions of the eigenphase, and helpers to normalize raw counts into probabilities for comparing simulation and hardware results."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def inverse_quantum_fourier_transform(quantum_circuit, number_of_qubits):\n    """\n    Apply an inverse Quantum Fourier Transform the first `number_of_qubits` qubits in the\n    `quantum_circuit`.\n    """\n    for qubit in range(number_of_qubits // 2):\n        quantum_circuit.swap(qubit, number_of_qubits - qubit - 1)\n    for j in range(number_of_qubits):\n        for m in range(j):\n            quantum_circuit.cp(-np.pi / float(2 ** (j - m)), m, j)\n        quantum_circuit.h(j)\n    return quantum_circuit\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def bitstring_count_to_probabilities(data, shot_count):\n    """\n    This function turns an unsorted dictionary of bitstring counts into a sorted dictionary\n    of probabilities.\n    """\n    # Turn the bitstring counts into probabilities.\n    probabilities = {\n        bitstring: bitstring_count / shot_count\n        for bitstring, bitstring_count in data.items()\n    }\n\n    sorted_probabilities = dict(\n        sorted(probabilities.items(), key=lambda x: x[1], reverse=True)\n    )\n\n    return sorted_probabilities\n'})}),"\n",(0,i.jsx)(e.h2,{id:"step-2-optimize-problem-for-quantum-hardware-execution",children:"Step 2: Optimize problem for quantum hardware execution"}),"\n",(0,i.jsx)(e.p,{children:"We build the QPE circuit by preparing the counting qubits in superposition, applying controlled phase rotations to encode the target eigenphase, and finishing with an inverse QFT before measurement."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def quantum_phase_estimation_benchmark_circuit(\n    number_of_counting_qubits, phase\n):\n    """\n    Create the circuit for quantum phase estimation.\n\n    Parameters\n    ----------\n    number_of_counting_qubits : The number of qubits in the circuit.\n    phase : The desired phase.\n\n    Returns\n    -------\n    QuantumCircuit\n        The quantum phase estimation circuit for `number_of_counting_qubits` qubits.\n    """\n    qc = QuantumCircuit(\n        number_of_counting_qubits + 1, number_of_counting_qubits\n    )\n    target = number_of_counting_qubits\n\n    # |1> eigenstate for the single-qubit phase gate\n    qc.x(target)\n\n    # Hadamards on counting register\n    for q in range(number_of_counting_qubits):\n        qc.h(q)\n\n    # ONE controlled phase per counting qubit: cp(phase * 2**k)\n    for k in range(number_of_counting_qubits):\n        qc.cp(phase * (1 << k), k, target)\n\n    qc.barrier()\n\n    # Inverse QFT on counting register\n    inverse_quantum_fourier_transform(qc, number_of_counting_qubits)\n\n    qc.barrier()\n    for q in range(number_of_counting_qubits):\n        qc.measure(q, q)\n    return qc\n'})}),"\n",(0,i.jsx)(e.h2,{id:"step-3-execute-using-qiskit-primitives",children:"Step 3: Execute using Qiskit primitives"}),"\n",(0,i.jsxs)(e.p,{children:["We set the number of shots and qubits for the experiment, and encode the target phase ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"\u03c6"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,i.jsx)(e.mn,{children:"6"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\varphi = 1/6"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"\u03c6"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1/6"})]})]})]})," using ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"m"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"m"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"m"})]})})]})," binary digits. With these parameters, we build the QPE circuit that will be executed on simulation, default hardware, and Fire Opal\u2013enhanced backends."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"shot_count = 10000\nnum_qubits = 35\nphase = (1 / 6) * 2 * np.pi\ncircuits_quantum_phase_estimation = (\n    quantum_phase_estimation_benchmark_circuit(\n        number_of_counting_qubits=num_qubits, phase=phase\n    )\n)\n"})}),"\n",(0,i.jsx)(e.h3,{id:"run-mps-simulation",children:"Run MPS simulation"}),"\n",(0,i.jsxs)(e.p,{children:["First, we generate a reference distribution using the ",(0,i.jsx)(e.code,{children:"matrix_product_state"})," simulator and convert the counts into normalized probabilities for later comparison with hardware results."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'# Run the algorithm on the IBM Aer simulator.\naer_simulator = AerSimulator(method="matrix_product_state")\n\n# Transpile the circuits for the simulator.\ntranspiled_circuits = qiskit.transpile(\n    circuits_quantum_phase_estimation, aer_simulator\n)\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"simulated_result = (\n    aer_simulator.run(transpiled_circuits, shots=shot_count)\n    .result()\n    .get_counts()\n)\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"simulated_result_probabilities = []\n\nsimulated_result_probabilities.append(\n    bitstring_count_to_probabilities(\n        simulated_result,\n        shot_count=shot_count,\n    )\n)\n"})}),"\n",(0,i.jsx)(e.h3,{id:"run-on-hardware",children:"Run on hardware"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"service = QiskitRuntimeService()\nbackend = service.least_busy(operational=True, simulator=False)\n\npm = generate_preset_pass_manager(backend=backend, optimization_level=3)\nisa_circuits = pm.run(circuits_quantum_phase_estimation)\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# Run the algorithm with IBM default.\nsampler = Sampler(backend)\n\n# Run all circuits using Qiskit Runtime.\nibm_default_job = sampler.run([isa_circuits], shots=shot_count)\n"})}),"\n",(0,i.jsx)(e.h3,{id:"run-on-hardware-with-fire-opal",children:"Run on hardware with Fire Opal"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'# Run the circuit using the sampler\nfire_opal_job = perf_mgmt.run(\n    primitive="sampler",\n    pubs=[qasm2.dumps(circuits_quantum_phase_estimation)],\n    backend_name=backend.name,\n    options={"default_shots": shot_count},\n)\n'})}),"\n",(0,i.jsx)(e.h2,{id:"step-4-post-process-and-return-result-in-desired-classical-format",children:"Step 4: Post-process and return result in desired classical format"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# Retrieve results.\nibm_default_result = ibm_default_job.result()\nibm_default_probabilities = []\n\nfor idx, pub_result in enumerate(ibm_default_result):\n    ibm_default_probabilities.append(\n        bitstring_count_to_probabilities(\n            pub_result.data.c0.get_counts(),\n            shot_count=shot_count,\n        )\n    )\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"fire_opal_result = fire_opal_job.result()\n\nfire_opal_probabilities = []\nfor idx, pub_result in enumerate(fire_opal_result):\n    fire_opal_probabilities.append(\n        bitstring_count_to_probabilities(\n            pub_result.data.c0.get_counts(),\n            shot_count=shot_count,\n        )\n    )\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'data = {\n    "simulation": simulated_result_probabilities,\n    "default": ibm_default_probabilities,\n    "fire_opal": fire_opal_probabilities,\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def plot_distributions(\n    data,\n    number_of_counting_qubits,\n    top_k=None,\n    by="prob",\n    shot_count=None,\n):\n    def nrm(d):\n        s = sum(d.values())\n        return {k: (v / s if s else 0.0) for k, v in d.items()}\n\n    def as_float(d):\n        return {k: float(v) for k, v in d.items()}\n\n    def to_space(d):\n        if by == "prob":\n            return nrm(as_float(d))\n        else:\n            if shot_count and 0.99 <= sum(d.values()) <= 1.01:\n                return {\n                    k: v * float(shot_count) for k, v in as_float(d).items()\n                }\n            else:\n                return as_float(d)\n\n    def topk(d, k):\n        items = sorted(d.items(), key=lambda kv: kv[1], reverse=True)\n        return items[: (k or len(d))]\n\n    phase = "1/6"\n\n    sim = to_space(data["simulation"])\n    dft = to_space(data["default"])\n    qct = to_space(data["fire_opal"])\n\n    correct = max(sim, key=sim.get) if sim else None\n    print("Correct result:", correct)\n\n    sim_items = topk(sim, top_k)\n    dft_items = topk(dft, top_k)\n    qct_items = topk(qct, top_k)\n\n    sim_keys, y_sim = zip(*sim_items) if sim_items else ([], [])\n    dft_keys, y_dft = zip(*dft_items) if dft_items else ([], [])\n    qct_keys, y_qct = zip(*qct_items) if qct_items else ([], [])\n\n    fig, axes = plt.subplots(3, 1, layout="constrained")\n    ylab = "Probabilities"\n\n    def panel(ax, keys, ys, title, color):\n        x = np.arange(len(keys))\n        bars = ax.bar(x, ys, color=color)\n        ax.set_title(title)\n        ax.set_ylabel(ylab)\n        ax.set_xticks(x)\n        ax.set_xticklabels(keys, rotation=90)\n        ax.set_xlabel("Bitstrings")\n        if correct in keys:\n            i = keys.index(correct)\n            bars[i].set_edgecolor("black")\n            bars[i].set_linewidth(2)\n        return max(ys, default=0.0)\n\n    c_sim, c_dft, c_qct = (\n        qv.QCTRL_STYLE_COLORS[5],\n        qv.QCTRL_STYLE_COLORS[1],\n        qv.QCTRL_STYLE_COLORS[0],\n    )\n    m1 = panel(axes[0], list(sim_keys), list(y_sim), "Simulation", c_sim)\n    m2 = panel(axes[1], list(dft_keys), list(y_dft), "Default", c_dft)\n    m3 = panel(axes[2], list(qct_keys), list(y_qct), "Q-CTRL", c_qct)\n\n    for ax, m in zip(axes, (m1, m2, m3)):\n        ax.set_ylim(0, 1.05 * (m or 1.0))\n\n    for ax in axes:\n        ax.label_outer()\n    fig.suptitle(\n        rf"{number_of_counting_qubits} counting qubits, $2\\pi\\varphi$={phase}"\n    )\n    fig.set_size_inches(20, 10)\n    plt.show()\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'experiment_index = 0\nphase_index = 0\n\ndistributions = {\n    "simulation": data["simulation"][phase_index],\n    "default": data["default"][phase_index],\n    "fire_opal": data["fire_opal"][phase_index],\n}\n\nplot_distributions(\n    distributions, num_qubits, top_k=100, by="prob", shot_count=shot_count\n)\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-text",children:"Correct result: 00101010101010101010101010101010101\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Output of the previous code cell",src:a(77249).A+"",width:"1448",height:"728"})}),"\n",(0,i.jsx)(e.p,{children:"The simulation sets the baseline for the correct eigenphase. Default hardware runs show noise that obscures this result, as noise spreads probability across many incorrect bitstrings. With Q-CTRL Performance Management the distribution becomes sharper and the correct outcome is recovered, enabling reliable QPE at this scale."}),"\n",(0,i.jsx)(e.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(e.p,{children:["[1] Lecture 7: ",(0,i.jsx)(e.a,{href:"/learning/courses/fundamentals-of-quantum-algorithms/phase-estimation-and-factoring/introduction",children:"Phase Estimation and Factoring"}),". IBM Quantum Learning - Fundamentals of quantum algorithms. Retrieved October 3, 2025."]}),"\n",(0,i.jsx)(e.h2,{id:"tutorial-survey",children:"Tutorial survey"}),"\n",(0,i.jsx)(e.p,{children:"Please take a minute to provide feedback on this tutorial. Your insights will help us improve our content offerings and user experience."}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.a,{href:"https://your.feedback.ibm.com/jfe/form/SV_3BLFkNVEuh0QBWm",children:"Link to survey"})})]})}function o(s={}){const{wrapper:e}={...(0,t.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(h,{...s})}):h(s)}},77249(s,e,a){a.d(e,{A:()=>n});const n=a.p+"assets/images/593334d2-1-d6424ba12fa0dbf0d839eca7bfeb14e5.avif"},28453(s,e,a){a.d(e,{R:()=>l,x:()=>r});var n=a(96540);const i={},t=n.createContext(i);function l(s){const e=n.useContext(t);return n.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:l(s.components),n.createElement(t.Provider,{value:e},s.children)}}}]);