"use strict";(globalThis.webpackChunkdoqumentation=globalThis.webpackChunkdoqumentation||[]).push([[3880],{74807(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>u,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});const s=JSON.parse('{"id":"guides/create-transpiler-plugin","title":"Create a transpiler plugin","description":"How to create a Qiskit transpiler plugin to share your transpilation code with the Qiskit community.","source":"@site/i18n/tl/docusaurus-plugin-content-docs/current/guides/create-transpiler-plugin.mdx","sourceDirName":"guides","slug":"/guides/create-transpiler-plugin","permalink":"/guides/create-transpiler-plugin","draft":false,"unlisted":false,"editUrl":"https://github.com/JanLahmann/doQumentation/tree/main/docs/guides/create-transpiler-plugin.mdx","tags":[],"version":"current","frontMatter":{"title":"Create a transpiler plugin","sidebar_label":"Create a transpiler plugin","description":"How to create a Qiskit transpiler plugin to share your transpilation code with the Qiskit community.","notebook_path":"docs/guides/create-transpiler-plugin.ipynb"},"sidebar":"tutorialsSidebar","previous":{"title":"Install and use transpiler plugins","permalink":"/guides/transpiler-plugins"},"next":{"title":"Work with DAGs in transpiler passes","permalink":"/guides/DAG-representation"}}');var t=i(74848),a=i(28453),r=i(11470),l=i(19365);const o={title:"Create a transpiler plugin",sidebar_label:"Create a transpiler plugin",description:"How to create a Qiskit transpiler plugin to share your transpilation code with the Qiskit community.",notebook_path:"docs/guides/create-transpiler-plugin.ipynb"},u=void 0,c={},p=[{value:"Example: Create a transpiler stage plugin",id:"example-create-a-transpiler-stage-plugin",level:2},{value:"Example: Create a unitary synthesis plugin",id:"example-create-a-unitary-synthesis-plugin",level:2},{value:"Example: Create a high-level synthesis plugin",id:"example-create-a-high-level-synthesis-plugin",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components},{Admonition:i,Details:s,OpenInLabBanner:o}=n;return i||g("Admonition",!0),s||g("Details",!0),o||g("OpenInLabBanner",!0),(0,t.jsxs)(t.Fragment,{children:["\n",(0,t.jsx)(n.admonition,{title:"Hindi pa naisalin",type:"note",children:(0,t.jsx)(n.p,{children:"Ang pahinang ito ay hindi pa naisalin. Nakikita mo ang orihinal na bersyon sa Ingles."})}),"\n",(0,t.jsx)(o,{notebookPath:"docs/guides/create-transpiler-plugin.ipynb"}),"\n","\n","\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)("b",{children:"Package versions"})}),(0,t.jsx)(n.p,{children:"The code on this page was developed using the following requirements.\nWe recommend using these versions or newer."}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"qiskit[all]~=2.3.0\n"})})]}),"\n",(0,t.jsxs)(n.p,{children:["Creating a ",(0,t.jsx)(n.a,{href:"transpiler-plugins",children:"transpiler plugin"})," is a great way to share your transpilation code with the wider Qiskit community, allowing other users to benefit from the functionality you've developed. Thank you for your interest in contributing to the Qiskit community!"]}),"\n",(0,t.jsx)(n.p,{children:"Before you create a transpiler plugin, you need to decide what kind of plugin is appropriate for your situation. There are three kinds of transpiler plugins:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/transpiler_plugins",children:(0,t.jsx)(n.strong,{children:"Transpiler stage plugin"})}),". Choose this if you are defining a pass manager that can be substituted for one of the ",(0,t.jsx)(n.a,{href:"transpiler-stages",children:"6 stages"})," of a preset staged pass manager."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.UnitarySynthesisPlugin",children:(0,t.jsx)(n.strong,{children:"Unitary synthesis plugin"})}),". Choose this if your transpilation code takes as input a unitary matrix (represented as a Numpy array) and outputs a description of a quantum circuit implementing that unitary."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.HighLevelSynthesisPlugin",children:(0,t.jsx)(n.strong,{children:"High-level synthesis plugin"})}),'. Choose this if your transpilation code takes as input a "high-level object" such as a Clifford operator or a linear function and outputs a description of a quantum circuit implementing that high-level object. High-level objects are represented by subclasses of the ',(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.circuit.Operation",children:"Operation"})," class."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Once you've determined which kind of plugin to create, follow these steps to create the plugin:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Create a subclass of the appropriate abstract plugin class:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.preset_passmanagers.plugin.PassManagerStagePlugin",children:"PassManagerStagePlugin"})," for a transpiler stage plugin,"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.UnitarySynthesisPlugin",children:"UnitarySynthesisPlugin"})," for a unitary synthesis plugin, and"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.HighLevelSynthesisPlugin",children:"HighLevelSynthesisPlugin"}),"  for a high-level synthesis plugin."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Expose the class as a ",(0,t.jsx)(n.a,{href:"https://setuptools.pypa.io/en/latest/userguide/entry_point.html",children:"setuptools entry point"})," in the package metadata, typically by editing the ",(0,t.jsx)(n.code,{children:"pyproject.toml"}),", ",(0,t.jsx)(n.code,{children:"setup.cfg"}),", or ",(0,t.jsx)(n.code,{children:"setup.py"})," file for your Python package."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"There is no limit to the number of plugins a single package can define, but each plugin must have a unique name. The Qiskit SDK itself includes a number of plugins, whose names are also reserved. The reserved names are:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Transpiler stage plugins: See ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/transpiler_plugins#plugin-stages",children:"this table"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Unitary synthesis plugins: ",(0,t.jsx)(n.code,{children:"default"}),", ",(0,t.jsx)(n.code,{children:"aqc"}),", ",(0,t.jsx)(n.code,{children:"sk"})]}),"\n",(0,t.jsx)(n.li,{children:"High-level synthesis plugins:"}),"\n"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Operation class"}),(0,t.jsx)(n.th,{children:"Operation name"}),(0,t.jsx)(n.th,{children:"Reserved names"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.quantum_info.Clifford#clifford",children:"Clifford"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"clifford"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"default"}),", ",(0,t.jsx)(n.code,{children:"ag"}),", ",(0,t.jsx)(n.code,{children:"bm"}),", ",(0,t.jsx)(n.code,{children:"greedy"}),", ",(0,t.jsx)(n.code,{children:"layers"}),", ",(0,t.jsx)(n.code,{children:"lnn"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.circuit.library.LinearFunction#linearfunction",children:"LinearFunction"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"linear_function"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"default"}),", ",(0,t.jsx)(n.code,{children:"kms"}),", ",(0,t.jsx)(n.code,{children:"pmh"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.circuit.library.PermutationGate#permutationgate",children:"PermutationGate"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"permutation"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"default"}),", ",(0,t.jsx)(n.code,{children:"kms"}),", ",(0,t.jsx)(n.code,{children:"basic"}),", ",(0,t.jsx)(n.code,{children:"acg"}),", ",(0,t.jsx)(n.code,{children:"token_swapper"})]})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:["In the next sections, we show examples of these steps for the different types of plugins. In these examples, we assume that we are creating a Python package called ",(0,t.jsx)(n.code,{children:"my_qiskit_plugin"}),". For information on creating Python packages, you can check out ",(0,t.jsx)(n.a,{href:"https://packaging.python.org/en/latest/tutorials/packaging-projects/",children:"this tutorial"})," from the Python website."]}),"\n",(0,t.jsx)(n.h2,{id:"example-create-a-transpiler-stage-plugin",children:"Example: Create a transpiler stage plugin"}),"\n",(0,t.jsxs)(n.p,{children:["In this example, we create a transpiler stage plugin for the ",(0,t.jsx)(n.code,{children:"layout"})," stage (see ",(0,t.jsx)(n.a,{href:"transpiler-stages",children:"Transpiler stages"})," for a description of the 6 stages of Qiskit's built-in transpilation pipeline).\nOur plugin simply runs ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.VF2Layout",children:"VF2Layout"})," for a number of trials that depends on the requested optimization level."]}),"\n",(0,t.jsxs)(n.p,{children:["First, we create a subclass of ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.preset_passmanagers.plugin.PassManagerStagePlugin",children:"PassManagerStagePlugin"}),". There is one method we need to implement, called ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.preset_passmanagers.plugin.PassManagerStagePlugin#pass_manager",children:(0,t.jsx)(n.code,{children:"pass_manager"})}),". This method takes as input a ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.PassManagerConfig",children:"PassManagerConfig"})," and returns the pass manager that we are defining. The PassManagerConfig object stores information about the target backend, such as its coupling map and basis gates."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# This import is needed for python versions prior to 3.10\nfrom __future__ import annotations\n\nfrom qiskit.transpiler import PassManager\nfrom qiskit.transpiler.passes import VF2Layout\nfrom qiskit.transpiler.passmanager_config import PassManagerConfig\nfrom qiskit.transpiler.preset_passmanagers import common\nfrom qiskit.transpiler.preset_passmanagers.plugin import (\n    PassManagerStagePlugin,\n)\n\nclass MyLayoutPlugin(PassManagerStagePlugin):\n    def pass_manager(\n        self,\n        pass_manager_config: PassManagerConfig,\n        optimization_level: int | None = None,\n    ) -> PassManager:\n        layout_pm = PassManager(\n            [\n                VF2Layout(\n                    coupling_map=pass_manager_config.coupling_map,\n                    properties=pass_manager_config.backend_properties,\n                    max_trials=optimization_level * 10 + 1,\n                    target=pass_manager_config.target,\n                )\n            ]\n        )\n        layout_pm += common.generate_embed_passmanager(\n            pass_manager_config.coupling_map\n        )\n        return layout_pm\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Now, we expose the plugin by adding an entry point in our Python package metadata.\nHere, we assume that the class we defined is exposed in a module called ",(0,t.jsx)(n.code,{children:"my_qiskit_plugin"}),", for example by being imported in the ",(0,t.jsx)(n.code,{children:"__init__.py"})," file of the ",(0,t.jsx)(n.code,{children:"my_qiskit_plugin"})," module.\nWe edit the ",(0,t.jsx)(n.code,{children:"pyproject.toml"}),", ",(0,t.jsx)(n.code,{children:"setup.cfg"}),", or ",(0,t.jsx)(n.code,{children:"setup.py"})," file of our package (depending on which kind of file you chose to store your Python project metadata):"]}),"\n",(0,t.jsxs)(r.A,{children:[(0,t.jsx)(l.A,{value:"package-table-toml",label:"pyproject.toml",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",children:'[project.entry-points."qiskit.transpiler.layout"]\n"my_layout" = "my_qiskit_plugin:MyLayoutPlugin"\n'})})}),(0,t.jsx)(l.A,{value:"package-table-cfg",label:"setup.cfg",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ini",children:"[options.entry_points]\nqiskit.transpiler.layout =\n    my_layout = my_qiskit_plugin:MyLayoutPlugin\n"})})}),(0,t.jsx)(l.A,{value:"package-table-py",label:"setup.py",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\n\nsetup(\n    # ...,\n    entry_points={\n        'qiskit.transpiler.layout': [\n            'my_layout = my_qiskit_plugin:MyLayoutPlugin',\n        ]\n    }\n)\n"})})})]}),"\n",(0,t.jsxs)(n.p,{children:["See the ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/transpiler_plugins#stage-table",children:"table of transpiler plugin stages"})," for the entry points and expectations for each transpiler stage."]}),"\n",(0,t.jsxs)(n.p,{children:["To check that your plugin is successfully detected by Qiskit, install your plugin package and follow the instructions at ",(0,t.jsx)(n.a,{href:"transpiler-plugins#list-available-transpiler-stage-plugins",children:"Transpiler plugins"})," for listing installed plugins, and ensure that your plugin appears in the list:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'from qiskit.transpiler.preset_passmanagers.plugin import list_stage_plugins\n\nlist_stage_plugins("layout")\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"['default', 'dense', 'sabre', 'trivial']\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If our example plugin were installed, then the name ",(0,t.jsx)(n.code,{children:"my_layout"})," would appear in this list."]}),"\n",(0,t.jsxs)(n.p,{children:["If you want to use a built-in transpiler stage as the starting point for your transpiler stage plugin, you can obtain the pass manager for a built-in transpiler stage using ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.preset_passmanagers.plugin.PassManagerStagePluginManager#passmanagerstagepluginmanager",children:"PassManagerStagePluginManager"}),". The following code cell shows how to do this to obtain the built-in optimization stage for optimization level 3."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'from qiskit.transpiler.preset_passmanagers.plugin import (\n    PassManagerStagePluginManager,\n)\n\n# Initialize the plugin manager\nplugin_manager = PassManagerStagePluginManager()\n\n# Here we create a pass manager config to use as an example.\n# Instead, you should use the pass manager config that you already received as input\n# to the pass_manager method of your PassManagerStagePlugin.\npass_manager_config = PassManagerConfig()\n\n# Obtain the desired built-in transpiler stage\noptimization = plugin_manager.get_passmanager_stage(\n    "optimization", "default", pass_manager_config, optimization_level=3\n)\n'})}),"\n",(0,t.jsx)(n.h2,{id:"example-create-a-unitary-synthesis-plugin",children:"Example: Create a unitary synthesis plugin"}),"\n",(0,t.jsxs)(n.p,{children:["In this example, we'll create a unitary synthesis plugin that simply uses the built-in ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.UnitarySynthesis#unitarysynthesis",children:"UnitarySynthesis"})," transpilation pass to synthesize a gate. Of course, your own plugin will do something more interesting than that."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.UnitarySynthesisPlugin",children:"UnitarySynthesisPlugin"})," class defines the interface and contract for unitary synthesis\nplugins. The primary method is\n",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.UnitarySynthesisPlugin#run",children:(0,t.jsx)(n.code,{children:"run"})}),",\nwhich takes as input a Numpy array storing a unitary matrix\nand returns a ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.dagcircuit.DAGCircuit",children:"DAGCircuit"})," representing the circuit synthesized from that unitary matrix.\nIn addition to the ",(0,t.jsx)(n.code,{children:"run"})," method, there are a number of property methods that need to be defined.\nSee ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.UnitarySynthesisPlugin",children:"UnitarySynthesisPlugin"})," for documentation of all required properties."]}),"\n",(0,t.jsx)(n.p,{children:"Let's create our UnitarySynthesisPlugin subclass:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import numpy as np\nfrom qiskit.circuit import QuantumCircuit, QuantumRegister\nfrom qiskit.converters import circuit_to_dag\nfrom qiskit.dagcircuit.dagcircuit import DAGCircuit\nfrom qiskit.quantum_info import Operator\nfrom qiskit.transpiler.passes import UnitarySynthesis\nfrom qiskit.transpiler.passes.synthesis.plugin import UnitarySynthesisPlugin\n\nclass MyUnitarySynthesisPlugin(UnitarySynthesisPlugin):\n    @property\n    def supports_basis_gates(self):\n        # Returns True if the plugin can target a list of basis gates\n        return True\n\n    @property\n    def supports_coupling_map(self):\n        # Returns True if the plugin can synthesize for a given coupling map\n        return False\n\n    @property\n    def supports_natural_direction(self):\n        # Returns True if the plugin supports a toggle for considering\n        # directionality of 2-qubit gates\n        return False\n\n    @property\n    def supports_pulse_optimize(self):\n        # Returns True if the plugin can optimize pulses during synthesis\n        return False\n\n    @property\n    def supports_gate_lengths(self):\n        # Returns True if the plugin can accept information about gate lengths\n        return False\n\n    @property\n    def supports_gate_errors(self):\n        # Returns True if the plugin can accept information about gate errors\n        return False\n\n    @property\n    def supports_gate_lengths_by_qubit(self):\n        # Returns True if the plugin can accept information about gate lengths\n        # (The format of the input differs from supports_gate_lengths)\n        return False\n\n    @property\n    def supports_gate_errors_by_qubit(self):\n        # Returns True if the plugin can accept information about gate errors\n        # (The format of the input differs from supports_gate_errors)\n        return False\n\n    @property\n    def min_qubits(self):\n        # Returns the minimum number of qubits the plugin supports\n        return None\n\n    @property\n    def max_qubits(self):\n        # Returns the maximum number of qubits the plugin supports\n        return None\n\n    @property\n    def supported_bases(self):\n        # Returns a dictionary of supported bases for synthesis\n        return None\n\n    def run(self, unitary: np.ndarray, **options) -> DAGCircuit:\n        basis_gates = options["basis_gates"]\n        synth_pass = UnitarySynthesis(basis_gates, min_qubits=3)\n        qubits = QuantumRegister(3)\n        circuit = QuantumCircuit(qubits)\n        circuit.append(Operator(unitary).to_instruction(), qubits)\n        dag_circuit = synth_pass.run(circuit_to_dag(circuit))\n        return dag_circuit\n'})}),"\n",(0,t.jsxs)(n.p,{children:["If you find that the inputs available to the ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.UnitarySynthesisPlugin#run",children:(0,t.jsx)(n.code,{children:"run"})}),"\nmethod are insufficient for your purposes, please ",(0,t.jsx)(n.a,{href:"https://github.com/Qiskit/qiskit/issues/new/choose",children:"open an issue"})," explaining your requirements. Changes to the plugin interface, such as adding additional optional inputs, will be done in a backward compatible way so that they do not require changes from existing plugins."]}),"\n",(0,t.jsx)(i,{type:"note",title:"Note",children:(0,t.jsxs)(n.p,{children:["All methods prefixed with ",(0,t.jsx)(n.code,{children:"supports_"})," are reserved on a ",(0,t.jsx)(n.code,{children:"UnitarySynthesisPlugin"})," derived class as part of the interface. You should not define any custom ",(0,t.jsx)(n.code,{children:"supports_*"})," methods on a subclass that are not defined in the abstract class."]})}),"\n",(0,t.jsxs)(n.p,{children:["Now, we expose the plugin by adding an entry point in our Python package metadata.\nHere, we assume that the class we defined is exposed in a module called ",(0,t.jsx)(n.code,{children:"my_qiskit_plugin"}),", for example by being imported in the ",(0,t.jsx)(n.code,{children:"__init__.py"})," file of the ",(0,t.jsx)(n.code,{children:"my_qiskit_plugin"})," module.\nWe edit the ",(0,t.jsx)(n.code,{children:"pyproject.toml"}),", ",(0,t.jsx)(n.code,{children:"setup.cfg"}),", or ",(0,t.jsx)(n.code,{children:"setup.py"})," file of our package:"]}),"\n",(0,t.jsxs)(r.A,{children:[(0,t.jsx)(l.A,{value:"package-table-toml",label:"pyproject.toml",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",children:'[project.entry-points."qiskit.unitary_synthesis"]\n"my_unitary_synthesis" = "my_qiskit_plugin:MyUnitarySynthesisPlugin"\n'})})}),(0,t.jsx)(l.A,{value:"package-table-cfg",label:"setup.cfg",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ini",children:"[options.entry_points]\nqiskit.unitary_synthesis =\n    my_unitary_synthesis = my_qiskit_plugin:MyUnitarySynthesisPlugin\n"})})}),(0,t.jsx)(l.A,{value:"package-table-py",label:"setup.py",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\n\nsetup(\n    # ...,\n    entry_points={\n        'qiskit.unitary_synthesis': [\n            'my_unitary_synthesis = my_qiskit_plugin:MyUnitarySynthesisPlugin',\n        ]\n    }\n)\n"})})})]}),"\n",(0,t.jsxs)(n.p,{children:["As before, if your project uses ",(0,t.jsx)(n.code,{children:"setup.cfg"})," or ",(0,t.jsx)(n.code,{children:"setup.py"})," instead of ",(0,t.jsx)(n.code,{children:"pyproject.toml"}),", see the ",(0,t.jsx)(n.a,{href:"https://setuptools.pypa.io/en/latest/userguide/entry_point.html",children:"setuptools documentation"})," for how to adapt these lines for your situation."]}),"\n",(0,t.jsxs)(n.p,{children:["To check that your plugin is successfully detected by Qiskit, install your plugin package and follow the instructions at ",(0,t.jsx)(n.a,{href:"transpiler-plugins#list-available-unitary-synthesis-plugins",children:"Transpiler plugins"})," for listing installed plugins, and ensure that your plugin appears in the list:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from qiskit.transpiler.passes.synthesis import unitary_synthesis_plugin_names\n\nunitary_synthesis_plugin_names()\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"['aqc', 'clifford', 'default', 'gridsynth', 'sk']\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If our example plugin were installed, then the name ",(0,t.jsx)(n.code,{children:"my_unitary_synthesis"})," would appear in this list."]}),"\n",(0,t.jsxs)(n.p,{children:["To accommodate unitary synthesis plugins that expose multiple options,\nthe plugin interface has an option for users to provide a free-form\nconfiguration dictionary. This will be passed to the ",(0,t.jsx)(n.code,{children:"run"})," method\nvia the ",(0,t.jsx)(n.code,{children:"options"})," keyword argument. If your plugin has these configuration options, you should clearly document them."]}),"\n",(0,t.jsx)(n.h2,{id:"example-create-a-high-level-synthesis-plugin",children:"Example: Create a high-level synthesis plugin"}),"\n",(0,t.jsxs)(n.p,{children:["In this example, we'll create a high-level synthesis plugin that simply uses the built-in ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/synthesis#synth_clifford_bm",children:"synth_clifford_bm"})," function to synthesize a Clifford operator."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.HighLevelSynthesisPlugin",children:"HighLevelSynthesisPlugin"})," class defines the interface and contract for high-level synthesis plugins. The primary method is ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.HighLevelSynthesisPlugin#run",children:(0,t.jsx)(n.code,{children:"run"})}),".\nThe positional argument ",(0,t.jsx)(n.code,{children:"high_level_object"})," is an ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.circuit.Operation",children:"Operation"}),' representing the "high-level" object to be synthesized. For example, it could be a\n',(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.circuit.library.LinearFunction",children:"LinearFunction"})," or a\n",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.quantum_info.Clifford",children:"Clifford"}),".\nThe following keyword arguments are present:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"target"})," specifies the target backend, allowing the plugin\nto access all target-specific information,\nsuch as the coupling map, the supported gate set, and so on"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"coupling_map"})," only specifies the coupling map, and is only used when ",(0,t.jsx)(n.code,{children:"target"})," is not specified."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"qubits"})," specifies the list of qubits over which the\nhigh-level object is defined, in case the synthesis is done on the physical circuit.\nA value of ",(0,t.jsx)(n.code,{children:"None"})," indicates that the layout has not yet been chosen and the physical qubits in the target or coupling map that this operation is operating on has not yet been determined."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"options"}),", a free-form configuration dictionary for plugin-specific options. If your plugin has these configuration options you\nshould clearly document them."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"run"})," method returns a ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.circuit.QuantumCircuit",children:"QuantumCircuit"}),"\nrepresenting the circuit synthesized from that high-level object.\nIt is also allowed to return ",(0,t.jsx)(n.code,{children:"None"}),", indicating that the plugin is unable to synthesize the given high-level object.\nThe actual synthesis of high-level objects is performed by the\n",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.HighLevelSynthesis",children:"HighLevelSynthesis"}),"\ntranspiler pass."]}),"\n",(0,t.jsxs)(n.p,{children:["In addition to the ",(0,t.jsx)(n.code,{children:"run"})," method, there are a number of property methods that need to be defined.\nSee ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.synthesis.plugin.HighLevelSynthesisPlugin",children:"HighLevelSynthesisPlugin"})," for documentation of all required properties."]}),"\n",(0,t.jsx)(n.p,{children:"Let's define our HighLevelSynthesisPlugin subclass:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from qiskit.synthesis import synth_clifford_bm\nfrom qiskit.transpiler.passes.synthesis.plugin import HighLevelSynthesisPlugin\n\nclass MyCliffordSynthesisPlugin(HighLevelSynthesisPlugin):\n    def run(\n        self,\n        high_level_object,\n        coupling_map=None,\n        target=None,\n        qubits=None,\n        **options,\n    ) -> QuantumCircuit:\n        if high_level_object.num_qubits <= 3:\n            return synth_clifford_bm(high_level_object)\n        else:\n            return None\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This plugin synthesizes objects of type ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.quantum_info.Clifford",children:"Clifford"})," that have\nat most 3 qubits, using the ",(0,t.jsx)(n.code,{children:"synth_clifford_bm"})," method."]}),"\n",(0,t.jsxs)(n.p,{children:["Now, we expose the plugin by adding an entry point in our Python package metadata.\nHere, we assume that the class we defined is exposed in a module called ",(0,t.jsx)(n.code,{children:"my_qiskit_plugin"}),", for example by being imported in the ",(0,t.jsx)(n.code,{children:"__init__.py"})," file of the ",(0,t.jsx)(n.code,{children:"my_qiskit_plugin"})," module.\nWe edit the ",(0,t.jsx)(n.code,{children:"pyproject.toml"}),", ",(0,t.jsx)(n.code,{children:"setup.cfg"}),", or ",(0,t.jsx)(n.code,{children:"setup.py"})," file of our package:"]}),"\n",(0,t.jsxs)(r.A,{children:[(0,t.jsx)(l.A,{value:"package-table-toml",label:"pyproject.toml",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",children:'[project.entry-points."qiskit.synthesis"]\n"clifford.my_clifford_synthesis" = "my_qiskit_plugin:MyCliffordSynthesisPlugin"\n'})})}),(0,t.jsx)(l.A,{value:"package-table-cfg",label:"setup.cfg",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ini",children:"[options.entry_points]\nqiskit.synthesis =\n    clifford.my_clifford_synthesis = my_qiskit_plugin:MyCliffordSynthesisPlugin\n"})})}),(0,t.jsx)(l.A,{value:"package-table-py",label:"setup.py",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\n\nsetup(\n    # ...,\n    entry_points={\n        'qiskit.synthesis': [\n            'clifford.my_clifford_synthesis = my_qiskit_plugin:MyCliffordSynthesisPlugin',\n        ]\n    }\n)\n"})})})]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"name"})," consists of two parts separated by a dot (",(0,t.jsx)(n.code,{children:"."}),"):"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The name of the type of ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.circuit.Operation",children:"Operation"})," that the plugin synthesizes (in this case, ",(0,t.jsx)(n.code,{children:"clifford"}),"). Note that this string corresponds to the ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/api/qiskit/qiskit.circuit.Operation#name",children:(0,t.jsx)(n.code,{children:"name"})})," attribute of the Operation class, and not the name of the class itself."]}),"\n",(0,t.jsxs)(n.li,{children:["The name of the plugin (in this case, ",(0,t.jsx)(n.code,{children:"special"}),")."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["As before, if your project uses ",(0,t.jsx)(n.code,{children:"setup.cfg"})," or ",(0,t.jsx)(n.code,{children:"setup.py"})," instead of ",(0,t.jsx)(n.code,{children:"pyproject.toml"}),", see the ",(0,t.jsx)(n.a,{href:"https://setuptools.pypa.io/en/latest/userguide/entry_point.html",children:"setuptools documentation"})," for how to adapt these lines for your situation."]}),"\n",(0,t.jsxs)(n.p,{children:["To check that your plugin is successfully detected by Qiskit, install your plugin package and follow the instructions at ",(0,t.jsx)(n.a,{href:"transpiler-plugins#list-available-high-level-synthesis-plugins",children:"Transpiler plugins"})," for listing installed plugins, and ensure that your plugin appears in the list:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'from qiskit.transpiler.passes.synthesis import (\n    high_level_synthesis_plugin_names,\n)\n\nhigh_level_synthesis_plugin_names("clifford")\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"['ag', 'bm', 'default', 'greedy', 'layers', 'lnn', 'rb_default']\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If our example plugin were installed, then the name ",(0,t.jsx)(n.code,{children:"my_clifford_synthesis"})," would appear in this list."]}),"\n",(0,t.jsx)(i,{type:"tip",title:"Recommendation",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://github.com/Qiskit/ecosystem?tab=readme-ov-file#how-to-join",children:"Submit your plugin to the Qiskit Ecosystem!"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Check out the ",(0,t.jsx)(n.a,{href:"https://docs.quantum.ibm.com/tutorials",children:"tutorials"})," for examples of transpiling and running quantum circuits."]}),"\n"]})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}function g(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},19365(e,n,i){i.d(n,{A:()=>r});i(96540);var s=i(34164);const t="tabItem_Ymn6";var a=i(74848);function r({children:e,hidden:n,className:i}){return(0,a.jsx)("div",{role:"tabpanel",className:(0,s.A)(t,i),hidden:n,children:e})}},11470(e,n,i){i.d(n,{A:()=>v});var s=i(96540),t=i(34164),a=i(17559),r=i(23104),l=i(56347),o=i(205),u=i(57485),c=i(31682),p=i(70679);function h(e){return s.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function d(e){const{values:n,children:i}=e;return(0,s.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:i,default:s}})=>({value:e,label:n,attributes:i,default:s}))}(i);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,i])}function g({value:e,tabValues:n}){return n.some(n=>n.value===e)}function m({queryString:e=!1,groupId:n}){const i=(0,l.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,u.aZ)(t),(0,s.useCallback)(e=>{if(!t)return;const n=new URLSearchParams(i.location.search);n.set(t,e),i.replace({...i.location,search:n.toString()})},[t,i])]}function f(e){const{defaultValue:n,queryString:i=!1,groupId:t}=e,a=d(e),[r,l]=(0,s.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!g({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const i=n.find(e=>e.default)??n[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:a})),[u,c]=m({queryString:i,groupId:t}),[h,f]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[i,t]=(0,p.Dv)(n);return[i,(0,s.useCallback)(e=>{n&&t.set(e)},[n,t])]}({groupId:t}),y=(()=>{const e=u??h;return g({value:e,tabValues:a})?e:null})();(0,o.A)(()=>{y&&l(y)},[y]);return{selectedValue:r,selectValue:(0,s.useCallback)(e=>{if(!g({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);l(e),c(e),f(e)},[c,f,a]),tabValues:a}}var y=i(92303);const x="tabList__CuJ",j="tabItem_LNqP";var b=i(74848);function _({className:e,block:n,selectedValue:i,selectValue:s,tabValues:a}){const l=[],{blockElementScrollPositionUntilNextRender:o}=(0,r.a_)(),u=e=>{const n=e.currentTarget,t=l.indexOf(n),r=a[t].value;r!==i&&(o(n),s(r))},c=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const i=l.indexOf(e.currentTarget)+1;n=l[i]??l[0];break}case"ArrowLeft":{const i=l.indexOf(e.currentTarget)-1;n=l[i]??l[l.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:a.map(({value:e,label:n,attributes:s})=>(0,b.jsx)("li",{role:"tab",tabIndex:i===e?0:-1,"aria-selected":i===e,ref:e=>{l.push(e)},onKeyDown:c,onClick:u,...s,className:(0,t.A)("tabs__item",j,s?.className,{"tabs__item--active":i===e}),children:n??e},e))})}function k({lazy:e,children:n,selectedValue:i}){const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=a.find(e=>e.props.value===i);return e?(0,s.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:a.map((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==i}))})}function q(e){const n=f(e);return(0,b.jsxs)("div",{className:(0,t.A)(a.G.tabs.container,"tabs-container",x),children:[(0,b.jsx)(_,{...n,...e}),(0,b.jsx)(k,{...n,...e})]})}function v(e){const n=(0,y.A)();return(0,b.jsx)(q,{...e,children:h(e.children)},String(n))}},28453(e,n,i){i.d(n,{R:()=>r,x:()=>l});var s=i(96540);const t={},a=s.createContext(t);function r(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);