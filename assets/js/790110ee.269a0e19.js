"use strict";(globalThis.webpackChunkdoqumentation=globalThis.webpackChunkdoqumentation||[]).push([[6167],{55093(s,e,a){a.r(e),a.d(e,{assets:()=>m,contentTitle:()=>r,default:()=>d,frontMatter:()=>l,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"tutorials/transverse-field-ising-model","title":"Transverse-Field Ising Model with Q-CTRL\'s Performance Management","description":"Build and solve the transverse-field Ising model using Fire Opal and Qiskit","source":"@site/i18n/tl/docusaurus-plugin-content-docs/current/tutorials/transverse-field-ising-model.mdx","sourceDirName":"tutorials","slug":"/tutorials/transverse-field-ising-model","permalink":"/tutorials/transverse-field-ising-model","draft":false,"unlisted":false,"editUrl":"https://github.com/JanLahmann/doQumentation/tree/main/docs/tutorials/transverse-field-ising-model.mdx","tags":[],"version":"current","frontMatter":{"title":"Transverse-Field Ising Model with Q-CTRL\'s Performance Management","sidebar_label":"Transverse-Field Ising Model with Q-CTRL\'s Performance Management","description":"Build and solve the transverse-field Ising model using Fire Opal and Qiskit","notebook_path":"docs/tutorials/transverse-field-ising-model.ipynb"},"sidebar":"tutorialsSidebar","previous":{"title":"Dissociation PES curves with Qunova HiVQE","permalink":"/tutorials/qunova-hivqe"},"next":{"title":"Quantum Phase Estimation with Q-CTRL\'s Qiskit Functions","permalink":"/tutorials/quantum-phase-estimation-qctrl"}}');var i=a(74848),t=a(28453);const l={title:"Transverse-Field Ising Model with Q-CTRL's Performance Management",sidebar_label:"Transverse-Field Ising Model with Q-CTRL's Performance Management",description:"Build and solve the transverse-field Ising model using Fire Opal and Qiskit",notebook_path:"docs/tutorials/transverse-field-ising-model.ipynb"},r=void 0,m={},c=[{value:"Background",id:"background",level:2},{value:"Overview",id:"overview",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Setup",id:"setup",level:2},{value:"Step 1: Map classical inputs to a quantum problem",id:"step-1-map-classical-inputs-to-a-quantum-problem",level:2},{value:"Generate TFIM graph",id:"generate-tfim-graph",level:3},{value:"Coloring graph edges",id:"coloring-graph-edges",level:3},{value:"Step 2: Optimize problem for quantum hardware execution",id:"step-2-optimize-problem-for-quantum-hardware-execution",level:2},{value:"Generate Trotterized circuits on spin graphs",id:"generate-trotterized-circuits-on-spin-graphs",level:3},{value:"Estimate single-qubit magnetizations \\langle Z_i \\rangle",id:"estimate-single-qubit-magnetizations-langle-z_i-rangle",level:3},{value:"Step 3: Execute using Qiskit primitives",id:"step-3-execute-using-qiskit-primitives",level:2},{value:"Run MPS simulation",id:"run-mps-simulation",level:3},{value:"Run on hardware",id:"run-on-hardware",level:3},{value:"Run on hardware with Fire Opal",id:"run-on-hardware-with-fire-opal",level:3},{value:"Step 4: Post-process and return result in desired classical format",id:"step-4-post-process-and-return-result-in-desired-classical-format",level:2},{value:"References",id:"references",level:2},{value:"Tutorial survey",id:"tutorial-survey",level:2}];function h(s){const e={a:"a",admonition:"admonition",annotation:"annotation",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mspace:"mspace",msub:"msub",msup:"msup",mtext:"mtext",munder:"munder",p:"p",pre:"pre",semantics:"semantics",span:"span",ul:"ul",...(0,t.R)(),...s.components},{OpenInLabBanner:n}=e;return n||function(s,e){throw new Error("Expected "+(e?"component":"object")+" `"+s+"` to be defined: you likely forgot to import, pass, or provide it.")}("OpenInLabBanner",!0),(0,i.jsxs)(i.Fragment,{children:["\n",(0,i.jsx)(e.admonition,{title:"Hindi pa naisalin",type:"note",children:(0,i.jsx)(e.p,{children:"Ang pahinang ito ay hindi pa naisalin. Nakikita mo ang orihinal na bersyon sa Ingles."})}),"\n",(0,i.jsx)(n,{notebookPath:"docs/tutorials/transverse-field-ising-model.ipynb"}),"\n","\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"Usage estimate: 2 minutes on a Heron r2 processor. (NOTE: This is an estimate only. Your runtime may vary.)"})}),"\n",(0,i.jsx)(e.h2,{id:"background",children:"Background"}),"\n",(0,i.jsx)(e.p,{children:"The Transverse-Field Ising Model (TFIM) is important for studying quantum magnetism and phase transitions. It describes a set of spins arranged on a lattice, where each spin interacts with its neighbors while also being influenced by an external magnetic field that drives quantum fluctuations."}),"\n",(0,i.jsxs)(e.p,{children:["A common approach to simulate this model is to use Trotter decomposition to approximate the time evolution operator, constructing circuits that alternate between single-qubit rotations and entangling two-qubit interactions. However, this simulation on real hardware is challenging due to noise and decoherence, leading to deviations from the true dynamics. To overcome this, we use Q-CTRL's Fire Opal error suppression and performance management tools, offered as a Qiskit Function (see the ",(0,i.jsx)(e.a,{href:"/guides/q-ctrl-performance-management",children:"Fire Opal documentation"}),"). Fire Opal automatically optimizes circuit execution by applying dynamical decoupling, advanced layout, routing, and other error suppression techniques, all aimed at reducing noise. With these improvements, the hardware results align more closely with noiseless simulations, and thus we can study TFIM magnetization dynamics with higher fidelity."]}),"\n",(0,i.jsx)(e.p,{children:"In this tutorial we will:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Build the TFIM Hamiltonian on a graph of connected spin triangles"}),"\n",(0,i.jsx)(e.li,{children:"Simulate time evolution with Trotterized circuits at different depths"}),"\n",(0,i.jsxs)(e.li,{children:["Compute and visualize single-qubit magnetizations ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\langle Z_i \\rangle"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"\u27e8"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})})]})," over time"]}),"\n",(0,i.jsx)(e.li,{children:"Compare baseline simulations with results from hardware runs using Q-CTRL's Fire Opal performance management"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(e.p,{children:"The Transverse-field Ising Model (TFIM) is a quantum spin model that captures essential features of quantum phase transitions. The Hamiltonian is defined as:"}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"J"}),(0,i.jsxs)(e.munder,{children:[(0,i.jsx)(e.mo,{children:"\u2211"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mn,{children:"1"})]})]}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"h"}),(0,i.jsxs)(e.munder,{children:[(0,i.jsx)(e.mo,{children:"\u2211"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"X"}),(0,i.jsx)(e.mi,{children:"i"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"H = -J \\sum_{i} Z_i Z_{i+1} - h \\sum_{i} X_i"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.3277em",verticalAlign:"-1.2777em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.09618em"},children:"J"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mop op-limits",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.05em"},children:[(0,i.jsxs)(e.span,{style:{top:"-1.8723em",marginLeft:"0em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{children:(0,i.jsx)(e.span,{className:"mop op-symbol large-op",children:"\u2211"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"1.2777em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,i.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2083em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.3277em",verticalAlign:"-1.2777em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"h"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mop op-limits",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.05em"},children:[(0,i.jsxs)(e.span,{style:{top:"-1.8723em",marginLeft:"0em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{children:(0,i.jsx)(e.span,{className:"mop op-symbol large-op",children:"\u2211"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"1.2777em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0785em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]})}),"\n",(0,i.jsxs)(e.p,{children:["where ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"Z_i"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," and ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"X"}),(0,i.jsx)(e.mi,{children:"i"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"X_i"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0785em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," are Pauli operators acting on qubit ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"i"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"i"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6595em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"i"})]})})]}),", ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"J"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"J"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.09618em"},children:"J"})]})})]})," is the coupling strength between neighboring spins, and ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"h"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"h"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"h"})]})})]})," is the strength of the transverse magnetic field. The first term represents classical ferromagnetic interactions, while the second introduces quantum fluctuations through the transverse field. To simulate TFIM dynamics, you use a Trotter decomposition of the unitary evolution operator ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"t"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"e^{-iHt}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8413em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8413em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})]})})]})})})})})]})]})})]}),", implemented through layers of RX and RZZ gates based on a custom graph of connected spin triangles. The simulation explores how magnetization ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\langle Z \\rangle"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"\u27e8"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})})]})," evolves with increasing Trotter steps."]}),"\n",(0,i.jsxs)(e.p,{children:["The performance of the proposed TFIM implementation is assessed by comparing noiseless simulations with noisy backends. Fire Opal's enhanced execution and error suppression features are used to mitigate the effect of noise in real hardware, yielding more reliable estimates of spin observables like ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\langle Z_i \\rangle"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"\u27e8"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})})]})," and correlators ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"j"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\langle Z_i Z_j \\rangle"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0361em",verticalAlign:"-0.2861em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"\u27e8"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05724em"},children:"j"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})})]}),"."]}),"\n",(0,i.jsx)(e.h2,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsx)(e.p,{children:"Before starting this tutorial, be sure you have the following installed:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Qiskit SDK v1.4 or later, with ",(0,i.jsx)(e.a,{href:"https://docs.quantum.ibm.com/api/qiskit/visualization",children:"visualization"})," support"]}),"\n",(0,i.jsxs)(e.li,{children:["Qiskit Runtime v0.40 or later (",(0,i.jsx)(e.code,{children:"pip install qiskit-ibm-runtime"}),")"]}),"\n",(0,i.jsxs)(e.li,{children:["Qiskit Functions Catalog v0.9.0 (",(0,i.jsx)(e.code,{children:"pip install qiskit-ibm-catalog"}),")"]}),"\n",(0,i.jsxs)(e.li,{children:["Fire Opal SDK v9.0.2 or later (",(0,i.jsx)(e.code,{children:"pip install fire-opal"}),")"]}),"\n",(0,i.jsxs)(e.li,{children:["Q-CTRL Visualizer v8.0.2 or later (",(0,i.jsx)(e.code,{children:"pip install qctrl-visualizer"}),")"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"setup",children:"Setup"}),"\n",(0,i.jsxs)(e.p,{children:["First, authenticate using your ",(0,i.jsx)(e.a,{href:"http://quantum.cloud.ibm.com/",children:"IBM Quantum API key"}),". Then, select the Qiskit Function as follows. (This code assumes you've already ",(0,i.jsx)(e.a,{href:"/guides/functions#install-qiskit-functions-catalog-client",children:"saved your account"})," to your local environment.)"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# Added by doQumentation \u2014 installs packages not in the Binder environment\n%pip install -q networkx qctrlvisualizer\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from qiskit.transpiler.preset_passmanagers import generate_preset_pass_manager\nfrom qiskit import QuantumCircuit\nfrom qiskit_ibm_catalog import QiskitFunctionsCatalog\nfrom qiskit_ibm_runtime import QiskitRuntimeService\nfrom qiskit_ibm_runtime import SamplerV2 as Sampler\nfrom qiskit.quantum_info import SparsePauliOp\nfrom qiskit_aer import AerSimulator\n\nimport numpy as np\nimport networkx as nx\nimport matplotlib.pyplot as plt\nimport qctrlvisualizer as qv\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'catalog = QiskitFunctionsCatalog(channel="ibm_quantum_platform")\n\n# Access Function\nperf_mgmt = catalog.load("q-ctrl/performance-management")\n'})}),"\n",(0,i.jsx)(e.h2,{id:"step-1-map-classical-inputs-to-a-quantum-problem",children:"Step 1: Map classical inputs to a quantum problem"}),"\n",(0,i.jsx)(e.h3,{id:"generate-tfim-graph",children:"Generate TFIM graph"}),"\n",(0,i.jsx)(e.p,{children:"We begin by defining the lattice of spins and the couplings between them. In this tutorial, the lattice is constructed from connected triangles arranged in a linear chain. Each triangle consists of three nodes connected in a closed loop, and the chain is formed by linking one node of each triangle to the previous triangle."}),"\n",(0,i.jsxs)(e.p,{children:["The helper function ",(0,i.jsx)(e.code,{children:"connected_triangles_adj_matrix"})," builds the adjacency matrix for this structure. For a chain of ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"n"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"n"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"n"})]})})]})," triangles, the resulting graph contains ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mn,{children:"2"}),(0,i.jsx)(e.mi,{children:"n"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mn,{children:"1"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"2n+1"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(e.span,{className:"mord",children:"2"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"n"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1"})]})]})]})," nodes."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def connected_triangles_adj_matrix(n):\n    """\n    Generate the adjacency matrix for \'n\' connected triangles in a chain.\n    """\n    num_nodes = 2 * n + 1\n    adj_matrix = np.zeros((num_nodes, num_nodes), dtype=int)\n\n    for i in range(n):\n        a, b, c = i * 2, i * 2 + 1, i * 2 + 2  # Nodes of the current triangle\n\n        # Connect the three nodes in a triangle\n        adj_matrix[a, b] = adj_matrix[b, a] = 1\n        adj_matrix[b, c] = adj_matrix[c, b] = 1\n        adj_matrix[a, c] = adj_matrix[c, a] = 1\n\n        # If not the first triangle, connect to the previous triangle\n        if i > 0:\n            adj_matrix[a, a - 1] = adj_matrix[a - 1, a] = 1\n\n    return adj_matrix\n'})}),"\n",(0,i.jsx)(e.p,{children:"To visualize the lattice we just defined, we can plot the chain of connected triangles and label each node. The function below builds the graph for a chosen number of triangles and displays it."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def plot_triangle_chain(n, side=1.0):\n    """\n    Plot a horizontal chain of n equilateral triangles.\n    Baseline: even nodes (0,2,4,...,2n) on y=0\n    Apexes: odd nodes (1,3,5,...,2n-1) above the midpoint.\n    """\n    # Build graph\n    A = connected_triangles_adj_matrix(n)\n    G = nx.from_numpy_array(A)\n\n    h = np.sqrt(3) / 2 * side\n    pos = {}\n\n    # Place baseline nodes\n    for k in range(n + 1):\n        pos[2 * k] = (k * side, 0.0)\n\n    # Place apex nodes\n    for k in range(n):\n        x_left = pos[2 * k][0]\n        x_right = pos[2 * k + 2][0]\n        pos[2 * k + 1] = ((x_left + x_right) / 2, h)\n\n    # Draw\n    fig, ax = plt.subplots(figsize=(1.5 * n, 2.5))\n    nx.draw(\n        G,\n        pos,\n        ax=ax,\n        with_labels=True,\n        font_size=10,\n        font_color="white",\n        node_size=600,\n        node_color=qv.QCTRL_STYLE_COLORS[0],\n        edge_color="black",\n        width=2,\n    )\n    ax.set_aspect("equal")\n    ax.margins(0.2)\n    plt.show()\n\n    return G, pos\n'})}),"\n",(0,i.jsx)(e.p,{children:"For this tutorial we will use a chain of 20 triangles."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"n_triangles = 20\nn_qubits = 2 * n_triangles + 1\nplot_triangle_chain(n_triangles, side=1.0)\nplt.show()\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Output of the previous code cell",src:a(92736).A+"",width:"2345",height:"120"})}),"\n",(0,i.jsx)(e.h3,{id:"coloring-graph-edges",children:"Coloring graph edges"}),"\n",(0,i.jsxs)(e.p,{children:["To implement the spin\u2013spin coupling, it is useful to group edges that do not overlap. This allows us to apply two-qubit gates in parallel. We can do this with a simple edge-coloring procedure ",(0,i.jsx)(e.a,{href:"#references",children:"[1]"}),", which assigns a color to each edge so that edges meeting at the same node are placed in different groups."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def edge_coloring(graph):\n    """\n    Takes a NetworkX graph and returns a list of lists where each inner list contains\n    the edges assigned the same color.\n    """\n    line_graph = nx.line_graph(graph)\n    edge_colors = nx.coloring.greedy_color(line_graph)\n\n    color_groups = {}\n    for edge, color in edge_colors.items():\n        if color not in color_groups:\n            color_groups[color] = []\n        color_groups[color].append(edge)\n\n    return list(color_groups.values())\n'})}),"\n",(0,i.jsx)(e.h2,{id:"step-2-optimize-problem-for-quantum-hardware-execution",children:"Step 2: Optimize problem for quantum hardware execution"}),"\n",(0,i.jsx)(e.h3,{id:"generate-trotterized-circuits-on-spin-graphs",children:"Generate Trotterized circuits on spin graphs"}),"\n",(0,i.jsx)(e.p,{children:"To simulate the dynamics of the TFIM, we construct circuits that approximate the time evolution operator."}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"U"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"t"})]})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mspace,{width:"1em"}),(0,i.jsx)(e.mtext,{children:"where"}),(0,i.jsx)(e.mspace,{width:"1em"}),(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"J"}),(0,i.jsxs)(e.munder,{children:[(0,i.jsx)(e.mo,{children:"\u2211"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{children:"j"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"j"})]}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"h"}),(0,i.jsxs)(e.munder,{children:[(0,i.jsx)(e.mo,{children:"\u2211"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"X"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"U(t) = e^{-i H t}, \\quad \\text{where} \\quad H = -J \\sum_{\\langle i,j \\rangle} Z_i Z_j - h \\sum_i X_i ."})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0858em",verticalAlign:"-0.1944em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8913em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})]})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"1em"}}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord text",children:(0,i.jsx)(e.span,{className:"mord",children:"where"})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"1em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.566em",verticalAlign:"-1.516em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.09618em"},children:"J"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mop op-limits",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.05em"},children:[(0,i.jsxs)(e.span,{style:{top:"-1.809em",marginLeft:"0em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mopen mtight",children:"\u27e8"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mpunct mtight",children:","}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05724em"},children:"j"}),(0,i.jsx)(e.span,{className:"mclose mtight",children:"\u27e9"})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{children:(0,i.jsx)(e.span,{className:"mop op-symbol large-op",children:"\u2211"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"1.516em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05724em"},children:"j"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.3277em",verticalAlign:"-1.2777em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"h"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mop op-limits",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.05em"},children:[(0,i.jsxs)(e.span,{style:{top:"-1.8723em",marginLeft:"0em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{children:(0,i.jsx)(e.span,{className:"mop op-symbol large-op",children:"\u2211"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"1.2777em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0785em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mord",children:"."})]})]})]})}),"\n",(0,i.jsx)(e.p,{children:"We use a second-order Trotter decomposition:"}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(e.mi,{children:"t"})]})]}),(0,i.jsx)(e.mo,{children:"\u2248"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"X"})]}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,i.jsx)(e.mn,{children:"2"})]})]}),(0,i.jsx)(e.mtext,{children:"\u2009"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"Z"})]}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(e.mi,{children:"t"})]})]}),(0,i.jsx)(e.mtext,{children:"\u2009"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"X"})]}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,i.jsx)(e.mn,{children:"2"})]})]}),(0,i.jsx)(e.mo,{separator:"true",children:","})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"e^{-i H \\Delta t} \\approx e^{-i H_X \\Delta t / 2}\\, e^{-i H_Z \\Delta t}\\, e^{-i H_X \\Delta t / 2},"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8913em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8913em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"mord mtight",children:"\u0394"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})]})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"\u2248"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.1324em",verticalAlign:"-0.1944em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.938em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.3567em",marginLeft:"-0.0813em",marginRight:"0.0714em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07847em"},children:"X"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1433em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mord mtight",children:"\u0394"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(e.span,{className:"mord mtight",children:"/2"})]})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8913em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.3567em",marginLeft:"-0.0813em",marginRight:"0.0714em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07153em"},children:"Z"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1433em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mord mtight",children:"\u0394"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})]})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.938em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.3567em",marginLeft:"-0.0813em",marginRight:"0.0714em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07847em"},children:"X"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1433em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mord mtight",children:"\u0394"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(e.span,{className:"mord mtight",children:"/2"})]})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","})]})]})]})}),"\n",(0,i.jsxs)(e.p,{children:["where ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"X"})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"h"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mo,{children:"\u2211"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"X"}),(0,i.jsx)(e.mi,{children:"i"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"H_X = -h \\sum_i X_i"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0813em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07847em"},children:"X"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0497em",verticalAlign:"-0.2997em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"h"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mop",children:[(0,i.jsx)(e.span,{className:"mop op-symbol small-op",style:{position:"relative",top:"0em"},children:"\u2211"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.162em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.4003em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2997em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0785em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]})," and ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"Z"})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mi,{children:"J"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mo,{children:"\u2211"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{children:"j"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"j"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"H_Z = -J \\sum_{\\langle i,j \\rangle} Z_i Z_j"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0813em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07153em"},children:"Z"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.2247em",verticalAlign:"-0.4747em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.09618em"},children:"J"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mop",children:[(0,i.jsx)(e.span,{className:"mop op-symbol small-op",style:{position:"relative",top:"0em"},children:"\u2211"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2253em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.4003em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mopen mtight",children:"\u27e8"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mpunct mtight",children:","}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05724em"},children:"j"}),(0,i.jsx)(e.span,{className:"mclose mtight",children:"\u27e9"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.4747em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05724em"},children:"j"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]}),"."]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["The ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"X"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"H_X"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0813em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07847em"},children:"X"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," term is implemented with layers of ",(0,i.jsx)(e.code,{children:"RX"})," rotations."]}),"\n",(0,i.jsxs)(e.li,{children:["The ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"Z"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"H_Z"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"},children:"H"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0813em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07153em"},children:"Z"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," term is implemented with layers of ",(0,i.jsx)(e.code,{children:"RZZ"})," gates along the edges of the interaction graph."]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["The angles of these gates are determined by the transverse field ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"h"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"h"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"h"})]})})]}),", the coupling constant ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"J"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"J"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.09618em"},children:"J"})]})})]}),", and the time step ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(e.mi,{children:"t"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Delta t"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u0394"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})})]}),". By stacking multiple Trotter steps, we generate circuits of increasing depth that approximate the system's dynamics. The functions ",(0,i.jsx)(e.code,{children:"generate_tfim_circ_custom_graph"})," and ",(0,i.jsx)(e.code,{children:"trotter_circuits"})," construct a Trotterized quantum circuit from an arbitrary spin interaction graph."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def generate_tfim_circ_custom_graph(\n    steps, h, J, dt, psi0, graph: nx.graph.Graph, meas_basis="Z", mirror=False\n):\n    """\n    Generate a second order trotter of the form e^(a+b) ~ e^(b/2) e^a e^(b/2) for simulating a transverse field ising model:\n    e^{-i H t} where the Hamiltonian H = -J \\\\sum_i Z_i Z_{i+1} + h \\\\sum_i X_i.\n\n    steps: Number of trotter steps\n    theta_x: Angle for layer of X rotations\n    theta_zz: Angle for layer of ZZ rotations\n    theta_x: Angle for second layer of X rotations\n    J: Coupling between nearest neighbor spins\n    h: The transverse magnetic field strength\n    dt: t/total_steps\n    psi0: initial state (assumed to be prepared in the computational basis).\n    meas_basis: basis to measure all correlators in\n\n    This is a second order trotter of the form e^(a+b) ~ e^(b/2) e^a e^(b/2)\n    """\n    theta_x = h * dt\n    theta_zz = -2 * J * dt\n    nq = graph.number_of_nodes()\n    color_edges = edge_coloring(graph)\n    circ = QuantumCircuit(nq, nq)\n    # Initial state, for typical cases in the computational basis\n    for i, b in enumerate(psi0):\n        if b == "1":\n            circ.x(i)\n    # Trotter steps\n    for step in range(steps):\n        for i in range(nq):\n            circ.rx(theta_x, i)\n        if mirror:\n            color_edges = [sublist[::-1] for sublist in color_edges[::-1]]\n        for edge_list in color_edges:\n            for edge in edge_list:\n                circ.rzz(theta_zz, edge[0], edge[1])\n        for i in range(nq):\n            circ.rx(theta_x, i)\n\n    # some typically used basis rotations\n    if meas_basis == "X":\n        for b in range(nq):\n            circ.h(b)\n    elif meas_basis == "Y":\n        for b in range(nq):\n            circ.sdg(b)\n            circ.h(b)\n\n    for i in range(nq):\n        circ.measure(i, i)\n\n    return circ\n\ndef trotter_circuits(G, d_ind_tot, J, h, dt, meas_basis, mirror=True):\n    """\n    Generates a sequence of Trotterized circuits, each with increasing depth.\n    Given a spin interaction graph and Hamiltonian parameters, it constructs\n    a list of circuits with 1 to d_ind_tot Trotter steps\n\n    G: Graph defining spin interactions (edges = ZZ couplings)\n    d_ind_tot: Number of Trotter steps (maximum depth)\n    J: Coupling between nearest neighboring spins\n    h: Transverse magnetic field strength\n    dt: (t / total_steps\n    meas_basis: Basis to measure all correlators in\n    mirror: If True, mirror the Trotter layers\n    """\n    qubit_count = len(G)\n    circuits = []\n    psi0 = "0" * qubit_count\n\n    for steps in range(1, d_ind_tot + 1):\n        circuits.append(\n            generate_tfim_circ_custom_graph(\n                steps, h, J, dt, psi0, G, meas_basis, mirror\n            )\n        )\n    return circuits\n'})}),"\n",(0,i.jsxs)(e.h3,{id:"estimate-single-qubit-magnetizations-langle-z_i-rangle",children:["Estimate single-qubit magnetizations ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\langle Z_i \\rangle"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"\u27e8"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})})]})]}),"\n",(0,i.jsxs)(e.p,{children:["To study the dynamics of the model, we want to measure the magnetization of each qubit, defined by the expectation value ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsx)(e.mi,{children:"\u03c8"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,i.jsx)(e.mi,{children:"\u03c8"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\langle Z_i \\rangle = \\langle \\psi | Z_i | \\psi \\rangle"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"\u27e8"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"\u27e8"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c8"}),(0,i.jsx)(e.span,{className:"mord",children:"\u2223"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mord",children:"\u2223"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c8"}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})]})]}),"."]}),"\n",(0,i.jsxs)(e.p,{children:["In simulations, we can compute this directly from the measurement outcomes. The function ",(0,i.jsx)(e.code,{children:"z_expectation"})," processes the bitstring counts and returns the value of ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\langle Z_i \\rangle"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"\u27e8"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})})]})," for a chosen qubit index. On real hardware, we evaluate the same quantity by specifying the Pauli operator using the function ",(0,i.jsx)(e.code,{children:"generate_z_observables"}),", and then the backend computes the expectation value."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def z_expectation(counts, index):\n    """\n    counts: Dict of mitigated bitstrings.\n    index: Index i in the single operator expectation value < II...Z_i...I > to be calculated.\n    return:  < Z_i >\n    """\n    z_exp = 0\n    tot = 0\n    for bitstring, value in counts.items():\n        bit = int(bitstring[index])\n        sign = 1\n        if bit % 2 == 1:\n            sign = -1\n        z_exp += sign * value\n        tot += value\n\n    return z_exp / tot\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def generate_z_observables(nq):\n    observables = []\n    for i in range(nq):\n        pauli_string = "".join(["Z" if j == i else "I" for j in range(nq)])\n        observables.append(SparsePauliOp(pauli_string))\n    return observables\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"observables = generate_z_observables(n_qubits)\n"})}),"\n",(0,i.jsx)(e.p,{children:"We now define the parameters for generating the Trotterized circuits. In this tutorial, the lattice is a chain of 20 connected triangles, which corresponds to a 41-qubit system."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'all_circs_mirror = []\nfor num_triangles in [n_triangles]:\n    for meas_basis in ["Z"]:\n        A = connected_triangles_adj_matrix(num_triangles)\n        G = nx.from_numpy_array(A)\n        nq = len(G)\n        d_ind_tot = 22\n        dt = 2 * np.pi * 1 / 30 * 0.25\n        J = 1\n        h = -7\n        all_circs_mirror.extend(\n            trotter_circuits(G, d_ind_tot, J, h, dt, meas_basis, True)\n        )\ncircs = all_circs_mirror\n'})}),"\n",(0,i.jsx)(e.h2,{id:"step-3-execute-using-qiskit-primitives",children:"Step 3: Execute using Qiskit primitives"}),"\n",(0,i.jsx)(e.h3,{id:"run-mps-simulation",children:"Run MPS simulation"}),"\n",(0,i.jsxs)(e.p,{children:["The list of Trotterized circuits is executed using the ",(0,i.jsx)(e.code,{children:"matrix_product_state"})," simulator with an arbitrary choice of ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mn,{children:"4096"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"4096"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"4096"})]})})]})," shots. The MPS method provides an efficient approximation of the circuit dynamics, with accuracy determined by the chosen bond dimension. For the system sizes considered here, the default bond dimension is sufficient to capture the magnetization dynamics with high fidelity. The raw counts are normalized, and from these we compute the single-qubit expectation values ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\langle Z_i \\rangle"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"\u27e8"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})})]})," at each Trotter step. Finally, we calculate the average over all qubits to obtain a single curve that shows how the magnetization changes over time."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'backend_sim = AerSimulator(method="matrix_product_state")\n\ndef normalize_counts(counts_list, shots):\n    new_counts_list = []\n    for counts in counts_list:\n        a = {k: v / shots for k, v in counts.items()}\n        new_counts_list.append(a)\n    return new_counts_list\n\ndef run_sim(circ_list):\n    shots = 4096\n    res = backend_sim.run(circ_list, shots=shots)\n    normed = normalize_counts(res.result().get_counts(), shots)\n    return normed\n\nsim_counts = run_sim(circs)\n'})}),"\n",(0,i.jsx)(e.h3,{id:"run-on-hardware",children:"Run on hardware"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'service = QiskitRuntimeService()\nbackend = service.backend("ibm_marrakesh")\n\ndef run_qiskit(circ_list):\n    shots = 4096\n    pm = generate_preset_pass_manager(backend=backend)\n    isa_circuits = [pm.run(qc) for qc in circ_list]\n    sampler = Sampler(mode=backend)\n    res = sampler.run(isa_circuits, shots=shots)\n    res = [r.data.c.get_counts() for r in res.result()]\n    normed = normalize_counts(res, shots)\n    return normed\n\nqiskit_counts = run_qiskit(circs)\n'})}),"\n",(0,i.jsx)(e.h3,{id:"run-on-hardware-with-fire-opal",children:"Run on hardware with Fire Opal"}),"\n",(0,i.jsx)(e.p,{children:"We evaluate the magnetization dynamics on real quantum hardware. Fire Opal provides a Qiskit Function that extends the standard Qiskit Runtime Estimator primitive with automated error suppression and performance management. We submit the Trotterized circuits directly to an IBM\xae backend while Fire Opal handles the noise-aware execution."}),"\n",(0,i.jsxs)(e.p,{children:["We prepare a list of ",(0,i.jsx)(e.code,{children:"pubs"}),", where each item contains a circuit and the corresponding Pauli-Z observables. These are passed to Fire Opal's estimator function, which returns the expectation values ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e8"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"Z"}),(0,i.jsx)(e.mi,{children:"i"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"\u27e9"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\langle Z_i \\rangle"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"\u27e8"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:"\u27e9"})]})})]})," for each qubit at each Trotter step. The results can then be averaged over qubits to obtain the magnetization curve from hardware."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'backend_name = "ibm_marrakesh"\nestimator_pubs = [(qc, observables) for qc in all_circs_mirror[:]]\n\n# Run the circuit using the estimator\nqctrl_estimator_job = perf_mgmt.run(\n    primitive="estimator",\n    pubs=estimator_pubs,\n    backend_name=backend_name,\n    options={"default_shots": 4096},\n)\n\nresult_qctrl = qctrl_estimator_job.result()\n'})}),"\n",(0,i.jsx)(e.h2,{id:"step-4-post-process-and-return-result-in-desired-classical-format",children:"Step 4: Post-process and return result in desired classical format"}),"\n",(0,i.jsx)(e.p,{children:"Finally, we compare the magnetization curve from the simulator with the results obtained on real hardware. Plotting both side by side shows how closely the hardware execution with Fire Opal matches the noiseless baseline across Trotter steps."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"def make_correlators(test_counts, nq, d_ind_tot):\n    mz = np.empty((nq, d_ind_tot))\n    for d_ind in range(d_ind_tot):\n        counts = test_counts[d_ind]\n        for i in range(nq):\n            mz[i, d_ind] = z_expectation(counts, i)\n    average_z = np.mean(mz, axis=0)\n    return np.concatenate((np.array([1]), average_z), axis=0)\n\nsim_exp = make_correlators(sim_counts[0:22], nq=nq, d_ind_tot=22)\nqiskit_exp = make_correlators(qiskit_counts[0:22], nq=nq, d_ind_tot=22)\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"qctrl_exp = [ev.data.evs for ev in result_qctrl[:]]\nqctrl_exp_mean = np.concatenate(\n    (np.array([1]), np.mean(qctrl_exp, axis=1)), axis=0\n)\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def make_expectations_plot(\n    sim_z,\n    depths,\n    exp_qctrl=None,\n    exp_qctrl_error=None,\n    exp_qiskit=None,\n    exp_qiskit_error=None,\n    plot_from=0,\n    plot_upto=23,\n):\n    import numpy as np\n    import matplotlib.pyplot as plt\n\n    depth_ticks = [0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22]\n\n    d = np.asarray(depths)[plot_from:plot_upto]\n    sim = np.asarray(sim_z)[plot_from:plot_upto]\n\n    qk = (\n        None\n        if exp_qiskit is None\n        else np.asarray(exp_qiskit)[plot_from:plot_upto]\n    )\n    qc = (\n        None\n        if exp_qctrl is None\n        else np.asarray(exp_qctrl)[plot_from:plot_upto]\n    )\n\n    qk_err = (\n        None\n        if exp_qiskit_error is None\n        else np.asarray(exp_qiskit_error)[plot_from:plot_upto]\n    )\n    qc_err = (\n        None\n        if exp_qctrl_error is None\n        else np.asarray(exp_qctrl_error)[plot_from:plot_upto]\n    )\n\n    # ---- helper(s) ----\n    def rmse(a, b):\n        if a is None or b is None:\n            return None\n        a = np.asarray(a, dtype=float)\n        b = np.asarray(b, dtype=float)\n        mask = np.isfinite(a) & np.isfinite(b)\n        if not np.any(mask):\n            return None\n        diff = a[mask] - b[mask]\n        return float(np.sqrt(np.mean(diff**2)))\n\n    def plot_panel(ax, method_y, method_err, color, label, band_color=None):\n        # Noiseless reference\n        ax.plot(d, sim, color="grey", label="Noiseless simulation")\n\n        # Method line + band\n        if method_y is not None:\n            ax.plot(d, method_y, color=color, label=label)\n            if method_err is not None:\n                lo = np.clip(method_y - method_err, -1.05, 1.05)\n                hi = np.clip(method_y + method_err, -1.05, 1.05)\n                ax.fill_between(\n                    d,\n                    lo,\n                    hi,\n                    alpha=0.18,\n                    color=band_color if band_color else color,\n                    label=f"{label} \xb1 error",\n                )\n        else:\n            ax.text(\n                0.5,\n                0.5,\n                "No data",\n                transform=ax.transAxes,\n                ha="center",\n                va="center",\n                fontsize=10,\n                color="0.4",\n            )\n\n        # RMSE box (vs sim)\n        r = rmse(method_y, sim)\n        if r is not None:\n            ax.text(\n                0.98,\n                0.02,\n                f"RMSE: {r:.4f}",\n                transform=ax.transAxes,\n                va="bottom",\n                ha="right",\n                fontsize=8,\n                bbox=dict(\n                    boxstyle="round,pad=0.35", fc="white", ec="0.7", alpha=0.9\n                ),\n            )\n        # Axes\n        ax.set_xticks(depth_ticks)\n        ax.set_ylim(-1.05, 1.05)\n        ax.grid(True, which="both", linewidth=0.4, alpha=0.4)\n        ax.set_axisbelow(True)\n        ax.legend(prop={"size": 8}, loc="best")\n\n    fig, axes = plt.subplots(1, 2, figsize=(10, 4), dpi=300, sharey=True)\n\n    axes[0].set_title("Fire Opal (Q-CTRL)", fontsize=10)\n    plot_panel(\n        axes[0],\n        qc,\n        qc_err,\n        color="#680CE9",\n        label="Fire Opal",\n        band_color="#680CE9",\n    )\n    axes[0].set_xlabel("Trotter step")\n    axes[0].set_ylabel(r"$\\langle Z \\rangle$")\n    axes[1].set_title("Qiskit", fontsize=10)\n    plot_panel(\n        axes[1], qk, qk_err, color="blue", label="Qiskit", band_color="blue"\n    )\n    axes[1].set_xlabel("Trotter step")\n\n    plt.tight_layout()\n    plt.show()\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"depths = list(range(d_ind_tot + 1))\nerrors = np.abs(np.array(qctrl_exp_mean) - np.array(sim_exp))\n\nerrors_qiskit = np.abs(np.array(qiskit_exp) - np.array(sim_exp))\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"make_expectations_plot(\n    sim_exp,\n    depths,\n    exp_qctrl=qctrl_exp_mean,\n    exp_qctrl_error=errors,\n    exp_qiskit=qiskit_exp,\n    exp_qiskit_error=errors_qiskit,\n)\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Output of the previous code cell",src:a(21218).A+"",width:"2970",height:"1170"})}),"\n",(0,i.jsx)(e.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(e.p,{children:["[1] Graph coloring. Wikipedia. Retrieved September 15, 2025, from ",(0,i.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Graph_coloring",children:"https://en.wikipedia.org/wiki/Graph_coloring"})]}),"\n",(0,i.jsx)(e.h2,{id:"tutorial-survey",children:"Tutorial survey"}),"\n",(0,i.jsx)(e.p,{children:"Please take a minute to provide feedback on this tutorial. Your insights will help us improve our content offerings and user experience."}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.a,{href:"https://your.feedback.ibm.com/jfe/form/SV_3BLFkNVEuh0QBWm",children:"Link to survey"})})]})}function d(s={}){const{wrapper:e}={...(0,t.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(h,{...s})}):h(s)}},92736(s,e,a){a.d(e,{A:()=>n});const n=a.p+"assets/images/861ab6e3-0-b55b779a486254e094470f5811b391d7.avif"},21218(s,e,a){a.d(e,{A:()=>n});const n=a.p+"assets/images/d4902d14-0-023e94580e0b4574bb3fbaa67f59b572.avif"},28453(s,e,a){a.d(e,{R:()=>l,x:()=>r});var n=a(96540);const i={},t=n.createContext(i);function l(s){const e=n.useContext(t);return n.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:l(s.components),n.createElement(t.Provider,{value:e},s.children)}}}]);