"use strict";(globalThis.webpackChunkdoqumentation=globalThis.webpackChunkdoqumentation||[]).push([[8172],{18666(e,s,n){n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"tutorials/periodic-boundary-conditions-with-circuit-cutting","title":"Circuit cutting for periodic boundary conditions","description":"Use circuit cutting to deal with a utility-scale periodic chain problem where the first and last qubits are not neighbors.","source":"@site/i18n/tl/docusaurus-plugin-content-docs/current/tutorials/periodic-boundary-conditions-with-circuit-cutting.mdx","sourceDirName":"tutorials","slug":"/tutorials/periodic-boundary-conditions-with-circuit-cutting","permalink":"/tutorials/periodic-boundary-conditions-with-circuit-cutting","draft":false,"unlisted":false,"editUrl":"https://github.com/JanLahmann/doQumentation/tree/main/docs/tutorials/periodic-boundary-conditions-with-circuit-cutting.mdx","tags":[],"version":"current","frontMatter":{"title":"Circuit cutting for periodic boundary conditions","sidebar_label":"Circuit cutting for periodic boundary conditions","description":"Use circuit cutting to deal with a utility-scale periodic chain problem where the first and last qubits are not neighbors.","notebook_path":"docs/tutorials/periodic-boundary-conditions-with-circuit-cutting.ipynb"},"sidebar":"tutorialsSidebar","previous":{"title":"Wire cutting for expectation values estimation","permalink":"/tutorials/wire-cutting"},"next":{"title":"Circuit cutting for depth reduction","permalink":"/tutorials/depth-reduction-with-circuit-cutting"}}');var t=n(74848),a=n(28453);const l={title:"Circuit cutting for periodic boundary conditions",sidebar_label:"Circuit cutting for periodic boundary conditions",description:"Use circuit cutting to deal with a utility-scale periodic chain problem where the first and last qubits are not neighbors.",notebook_path:"docs/tutorials/periodic-boundary-conditions-with-circuit-cutting.ipynb"},r=void 0,c={},h=[{value:"Background",id:"background",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Setup",id:"setup",level:2},{value:"Step 1: Map classical inputs to a quantum problem",id:"step-1-map-classical-inputs-to-a-quantum-problem",level:2},{value:"Select backend and initial layout",id:"select-backend-and-initial-layout",level:4},{value:"Build the entangler map for the TwoLocal circuit",id:"build-the-entangler-map-for-the-twolocal-circuit",level:4},{value:"Select observables",id:"select-observables",level:4},{value:"Step 2: Optimize problem for quantum hardware execution",id:"step-2-optimize-problem-for-quantum-hardware-execution",level:2},{value:"Transpile the circuit",id:"transpile-the-circuit",level:4},{value:"Cut the long range periodic connectivities",id:"cut-the-long-range-periodic-connectivities",level:4},{value:"Transpile the subexperiments",id:"transpile-the-subexperiments",level:4},{value:"Step 3: Execute using Qiskit primitives",id:"step-3-execute-using-qiskit-primitives",level:2},{value:"Step 4: Post-process and return result in desired classical format",id:"step-4-post-process-and-return-result-in-desired-classical-format",level:2},{value:"Cross Verify: Obtain uncut expectation value",id:"cross-verify-obtain-uncut-expectation-value",level:3},{value:"Visualize",id:"visualize",level:3},{value:"Summary",id:"summary",level:3},{value:"Inference",id:"inference",level:3},{value:"Tutorial survey",id:"tutorial-survey",level:2}];function o(e){const s={a:"a",admonition:"admonition",annotation:"annotation",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",msubsup:"msubsup",msup:"msup",p:"p",pre:"pre",semantics:"semantics",span:"span",ul:"ul",...(0,a.R)(),...e.components},{OpenInLabBanner:i}=s;return i||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("OpenInLabBanner",!0),(0,t.jsxs)(t.Fragment,{children:["\n",(0,t.jsx)(s.admonition,{title:"Hindi pa naisalin",type:"note",children:(0,t.jsx)(s.p,{children:"Ang pahinang ito ay hindi pa naisalin. Nakikita mo ang orihinal na bersyon sa Ingles."})}),"\n",(0,t.jsx)(i,{notebookPath:"docs/tutorials/periodic-boundary-conditions-with-circuit-cutting.ipynb"}),"\n","\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.em,{children:"Usage estimate: Two minutes on an Eagle processor (NOTE: This is an estimate only. Your runtime might vary.)"})}),"\n",(0,t.jsx)(s.h2,{id:"background",children:"Background"}),"\n",(0,t.jsx)(s.p,{children:"In this notebook, we consider the simulation of a periodic chain of qubits where there is two qubit operation between every two adjacent qubits, including the first and the last ones. Periodic chains are often found in physics and chemistry problems such as Ising models and molecular simulation."}),"\n",(0,t.jsxs)(s.p,{children:["Current IBM Quantum\xae devices are planar. It is possible to embed some periodic chains on the topology directly where the first and last qubits are neighbors. However, for big enough problems, the first and last qubits can be far apart, thus requiring many SWAP gates for the 2-qubit operation between these two qubits. Such a periodic boundary problem has been studied in ",(0,t.jsx)("a",{href:"https://arxiv.org/abs/2402.17833",children:"this paper"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"In this notebook we show the usage of circuit cutting to deal with such a utility scale periodic chain problem where the first and last qubits are not neighbors. Cutting this long range connectivity avoids the extra SWAP gates at the cost of executing multiple instances of the circuit, and some classical post-processing. In summary, cutting can be incorporated to logically calculate the long distance 2-qubit operations. In other words, this approach leads to an effective increase in the connectivity of the coupling map, thus leading to a fewer number of SWAP gates."}),"\n",(0,t.jsxs)(s.p,{children:["Note that there are two types of cuts - cutting the wire of a circuit (called ",(0,t.jsx)(s.code,{children:"wire cutting"}),"), or replacing a 2-qubit gate with multiple single qubit operations (called ",(0,t.jsx)(s.code,{children:"gate cutting"}),"). In this notebook, we shall focus on gate cutting. For more details on gate cutting, refer to the ",(0,t.jsx)("a",{href:"https://qiskit.github.io/qiskit-addon-cutting/explanation/index.html",children:"explanatory materials"})," in ",(0,t.jsx)(s.code,{children:"qiskit-addon-cutting"}),", and the corresponding references. For more details on wire cutting, refer to the ",(0,t.jsx)(s.a,{href:"/tutorials/wire-cutting",children:"Wire cutting for expectation values estimation"})," tutorial, or the tutorials in ",(0,t.jsx)("a",{href:"https://qiskit.github.io/qiskit-addon-cutting/tutorials/index.html",children:"qiskit-addon-cutting"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsx)(s.p,{children:"Before starting this tutorial, be sure you have the following installed:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Qiskit SDK v1.2 or later (",(0,t.jsx)(s.code,{children:"pip install qiskit"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:["Qiskit Runtime v0.3 or later (",(0,t.jsx)(s.code,{children:"pip install qiskit-ibm-runtime"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:["Circuit cutting Qiskit addon v.9.0 or later (",(0,t.jsx)(s.code,{children:"pip install qiskit-addon-cutting"}),")"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"setup",children:"Setup"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"# Added by doQumentation \u2014 installs packages not in the Binder environment\n%pip install -q qiskit-addon-cutting\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"import numpy as np\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\n\nfrom qiskit.transpiler import PassManager\nfrom qiskit.transpiler.passes import (\n    BasisTranslator,\n    Optimize1qGatesDecomposition,\n)\nfrom qiskit.circuit.equivalence_library import (\n    SessionEquivalenceLibrary as sel,\n)\nfrom qiskit.converters import circuit_to_dag, dag_to_circuit\nfrom qiskit.result import sampled_expectation_value\nfrom qiskit.quantum_info import SparsePauliOp\nfrom qiskit.transpiler.preset_passmanagers import generate_preset_pass_manager\nfrom qiskit.circuit.library import TwoLocal\n\nfrom qiskit_addon_cutting import (\n    cut_gates,\n    generate_cutting_experiments,\n    reconstruct_expectation_values,\n)\n\nfrom qiskit_ibm_runtime import QiskitRuntimeService\nfrom qiskit_ibm_runtime import SamplerV2, SamplerOptions, Batch\n"})}),"\n",(0,t.jsx)(s.h2,{id:"step-1-map-classical-inputs-to-a-quantum-problem",children:"Step 1: Map classical inputs to a quantum problem"}),"\n",(0,t.jsx)(s.p,{children:"Here, we'll generate a TwoLocal circuit and define some observables."}),"\n",(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Input: Parameters to create a circuit"}),(0,t.jsx)("li",{children:"Output: Abstract circuit and observables"})]}),"\n",(0,t.jsxs)(s.p,{children:["We consider a hardware-efficient ",(0,t.jsx)(s.code,{children:"entangler map"})," for the TwoLocal circuit with periodic connectivity between the last and the first qubits of the ",(0,t.jsx)(s.code,{children:"entangler map"}),". This long range interaction can lead to extra SWAP gates during transpilation, thus increasing the depth of the circuit."]}),"\n",(0,t.jsx)(s.h4,{id:"select-backend-and-initial-layout",children:"Select backend and initial layout"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"service = QiskitRuntimeService()\nbackend = service.least_busy(\n    operational=True, simulator=False, min_num_qubits=127\n)\n"})}),"\n",(0,t.jsx)(s.p,{children:"For this notebook we shall consider a 109 qubit periodic 1D chain, which is the longest 1D chain in the topology of a 127-qubit IBM Quantum device. It is not possible to arrange a 109 qubit periodic chain on a 127 qubit device such that the first and last qubits are neighbors without incorporating extra SWAP gates."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"init_layout = [\n    13,\n    12,\n    11,\n    10,\n    9,\n    8,\n    7,\n    6,\n    5,\n    4,\n    3,\n    2,\n    1,\n    0,\n    14,\n    18,\n    19,\n    20,\n    21,\n    22,\n    23,\n    24,\n    25,\n    26,\n    27,\n    28,\n    29,\n    30,\n    31,\n    32,\n    36,\n    51,\n    50,\n    49,\n    48,\n    47,\n    46,\n    45,\n    44,\n    43,\n    42,\n    41,\n    40,\n    39,\n    38,\n    37,\n    52,\n    56,\n    57,\n    58,\n    59,\n    60,\n    61,\n    62,\n    63,\n    64,\n    65,\n    66,\n    67,\n    68,\n    69,\n    70,\n    74,\n    89,\n    88,\n    87,\n    86,\n    85,\n    84,\n    83,\n    82,\n    81,\n    80,\n    79,\n    78,\n    77,\n    76,\n    75,\n    90,\n    94,\n    95,\n    96,\n    97,\n    98,\n    99,\n    100,\n    101,\n    102,\n    103,\n    104,\n    105,\n    106,\n    107,\n    108,\n    112,\n    126,\n    125,\n    124,\n    123,\n    122,\n    121,\n    120,\n    119,\n    118,\n    117,\n    116,\n    115,\n    114,\n    113,\n]\n\n# the number of qubits in the circuit is governed by the length of the initial layout\nnum_qubits = len(init_layout)\nnum_qubits\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"109\n"})}),"\n",(0,t.jsx)(s.h4,{id:"build-the-entangler-map-for-the-twolocal-circuit",children:"Build the entangler map for the TwoLocal circuit"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"coupling_map = [(i, i + 1) for i in range(0, len(init_layout) - 1)]\ncoupling_map.append(\n    (len(init_layout) - 1, 0)\n)  # adding in the periodic connectivity\n"})}),"\n",(0,t.jsxs)(s.p,{children:["TwoLocal circuit allows the repetition of the ",(0,t.jsx)(s.code,{children:"rotation_blocks"})," and the ",(0,t.jsx)(s.code,{children:"entangler map"})," multiple times. For this case, the number of repetitions determine the number of periodic gates that need to be cut. Since the sampling overhead increases exponentially with the number of cuts (refer to the ",(0,t.jsx)(s.a,{href:"/tutorials/wire-cutting",children:"Wire cutting for expectation values estimation"})," tutorial for more details), we shall fix the number of repetitions to 2 in this notebook."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"num_reps = 2\nentangler_map = []\n\nfor even_edge in coupling_map[0 : len(coupling_map) : 2]:\n    entangler_map.append(even_edge)\n\nfor odd_edge in coupling_map[1 : len(coupling_map) : 2]:\n    entangler_map.append(odd_edge)\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'ansatz = TwoLocal(\n    num_qubits=num_qubits,\n    rotation_blocks="rx",\n    entanglement_blocks="cx",\n    entanglement=entangler_map,\n    reps=num_reps,\n).decompose()\nansatz.draw("mpl", fold=-1)\n'})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Output of the previous code cell",src:n(63190).A+"",width:"784",height:"7063"})}),"\n",(0,t.jsx)(s.p,{children:"In order to verify the quality of the outcome using circuit cutting, we need to know the ideal outcome. The current circuit of choice is beyond brute force classical simulation. Therefore, we fix the parameters to the circuit carefully to make it clifford."}),"\n",(0,t.jsxs)(s.p,{children:["We shall assign the parameter value ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsx)(s.mn,{children:"0"})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"0"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,t.jsx)(s.span,{className:"mord",children:"0"})]})})]})," for the first two layers of ",(0,t.jsx)(s.code,{children:"Rx"})," gates, and the value ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsx)(s.mi,{children:"\u03c0"})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\pi"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c0"})]})})]})," for the last layer. This ensures that the ideal outcome of this circuit is ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,t.jsx)(s.mn,{children:"1"}),(0,t.jsxs)(s.msup,{children:[(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e9"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mo,{children:"\u2297"}),(0,t.jsx)(s.mi,{children:"n"})]})]})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"|1\\rangle^{\\otimes n}"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1.0213em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mord",children:"\u22231"}),(0,t.jsxs)(s.span,{className:"mclose",children:[(0,t.jsx)(s.span,{className:"mclose",children:"\u27e9"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsx)(s.span,{className:"vlist-t",children:(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.7713em"},children:(0,t.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(s.span,{className:"mord mtight",children:[(0,t.jsx)(s.span,{className:"mord mtight",children:"\u2297"}),(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})]})})]})})})})})]})]})})]}),", ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsx)(s.mi,{children:"n"})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"n"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"n"})]})})]})," being the number of qubits. Therefore, the expectation values of ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e8"}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"Z"}),(0,t.jsx)(s.mi,{children:"i"})]}),(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e9"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\langle Z_i \\rangle"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mopen",children:"\u27e8"}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mclose",children:"\u27e9"})]})})]})," and ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e8"}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"Z"}),(0,t.jsx)(s.mi,{children:"i"})]}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"Z"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"i"}),(0,t.jsx)(s.mo,{children:"+"}),(0,t.jsx)(s.mn,{children:"1"})]})]}),(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e9"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\langle Z_i Z_{i+1} \\rangle"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mopen",children:"\u27e8"}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(s.span,{className:"mord mtight",children:[(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"}),(0,t.jsx)(s.span,{className:"mbin mtight",children:"+"}),(0,t.jsx)(s.span,{className:"mord mtight",children:"1"})]})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.2083em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mclose",children:"\u27e9"})]})})]}),", where ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsx)(s.mi,{children:"i"})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"i"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6595em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"i"})]})})]})," is the index of the qubit, are ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mo,{children:"\u2212"}),(0,t.jsx)(s.mn,{children:"1"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"-1"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,t.jsx)(s.span,{className:"mord",children:"\u2212"}),(0,t.jsx)(s.span,{className:"mord",children:"1"})]})})]})," and ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mo,{children:"+"}),(0,t.jsx)(s.mn,{children:"1"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"+1"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,t.jsx)(s.span,{className:"mord",children:"+"}),(0,t.jsx)(s.span,{className:"mord",children:"1"})]})})]})," respectively."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"params_last_layer = [np.pi] * ansatz.num_qubits\nparams = [0] * (ansatz.num_parameters - ansatz.num_qubits)\nparams.extend(params_last_layer)\n\nansatz.assign_parameters(params, inplace=True)\n"})}),"\n",(0,t.jsx)(s.h4,{id:"select-observables",children:"Select observables"}),"\n",(0,t.jsxs)(s.p,{children:["To quantify the benefits of gate cutting we measure the expectation values of the observables ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsxs)(s.mfrac,{children:[(0,t.jsx)(s.mn,{children:"1"}),(0,t.jsx)(s.mi,{children:"n"})]}),(0,t.jsxs)(s.msubsup,{children:[(0,t.jsx)(s.mo,{children:"\u2211"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"i"}),(0,t.jsx)(s.mo,{children:"="}),(0,t.jsx)(s.mn,{children:"1"})]}),(0,t.jsx)(s.mi,{children:"n"})]}),(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e8"}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"Z"}),(0,t.jsx)(s.mi,{children:"i"})]}),(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e9"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\frac{1}{n}\\sum_{i=1}^n \\langle Z_i \\rangle"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1.1901em",verticalAlign:"-0.345em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,t.jsx)(s.span,{className:"mfrac",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsxs)(s.span,{className:"vlist",style:{height:"0.8451em"},children:[(0,t.jsxs)(s.span,{style:{top:"-2.655em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})})})]}),(0,t.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,t.jsxs)(s.span,{style:{top:"-3.394em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:"1"})})})]})]}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.345em"},children:(0,t.jsx)(s.span,{})})})]})}),(0,t.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsxs)(s.span,{className:"mop",children:[(0,t.jsx)(s.span,{className:"mop op-symbol small-op",style:{position:"relative",top:"0em"},children:"\u2211"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsxs)(s.span,{className:"vlist",style:{height:"0.8043em"},children:[(0,t.jsxs)(s.span,{style:{top:"-2.4003em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(s.span,{className:"mord mtight",children:[(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"}),(0,t.jsx)(s.span,{className:"mrel mtight",children:"="}),(0,t.jsx)(s.span,{className:"mord mtight",children:"1"})]})})]}),(0,t.jsxs)(s.span,{style:{top:"-3.2029em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})})]})]}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.2997em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mopen",children:"\u27e8"}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mclose",children:"\u27e9"})]})})]})," and ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsxs)(s.mfrac,{children:[(0,t.jsx)(s.mn,{children:"1"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"n"}),(0,t.jsx)(s.mo,{children:"\u2212"}),(0,t.jsx)(s.mn,{children:"1"})]})]}),(0,t.jsxs)(s.msubsup,{children:[(0,t.jsx)(s.mo,{children:"\u2211"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"i"}),(0,t.jsx)(s.mo,{children:"="}),(0,t.jsx)(s.mn,{children:"1"})]}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"n"}),(0,t.jsx)(s.mo,{children:"\u2212"}),(0,t.jsx)(s.mn,{children:"1"})]})]}),(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e8"}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"Z"}),(0,t.jsx)(s.mi,{children:"i"})]}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"Z"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"i"}),(0,t.jsx)(s.mo,{children:"+"}),(0,t.jsx)(s.mn,{children:"1"})]})]}),(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e9"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\frac{1}{n-1}\\sum_{i=1}^{n-1} \\langle Z_i Z_{i+1} \\rangle"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1.3573em",verticalAlign:"-0.4033em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,t.jsx)(s.span,{className:"mfrac",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsxs)(s.span,{className:"vlist",style:{height:"0.8451em"},children:[(0,t.jsxs)(s.span,{style:{top:"-2.655em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(s.span,{className:"mord mtight",children:[(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"}),(0,t.jsx)(s.span,{className:"mbin mtight",children:"\u2212"}),(0,t.jsx)(s.span,{className:"mord mtight",children:"1"})]})})]}),(0,t.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,t.jsxs)(s.span,{style:{top:"-3.394em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:"1"})})})]})]}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.4033em"},children:(0,t.jsx)(s.span,{})})})]})}),(0,t.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsxs)(s.span,{className:"mop",children:[(0,t.jsx)(s.span,{className:"mop op-symbol small-op",style:{position:"relative",top:"0em"},children:"\u2211"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsxs)(s.span,{className:"vlist",style:{height:"0.954em"},children:[(0,t.jsxs)(s.span,{style:{top:"-2.4003em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(s.span,{className:"mord mtight",children:[(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"}),(0,t.jsx)(s.span,{className:"mrel mtight",children:"="}),(0,t.jsx)(s.span,{className:"mord mtight",children:"1"})]})})]}),(0,t.jsxs)(s.span,{style:{top:"-3.2029em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(s.span,{className:"mord mtight",children:[(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"}),(0,t.jsx)(s.span,{className:"mbin mtight",children:"\u2212"}),(0,t.jsx)(s.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.2997em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mopen",children:"\u27e8"}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(s.span,{className:"mord mtight",children:[(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"}),(0,t.jsx)(s.span,{className:"mbin mtight",children:"+"}),(0,t.jsx)(s.span,{className:"mord mtight",children:"1"})]})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.2083em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mclose",children:"\u27e9"})]})})]}),". As discussed before, the ideal expectation values are ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mo,{children:"\u2212"}),(0,t.jsx)(s.mn,{children:"1"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"-1"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,t.jsx)(s.span,{className:"mord",children:"\u2212"}),(0,t.jsx)(s.span,{className:"mord",children:"1"})]})})]})," and ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mo,{children:"+"}),(0,t.jsx)(s.mn,{children:"1"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"+1"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,t.jsx)(s.span,{className:"mord",children:"+"}),(0,t.jsx)(s.span,{className:"mord",children:"1"})]})})]})," respectively."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'observables = []\n\nfor i in range(num_qubits):\n    obs = "I" * (i) + "Z" + "I" * (num_qubits - i - 1)\n    observables.append(obs)\n\nfor i in range(num_qubits):\n    if i == num_qubits - 1:\n        obs = "Z" + "I" * (num_qubits - 2) + "Z"\n    else:\n        obs = "I" * i + "ZZ" + "I" * (num_qubits - i - 2)\n    observables.append(obs)\n\nobservables = SparsePauliOp(observables)\npaulis = observables.paulis\ncoeffs = observables.coeffs\n'})}),"\n",(0,t.jsx)(s.h2,{id:"step-2-optimize-problem-for-quantum-hardware-execution",children:"Step 2: Optimize problem for quantum hardware execution"}),"\n",(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Input: Abstract circuit and observables"}),(0,t.jsx)("li",{children:"Output: Target circuit and observables produced by cutting long range gates"})]}),"\n",(0,t.jsx)(s.h4,{id:"transpile-the-circuit",children:"Transpile the circuit"}),"\n",(0,t.jsx)(s.p,{children:"Note that the circuit can be transpiled at this stage, or after cutting. If we transpile after cutting, that will require us to transpile each of the subexperiments generated due to the sampling overhead. Therefore, it is more prudent to transpile at this stage to reduce the overhead of transpilation."}),"\n",(0,t.jsx)(s.p,{children:"However, if transpilation is done at this stage with native hardware connectivity, the transpiler will append multiple SWAP gates to place the periodic 2-qubit operation \u2013 obfuscating the benefits of circuit cutting. To avoid this problem we can leverage that we know the exact gates that needs to be cut. Specifically, we can create a virtual coupling map by adding virtual connections between far away qubits to accommodate these periodic 2-qubit gates. This will ensure that the circuit can be transpiled at this stage without incorporating the extra SWAP gates."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"coupling_map = backend.configuration().coupling_map\n\n# create a virtual coupling map with long range connectivity\nvirtual_coupling_map = coupling_map.copy()\nvirtual_coupling_map.append([init_layout[-1], init_layout[0]])\nvirtual_coupling_map.append([init_layout[0], init_layout[-1]])\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'pm_virtual = generate_preset_pass_manager(\n    optimization_level=1,\n    coupling_map=virtual_coupling_map,\n    initial_layout=init_layout,\n    basis_gates=backend.configuration().basis_gates,\n)\n\nvirtual_mapped_circuit = pm_virtual.run(ansatz)\nvirtual_mapped_circuit.draw("mpl", fold=-1, idle_wires=False)\n'})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Output of the previous code cell",src:n(17683).A+"",width:"1754",height:"7075"})}),"\n",(0,t.jsx)(s.h4,{id:"cut-the-long-range-periodic-connectivities",children:"Cut the long range periodic connectivities"}),"\n",(0,t.jsx)(s.p,{children:"Now we cut the gates in the transpiled circuit. Note that the 2-qubit gates that need to be cut are the ones connecting the last and the first qubits of the layout."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"# Find the indices of the distant gates\ncut_indices = [\n    i\n    for i, instruction in enumerate(virtual_mapped_circuit.data)\n    if {virtual_mapped_circuit.find_bit(q)[0] for q in instruction.qubits}\n    == {init_layout[-1], init_layout[0]}\n]\n"})}),"\n",(0,t.jsx)(s.p,{children:"We shall apply the layout of the transpiled circuit to the observable."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"trans_observables = observables.apply_layout(virtual_mapped_circuit.layout)\n"})}),"\n",(0,t.jsx)(s.p,{children:"Finally the subexperiments are generated by sampling over different measurement and preparation bases."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"qpd_circuit, bases = cut_gates(virtual_mapped_circuit, cut_indices)\nsubexperiments, coefficients = generate_cutting_experiments(\n    circuits=qpd_circuit,\n    observables=trans_observables.paulis,\n    num_samples=np.inf,\n)\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Note that cutting the long range interactions leads to the execution of multiple samples of the circuit that differ in the measurement and preparation bases. More information about this can be found in ",(0,t.jsx)("a",{href:"https://arxiv.org/abs/1909.07534",children:"Constructing a virtual two-qubit gate by sampling single-qubit operations"})," and ",(0,t.jsx)("a",{href:"https://arxiv.org/abs/2312.11638",children:"Cutting circuits with multiple two-qubit unitaries"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["The number of periodic gates to be cut is equal to the number of repetitions of the ",(0,t.jsx)(s.code,{children:"TwoLocal"})," layer, defined as ",(0,t.jsx)(s.code,{children:"num_reps"})," above. The sampling overhead of gate cutting is 6. Therefore, the total number of subexperiments will be ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsxs)(s.msup,{children:[(0,t.jsx)(s.mn,{children:"6"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"n"}),(0,t.jsx)(s.mi,{children:"u"}),(0,t.jsx)(s.mi,{children:"m"}),(0,t.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,t.jsx)(s.mi,{children:"r"}),(0,t.jsx)(s.mi,{children:"e"}),(0,t.jsx)(s.mi,{children:"p"}),(0,t.jsx)(s.mi,{children:"s"})]})]})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"6^{num\\_reps}"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6644em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord",children:"6"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsx)(s.span,{className:"vlist-t",children:(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.6644em"},children:(0,t.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(s.span,{className:"mord mtight",children:[(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"}),(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"u"}),(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"m"}),(0,t.jsx)(s.span,{className:"mord mtight",style:{marginRight:"0.02778em"},children:"_"}),(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"re"}),(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"p"}),(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"s"})]})})]})})})})})]})]})})]}),"."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'print(f"Number of subexperiments is {len(subexperiments)} = 6**{num_reps}")\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"Number of subexperiments is 36 = 6**2\n"})}),"\n",(0,t.jsx)(s.h4,{id:"transpile-the-subexperiments",children:"Transpile the subexperiments"}),"\n",(0,t.jsx)(s.p,{children:"At this point, the subexperiments contains circuits with some 1-qubit gates that are not in the basis gate set. This is because the cut qubits are measured in different basis, and the rotation gates used for this does not necessarily belong to the basis gate set. For example, measurement in X basis implies applying a Hadamard gate before the usual measurement in Z basis. But Hadamard is not a part of the basis gate set."}),"\n",(0,t.jsxs)(s.p,{children:["Instead of applying the entire transpilation process on each of the circuits in the subexperiments, we can use specific transpilation passes. Refer to ",(0,t.jsx)("a",{href:"https://docs.quantum.ibm.com/api/qiskit/transpiler_passes",children:"this documentation"})," for a detailed description of all the available transpilation passes."]}),"\n",(0,t.jsxs)(s.p,{children:["We shall apply ",(0,t.jsx)(s.code,{children:"BasisTranslator"})," and then ",(0,t.jsx)(s.code,{children:"Optimize1qGatesDecomposition"})," passes to ensure that all the gates in these circuits belong to the basis gate set. Using these two passes is faster than the entire transpilation process, since other steps such as routing and initial layout selection are not performed again."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"pass_ = PassManager(\n    [Optimize1qGatesDecomposition(basis=backend.configuration().basis_gates)]\n)\n\nsubexperiments = pass_.run(\n    [\n        dag_to_circuit(\n            BasisTranslator(sel, target_basis=backend.basis_gates).run(\n                circuit_to_dag(circ)\n            )\n        )\n        for circ in subexperiments\n    ]\n)\n"})}),"\n",(0,t.jsx)(s.h2,{id:"step-3-execute-using-qiskit-primitives",children:"Step 3: Execute using Qiskit primitives"}),"\n",(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Input: Target circuits"}),(0,t.jsx)("li",{children:"Output: Quasi-probability distributions"})]}),"\n",(0,t.jsxs)(s.p,{children:["We use a ",(0,t.jsx)(s.code,{children:"SamplerV2"})," primitive for execution of the cut circuits. We disable ",(0,t.jsx)(s.code,{children:"dynamical decoupling"})," and ",(0,t.jsx)(s.code,{children:"twirling"})," so that any improvement we obtain in the result will solely be due to effective application of gate cutting for this type of circuit."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"options = SamplerOptions()\noptions.default_shots = 10000\noptions.dynamical_decoupling.enable = False\noptions.twirling.enable_gates = False\noptions.twirling.enable_measure = False\n"})}),"\n",(0,t.jsx)(s.p,{children:"Now we shall submit the jobs using batch mode."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'with Batch(backend=backend) as batch:\n    sampler = SamplerV2(options=options)\n    cut_job = sampler.run(subexperiments)\n\nprint(f"Job ID {cut_job.job_id()}")\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"Job ID cwxf7wq60bqg008pvt8g\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"result = cut_job.result()\n"})}),"\n",(0,t.jsx)(s.h2,{id:"step-4-post-process-and-return-result-in-desired-classical-format",children:"Step 4: Post-process and return result in desired classical format"}),"\n",(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Input: Quasi-probability distributions"}),(0,t.jsx)("li",{children:"Output: Reconstructed expectation values"})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"reconstructed_expvals = reconstruct_expectation_values(\n    result,\n    coefficients,\n    paulis,\n)\n"})}),"\n",(0,t.jsx)(s.p,{children:"We now calculate the average of weight-1 and weight-2 Z-type observables."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'cut_weight_1 = np.mean(reconstructed_expvals[:num_qubits])\ncut_weight_2 = np.mean(reconstructed_expvals[num_qubits:])\n\nprint(f"Average of weight-1 expectation values is {cut_weight_1}")\nprint(f"Average of weight-2 expectation values is {cut_weight_2}")\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"Average of weight-1 expectation values is -0.741733944954063\nAverage of weight-2 expectation values is 0.6968862385320495\n"})}),"\n",(0,t.jsx)(s.h3,{id:"cross-verify-obtain-uncut-expectation-value",children:"Cross Verify: Obtain uncut expectation value"}),"\n",(0,t.jsxs)(s.p,{children:["It is useful to cross-verify the advantage of the circuit cutting technique against uncut. Here we shall compute the expectation values without cutting the circuit. Note that such an uncut circuit will suffer from a large number of SWAP gates required to implement the 2-qubit operation between the first and the last qubits. We shall use the ",(0,t.jsx)(s.code,{children:"sampled_expectation_value"})," function to obtain the expectation values of the uncut circuit after obtaining the probability distribution via ",(0,t.jsx)(s.code,{children:"SamplerV2"}),". This allows a homogenous usage of primitive over all the instances. However, note that we could have used ",(0,t.jsx)(s.code,{children:"EstimatorV2"})," as well to directly compute the expectation values."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"if ansatz.num_clbits == 0:\n    ansatz.measure_all()\n\npm_uncut = generate_preset_pass_manager(\n    optimization_level=1, backend=backend, initial_layout=init_layout\n)\n\ntranspiled_circuit = pm_uncut.run(ansatz)\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"sampler = SamplerV2(mode=backend, options=options)\nuncut_job = sampler.run([transpiled_circuit])\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'uncut_job_id = uncut_job.job_id()\nprint(f"The job id for the uncut clifford circuit is {uncut_job_id}")\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"The job id for the uncut clifford circuit is cwxfads2ac5g008jhe7g\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"uncut_result = uncut_job.result()[0]\nuncut_counts = uncut_result.data.meas.get_counts()\n"})}),"\n",(0,t.jsx)(s.p,{children:"Now we shall calculate the average expectation values of all the weight-1 and weight-2 Z-type observables without cutting."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'uncut_expvals = [\n    sampled_expectation_value(uncut_counts, obs) for obs in paulis\n]\n\nuncut_weight_1 = np.mean(uncut_expvals[:num_qubits])\nuncut_weight_2 = np.mean(uncut_expvals[num_qubits:])\n\nprint(f"Average of weight-1 expectation values is {uncut_weight_1}")\nprint(f"Average of weight-2 expectation values is {uncut_weight_2}")\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"Average of weight-1 expectation values is -0.32494128440366965\nAverage of weight-2 expectation values is 0.32340917431192656\n"})}),"\n",(0,t.jsx)(s.h3,{id:"visualize",children:"Visualize"}),"\n",(0,t.jsx)(s.p,{children:"Let us now visualize the improvement obtained for weight-1 and weight-2 observables when using gate cutting for periodic chain circuit"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'mpl.rcParams.update(mpl.rcParamsDefault)\n\nfig = plt.subplots(figsize=(12, 8), dpi=200)\nwidth = 0.25\nlabels = ["Weight-1", "Weight-2"]\nx = np.arange(len(labels))\n\nideal = [-1, 1]\ncut = [cut_weight_1, cut_weight_2]\nuncut = [uncut_weight_1, uncut_weight_2]\n\nbr1 = np.arange(len(ideal))\nbr2 = [x + width for x in br1]\nbr3 = [x + width for x in br2]\n\nplt.bar(\n    br1, ideal, width=width, edgecolor="k", label="Ideal", color="#4589ff"\n)\nplt.bar(br2, cut, width=width, edgecolor="k", label="Cut", color="#a56eff")\nplt.bar(\n    br3, uncut, width=width, edgecolor="k", label="Uncut", color="#009d9a"\n)\n\nplt.axhline(y=0, color="k", linestyle="-")\n\nplt.xticks([r + width for r in range(len(ideal))], labels, fontsize=14)\nplt.yticks(fontsize=14)\n\nplt.legend(fontsize=14)\nplt.show()\n'})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Output of the previous code cell",src:n(29299).A+"",width:"2038",height:"1329"})}),"\n",(0,t.jsx)(s.h3,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(s.p,{children:"In summary, we calculated the average expectation values of weight-1 and weight-2 Z-types observables for a periodic 1D chain of 109 qubits. In order to do so, we"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["created a virtual coupling map by adding a long range connectivity between the first and the last qubits of the 1D chain, and transpiled the circuit.","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"transpilation at this stage allowed us to avoid the overhead of transpiling each subexperiment separately after cutting,"}),"\n",(0,t.jsx)(s.li,{children:"using virtual coupling map allowed us to avoid extra SWAP gates for the 2-qubit operation between the first and the last qubits."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:"removed the long range connectivity from the transpiled circuit via gate cutting."}),"\n",(0,t.jsx)(s.li,{children:"converted the cut circuits into basis gate set by applying appropriate transpilation passes."}),"\n",(0,t.jsxs)(s.li,{children:["executed the cut circuits on IBM Quantum device using a ",(0,t.jsx)(s.code,{children:"SamplerV2"})," primitive."]}),"\n",(0,t.jsx)(s.li,{children:"obtained the expectation value by reconstructing the outcomes of the cut circuits."}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"inference",children:"Inference"}),"\n",(0,t.jsxs)(s.p,{children:["We notice from the results that the average of the weight-1 ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e8"}),(0,t.jsx)(s.mi,{children:"Z"}),(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e9"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\langle Z \\rangle"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mopen",children:"\u27e8"}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"Z"}),(0,t.jsx)(s.span,{className:"mclose",children:"\u27e9"})]})})]})," and weight-2 ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e8"}),(0,t.jsx)(s.mi,{children:"Z"}),(0,t.jsx)(s.mi,{children:"Z"}),(0,t.jsx)(s.mo,{stretchy:"false",children:"\u27e9"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\langle ZZ \\rangle"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mopen",children:"\u27e8"}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"ZZ"}),(0,t.jsx)(s.span,{className:"mclose",children:"\u27e9"})]})})]})," type observables are significantly improved by cutting the periodic gates. Note that this study does not include any error suppression or mitigation techniques. The improvement observed is solely due to the proper usage of gate cutting for this problem. The results could have been further improved by using the mitigation and suppression techniques."]}),"\n",(0,t.jsx)(s.p,{children:"This study shows an example of effectively using gate cutting to improve the performance of computation."}),"\n",(0,t.jsx)(s.h2,{id:"tutorial-survey",children:"Tutorial survey"}),"\n",(0,t.jsx)(s.p,{children:"Please take this short survey to provide feedback on this tutorial. Your insights will help us improve our content offerings and user experience."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.a,{href:"https://your.feedback.ibm.com/jfe/form/SV_3fQQYAIjTxvIChg",children:"Link to survey"})})]})}function m(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},29299(e,s,n){n.d(s,{A:()=>i});const i=n.p+"assets/images/2ba8913f-ba35-409c-bc4c-5f28e3698f20-0-0648c641ed72666c7082a9a97e46e6d2.avif"},63190(e,s,n){n.d(s,{A:()=>i});const i=n.p+"assets/images/79428537-66cf-40ce-87cf-0f75f591cb4b-0-640f15684cb15e67528cad809f5accec.avif"},17683(e,s,n){n.d(s,{A:()=>i});const i=n.p+"assets/images/ad38aa32-4613-46c5-bf62-da332a1b9dfb-0-de377a78898b93120ac7b120093c8edc.avif"},28453(e,s,n){n.d(s,{R:()=>l,x:()=>r});var i=n(96540);const t={},a=i.createContext(t);function l(e){const s=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(a.Provider,{value:s},e.children)}}}]);