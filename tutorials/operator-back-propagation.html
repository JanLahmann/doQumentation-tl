<!doctype html>
<html lang="tl" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/operator-back-propagation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Operator backpropagation (OBP) for estimation of expectation values | doQumentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tl.doqumentation.org/img/rasqberry-social-card.png"><meta data-rh="true" name="twitter:image" content="https://tl.doqumentation.org/img/rasqberry-social-card.png"><meta data-rh="true" property="og:url" content="https://tl.doqumentation.org/tutorials/operator-back-propagation"><meta data-rh="true" property="og:locale" content="tl"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" property="og:locale:alternate" content="de"><meta data-rh="true" property="og:locale:alternate" content="es"><meta data-rh="true" property="og:locale:alternate" content="uk"><meta data-rh="true" property="og:locale:alternate" content="fr"><meta data-rh="true" property="og:locale:alternate" content="it"><meta data-rh="true" property="og:locale:alternate" content="pt"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" property="og:locale:alternate" content="ar"><meta data-rh="true" property="og:locale:alternate" content="he"><meta data-rh="true" name="docusaurus_locale" content="tl"><meta data-rh="true" name="docsearch:language" content="tl"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Operator backpropagation (OBP) for estimation of expectation values | doQumentation"><meta data-rh="true" name="description" content="In this tutorial we will implement a Qiskit pattern for simulating the quantum dynamics of a Heisenberg spin chain using qiskit-addon-obp"><meta data-rh="true" property="og:description" content="In this tutorial we will implement a Qiskit pattern for simulating the quantum dynamics of a Heisenberg spin chain using qiskit-addon-obp"><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://tl.doqumentation.org/tutorials/operator-back-propagation"><link data-rh="true" rel="alternate" href="https://doqumentation.org/tutorials/operator-back-propagation" hreflang="en"><link data-rh="true" rel="alternate" href="https://de.doqumentation.org/tutorials/operator-back-propagation" hreflang="de"><link data-rh="true" rel="alternate" href="https://es.doqumentation.org/tutorials/operator-back-propagation" hreflang="es"><link data-rh="true" rel="alternate" href="https://uk.doqumentation.org/tutorials/operator-back-propagation" hreflang="uk"><link data-rh="true" rel="alternate" href="https://fr.doqumentation.org/tutorials/operator-back-propagation" hreflang="fr"><link data-rh="true" rel="alternate" href="https://it.doqumentation.org/tutorials/operator-back-propagation" hreflang="it"><link data-rh="true" rel="alternate" href="https://pt.doqumentation.org/tutorials/operator-back-propagation" hreflang="pt"><link data-rh="true" rel="alternate" href="https://ja.doqumentation.org/tutorials/operator-back-propagation" hreflang="ja"><link data-rh="true" rel="alternate" href="https://tl.doqumentation.org/tutorials/operator-back-propagation" hreflang="tl"><link data-rh="true" rel="alternate" href="https://ar.doqumentation.org/tutorials/operator-back-propagation" hreflang="ar"><link data-rh="true" rel="alternate" href="https://he.doqumentation.org/tutorials/operator-back-propagation" hreflang="he"><link data-rh="true" rel="alternate" href="https://doqumentation.org/tutorials/operator-back-propagation" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Mga Tutorial","item":"https://tl.doqumentation.org/tutorials/"},{"@type":"ListItem","position":2,"name":"Operator backpropagation (OBP) for estimation of expectation values","item":"https://tl.doqumentation.org/tutorials/operator-back-propagation"}]}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<script src="https://unpkg.com/thebelab@0.4.0/lib/index.js" async></script><link rel="stylesheet" href="/assets/css/styles.9884e938.css">
<script src="/assets/js/runtime~main.fd77463d.js" defer="defer"></script>
<script src="/assets/js/main.36451ee5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Lumaktaw sa pangunahing nilalaman"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Lumaktaw sa pangunahing nilalaman</a></div><nav aria-label="Pangunahing nabigasyon" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="I-toggle ang navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="doQumentation Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="doQumentation Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">doQumentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/tutorials">Mga Tutorial</a><a class="navbar__item navbar__link" href="/guides">Mga Gabay</a><a class="navbar__item navbar__link" href="/learning/courses/basics-of-quantum-information">Mga Kurso</a><a class="navbar__item navbar__link" href="/learning/modules/computer-science">Mga Modyul</a><a href="https://quantum.cloud.ibm.com/docs/en/api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Sanggunian ng API<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link navbar-locale-dropdown"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Filipino</a><ul class="dropdown__menu"><li><a href="https://doqumentation.org/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="https://de.doqumentation.org/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="de">Deutsch</a></li><li><a href="https://es.doqumentation.org/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="https://uk.doqumentation.org/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="uk">Українська</a></li><li><a href="https://fr.doqumentation.org/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">Français</a></li><li><a href="https://it.doqumentation.org/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="it">Italiano</a></li><li><a href="https://pt.doqumentation.org/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li><li><a href="https://ja.doqumentation.org/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="tl">Filipino</a></li><li><a href="https://ar.doqumentation.org/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">العربية</a></li><li><a href="https://he.doqumentation.org/tutorials/operator-back-propagation" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="he">עברית</a></li></ul></div><a class="navbar__item navbar__link header-settings-link" aria-label="Settings" href="/jupyter-settings">Settings</a><a href="https://github.com/JanLahmann/doQumentation" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="System mode" aria-label="Magpalipat-lipat sa pagitan ng madilim at maliwanag na view (kasalukuyang System mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Maghanap" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Bumalik sa itaas" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Sidebar ng dokumentasyon" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/"><span title="Home" class="linkLabel_WmDU">Home</span></a></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/tutorials"><span title="Mga Tutorial" class="categoryLinkLabel_W154">Mga Tutorial</span></a><button aria-label="I-collapse ang kategorya ng sidebar na &#x27;Mga Tutorial&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/hello-world"><span title="Hello World: Your First Quantum Circuit" class="linkLabel_WmDU">Hello World: Your First Quantum Circuit</span></a></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tutorials/chsh-inequality"><span title="Magsimula" class="categoryLinkLabel_W154">Magsimula</span></a></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tutorials/sample-based-quantum-diagonalization"><span title="Tuklasin ang mga workflow tungo sa quantum advantage" class="categoryLinkLabel_W154">Tuklasin ang mga workflow tungo sa quantum advantage</span></a></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/tutorials/edc-cut-bell-pair-benchmarking"><span title="Samantalahin ang mga kakayahan ng Qiskit" class="categoryLinkLabel_W154">Samantalahin ang mga kakayahan ng Qiskit</span></a></div><ul class="menu__list"><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tutorials/edc-cut-bell-pair-benchmarking"><span title="Pag-optimize ng workload" class="categoryLinkLabel_W154">Pag-optimize ng workload</span></a></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tutorials/global-data-quantum-optimizer"><span title="Qiskit Functions" class="categoryLinkLabel_W154">Qiskit Functions</span></a></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/tutorials/multi-product-formula"><span title="Mga Qiskit addon" class="categoryLinkLabel_W154">Mga Qiskit addon</span></a></div><ul class="menu__list"><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/multi-product-formula"><span title="Mga multi-product formula para mabawasan ang Trotter error" class="linkLabel_WmDU">Mga multi-product formula para mabawasan ang Trotter error</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/approximate-quantum-compilation-for-time-evolution"><span title="Approximate quantum compilation para sa mga time evolution circuit" class="linkLabel_WmDU">Approximate quantum compilation para sa mga time evolution circuit</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tutorials/operator-back-propagation"><span title="Operator backpropagation (OBP) for estimation of expectation values" class="linkLabel_WmDU">Operator backpropagation (OBP) for estimation of expectation values</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/wire-cutting"><span title="Wire cutting for expectation values estimation" class="linkLabel_WmDU">Wire cutting for expectation values estimation</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/periodic-boundary-conditions-with-circuit-cutting"><span title="Circuit cutting for periodic boundary conditions" class="linkLabel_WmDU">Circuit cutting for periodic boundary conditions</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/depth-reduction-with-circuit-cutting"><span title="Circuit cutting for depth reduction" class="linkLabel_WmDU">Circuit cutting for depth reduction</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/readout-error-mitigation-sampler"><span title="Readout error mitigation for the Sampler primitive using M3" class="linkLabel_WmDU">Readout error mitigation for the Sampler primitive using M3</span></a></li></div></ul></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tutorials/probabilistic-error-amplification"><span title="Pagpapaliit ng error" class="categoryLinkLabel_W154">Pagpapaliit ng error</span></a></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tutorials/repetition-codes"><span title="Pagtuklas ng error" class="categoryLinkLabel_W154">Pagtuklas ng error</span></a></div></li></div></ul></li></div></ul></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/guides"><span title="Mga Gabay" class="categoryLinkLabel_W154">Mga Gabay</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga Gabay&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/learning/courses/basics-of-quantum-information"><span title="Mga Kurso" class="categoryLinkLabel_W154">Mga Kurso</span></a></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/learning/modules/computer-science"><span title="Mga Modyul" class="categoryLinkLabel_W154">Mga Modyul</span></a></div></li></div></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/tutorials"><span>Mga Tutorial</span></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Samantalahin ang mga kakayahan ng Qiskit</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Mga Qiskit addon</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Operator backpropagation (OBP) for estimation of expectation values</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sa pahinang ito</button></div><div class="theme-doc-markdown markdown"><header><h1>Operator backpropagation (OBP) for estimation of expectation values</h1></header>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Hindi pa naisalin</div><div class="admonitionContent_BuS1"><p>Ang pahinang ito ay hindi pa naisalin. Nakikita mo ang orihinal na bersyon sa Ingles.</p></div></div>
<!-- -->
<!-- -->
<p><em>Usage estimate: 16 minutes on an Eagle r3 processor (NOTE: This is an estimate only. Your runtime might vary.)</em></p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Added by doQumentation — installs packages not in the Binder environment</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q qiskit</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">addon</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obp</span></span><br></span></code></pre></div></div></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># This cell is hidden from users;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># it disables linting rules.</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ruff: noqa</span></span><br></span></code></pre></div></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="background">Background<a href="#background" class="hash-link" aria-label="Direktang link sa Background" title="Direktang link sa Background" translate="no">​</a></h2>
<p>Operator backpropagation is a technique which involves absorbing operations from the end of a quantum circuit into the measured observable, generally reducing the depth of the circuit at the cost of additional terms in the observable. The goal is to backpropagate as much of the circuit as possible without allowing the observable to grow too large. A Qiskit-based implementation is available in the OBP Qiskit addon, more details can be found in the corresponding <a class="" href="/guides/qiskit-addons-obp">docs</a> with a <a class="" href="/guides/qiskit-addons-obp-get-started">simple example</a> to get started.</p>
<p>Consider an example circuit for which an observable <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo>=</mo><msub><mo>∑</mo><mi>P</mi></msub><msub><mi>c</mi><mi>P</mi></msub><mi>P</mi></mrow><annotation encoding="application/x-tex">O = \sum_P c_P P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0497em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span> is to be measured, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span> are Paulis and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>P</mi></msub></mrow><annotation encoding="application/x-tex">c_P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> are coefficients. Let us denote the circuit as a single unitary <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">U</span></span></span></span> which can be logically partitioned into <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><msub><mi>U</mi><mi>C</mi></msub><msub><mi>U</mi><mi>Q</mi></msub></mrow><annotation encoding="application/x-tex">U = U_C U_Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> as shown in the figure below.</p>
<p><img decoding="async" loading="lazy" alt="Circuit diagram showing Uq followed by Uc" src="/assets/images/logical-partitioning-98d7dbc0384683f053f509d7190827de.avif" width="1596" height="542" class="img_ev3q"></p>
<p>Operator backpropagation absorbs the unitary <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">U_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> into the observable by evolving it as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>O</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><msubsup><mi>U</mi><mi>C</mi><mo lspace="0em" rspace="0em">†</mo></msubsup><mi>O</mi><msub><mi>U</mi><mi>C</mi></msub><mo>=</mo><msub><mo>∑</mo><mi>P</mi></msub><msub><mi>c</mi><mi>P</mi></msub><msubsup><mi>U</mi><mi>C</mi><mo lspace="0em" rspace="0em">†</mo></msubsup><mi>P</mi><msub><mi>U</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">O&#x27; = U_C^{\dagger}OU_C = \sum_P c_P U_C^{\dagger}PU_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2605em;vertical-align:-0.2935em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.967em"><span style="top:-2.4065em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">†</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2667em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.967em"><span style="top:-2.4065em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">†</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>. In other words, part of the computation is performed classically via the evolution of the observable from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>O</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">O&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>. The original problem can now be reformulated as measuring the observable <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>O</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">O&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> for the new lower depth circuit whose unitary is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>Q</mi></msub></mrow><annotation encoding="application/x-tex">U_Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span>.</p>
<p>The unitary <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">U_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is represented as a number of slices <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>C</mi></msub><mo>=</mo><msub><mi>U</mi><mi>S</mi></msub><msub><mi>U</mi><mrow><mi>S</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>U</mi><mn>2</mn></msub><msub><mi>U</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">U_C = U_S U_{S-1}...U_2U_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mord">...</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>. There are multiple ways for defining a slice. For instance, in the above example circuit, each layer of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mrow><mi>z</mi><mi>z</mi></mrow></msub></mrow><annotation encoding="application/x-tex">R_{zz}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">zz</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> and each layer of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">R_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> gates can be considered as an individual slice. Backpropagation involves calculation of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>O</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><msubsup><mi mathvariant="normal">Π</mi><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></msubsup><msub><mo>∑</mo><mi>P</mi></msub><msub><mi>c</mi><mi>P</mi></msub><msubsup><mi>U</mi><mi>s</mi><mo lspace="0em" rspace="0em">†</mo></msubsup><mi>P</mi><msub><mi>U</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">O&#x27; = \Pi_{s=1}^S \sum_P c_P U_s^{\dagger} P U_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1488em;vertical-align:-0.2997em"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-2.453em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">†</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> classically. Each slice <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">U_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> can be represented as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>s</mi></msub><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mfrac><mrow><mo>−</mo><mi>i</mi><msub><mi>θ</mi><mi>s</mi></msub><msub><mi>P</mi><mi>s</mi></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">U_s = exp(\frac{-i\theta_s P_s}{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2412em;vertical-align:-0.345em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">P_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-qubit Pauli and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\theta_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is a scalar. It is easy to verify that</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>U</mi><mi>s</mi><mo lspace="0em" rspace="0em">†</mo></msubsup><mi>P</mi><msub><mi>U</mi><mi>s</mi></msub><mo>=</mo><mi>P</mi><mspace width="2em"></mspace><mtext>if </mtext><mo stretchy="false">[</mo><mi>P</mi><mo separator="true">,</mo><msub><mi>P</mi><mi>s</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">U_s^{\dagger} P U_s = P \qquad \text{if} ~[P,P_s] = 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1461em;vertical-align:-0.247em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-2.453em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">†</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:2em"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace nobreak"> </span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>U</mi><mi>s</mi><mo lspace="0em" rspace="0em">†</mo></msubsup><mi>P</mi><msub><mi>U</mi><mi>s</mi></msub><mo>=</mo><mspace width="2em"></mspace><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>s</mi></msub><mo stretchy="false">)</mo><mi>P</mi><mo>+</mo><mi>i</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>s</mi></msub><mo stretchy="false">)</mo><msub><mi>P</mi><mi>s</mi></msub><mi>P</mi><mspace width="2em"></mspace><mtext>if </mtext><mo stretchy="false">{</mo><mi>P</mi><mo separator="true">,</mo><msub><mi>P</mi><mi>s</mi></msub><mo stretchy="false">}</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U_s^{\dagger} P U_s = \qquad cos(\theta_s)P + i sin(\theta_s)P_sP \qquad \text{if} ~\{P,P_s\} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1461em;vertical-align:-0.247em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-2.453em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">†</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:2em"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace nobreak"> </span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></span>
<p>In the above example, if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>P</mi><mo separator="true">,</mo><msub><mi>P</mi><mi>s</mi></msub><mo stretchy="false">}</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\{P,P_s\} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, then we need to execute two quantum circuits, instead of one, to calculate the expectation value. Therefore, backpropagation may increase the number of terms in the observable, leading to higher number of circuit execution. One way to allow for deeper backpropagation into the circuit, while preventing the operator from growing too large, is to truncate terms with small coefficients, rather than adding them to the operator. For instance, in the above example, one may choose to truncate the term involving <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>s</mi></msub><mi>P</mi></mrow><annotation encoding="application/x-tex">P_sP</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span> provided that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\theta_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is sufficiently small. Truncating terms can result in fewer quantum circuits to execute, but doing so results in some error in the final expectation value calculation proportional to the magnitude of the truncated terms&#x27; coefficients.</p>
<p>This tutorial implements a <a class="" href="/guides/intro-to-patterns">Qiskit pattern</a> for simulating the quantum dynamics of a Heisenberg spin chain using <a href="https://github.com/Qiskit/qiskit-addon-obp">qiskit-addon-obp</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="requirements">Requirements<a href="#requirements" class="hash-link" aria-label="Direktang link sa Requirements" title="Direktang link sa Requirements" translate="no">​</a></h2>
<p>Before starting this tutorial, be sure you have the following installed:</p>
<ul>
<li class="">Qiskit SDK v1.2 or later (<code>pip install qiskit</code>)</li>
<li class="">Qiskit Runtime v0.28 or later (<code>pip install qiskit-ibm-runtime</code>)</li>
<li class="">OBP Qiskit addon (<code>pip install qiskit-addon-obp</code>)</li>
<li class="">Qiskit addon utils (<code>pip install qiskit-addon-utils</code>)</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="setup">Setup<a href="#setup" class="hash-link" aria-label="Direktang link sa Setup" title="Direktang link sa Setup" translate="no">​</a></h2>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">primitives </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> StatevectorEstimator </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> Estimator</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transpiler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">preset_passmanagers </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> generate_preset_pass_manager</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">quantum_info </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SparsePauliOp</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transpiler </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> CouplingMap</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">synthesis </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> LieTrotter</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_addon_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">problem_generators </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> generate_xyz_hamiltonian</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_addon_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">problem_generators </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    generate_time_evolution_circuit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_addon_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">slicing </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> slice_by_gate_types</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> combine_slices</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_addon_obp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">simplify </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> OperatorBudget</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_addon_obp </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> backpropagate</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_addon_obp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">truncating </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> setup_budget</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> rustworkx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">visualization </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> graphviz_draw</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_ibm_runtime </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> QiskitRuntimeService</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_ibm_runtime </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> EstimatorV2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> EstimatorOptions</span></span><br></span></code></pre></div></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="part-i-small-scale-heisenberg-spin-chain">Part I: Small-scale Heisenberg spin chain<a href="#part-i-small-scale-heisenberg-spin-chain" class="hash-link" aria-label="Direktang link sa Part I: Small-scale Heisenberg spin chain" title="Direktang link sa Part I: Small-scale Heisenberg spin chain" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-1-map-classical-inputs-to-a-quantum-problem">Step 1: Map classical inputs to a quantum problem<a href="#step-1-map-classical-inputs-to-a-quantum-problem" class="hash-link" aria-label="Direktang link sa Step 1: Map classical inputs to a quantum problem" title="Direktang link sa Step 1: Map classical inputs to a quantum problem" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="map-the-time-evolution-of-a-quantum-heisenberg-model-to-a-quantum-experiment">Map the time-evolution of a quantum Heisenberg model to a quantum experiment.<a href="#map-the-time-evolution-of-a-quantum-heisenberg-model-to-a-quantum-experiment" class="hash-link" aria-label="Direktang link sa Map the time-evolution of a quantum Heisenberg model to a quantum experiment." title="Direktang link sa Map the time-evolution of a quantum Heisenberg model to a quantum experiment." translate="no">​</a></h4>
<p>The <a href="https://github.com/Qiskit/qiskit-addon-utils" target="_blank" rel="noopener noreferrer" class="">qiskit_addon_utils</a> package provides some reusable functionalities for various purposes.</p>
<p>Its <a href="https://docs.quantum.ibm.com/api/qiskit-addon-utils/problem-generators" target="_blank" rel="noopener noreferrer" class="">qiskit_addon_utils.problem_generators</a> module provides functions to generate Heisenberg-like Hamiltonians on a given connectivity graph.
This graph can be either a <a href="https://www.rustworkx.org/apiref/rustworkx.PyGraph.html" target="_blank" rel="noopener noreferrer" class="">rustworkx.PyGraph</a> or a <a href="https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.CouplingMap" target="_blank" rel="noopener noreferrer" class="">CouplingMap</a> making it easy to use in Qiskit-centric workflows.</p>
<p>In the following, we generate a linear chain <code>CouplingMap</code> of 10 qubits.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">num_qubits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">layout </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Instantiate a CouplingMap object</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">coupling_map </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CouplingMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">graphviz_draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">coupling_map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">graph</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> method</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;circo&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="1595" height="59" class="img_ev3q"></p>
<p>Next, we generate a Pauli operator modeling a Heisenberg XYZ Hamiltonian.</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi mathvariant="script">H</mi><mo>^</mo></mover><mrow><mi>X</mi><mi>Y</mi><mi>Z</mi></mrow></msub><mo>=</mo><munder><mo>∑</mo><mrow><mo stretchy="false">(</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>E</mi></mrow></munder><mo stretchy="false">(</mo><msub><mi>J</mi><mi>x</mi></msub><msubsup><mi>σ</mi><mi>j</mi><mi>x</mi></msubsup><msubsup><mi>σ</mi><mi>k</mi><mi>x</mi></msubsup><mo>+</mo><msub><mi>J</mi><mi>y</mi></msub><msubsup><mi>σ</mi><mi>j</mi><mi>y</mi></msubsup><msubsup><mi>σ</mi><mi>k</mi><mi>y</mi></msubsup><mo>+</mo><msub><mi>J</mi><mi>z</mi></msub><msubsup><mi>σ</mi><mi>j</mi><mi>z</mi></msubsup><msubsup><mi>σ</mi><mi>k</mi><mi>z</mi></msubsup><mo stretchy="false">)</mo><mo>+</mo><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><mi>V</mi></mrow></munder><mo stretchy="false">(</mo><msub><mi>h</mi><mi>x</mi></msub><msubsup><mi>σ</mi><mi>j</mi><mi>x</mi></msubsup><mo>+</mo><msub><mi>h</mi><mi>y</mi></msub><msubsup><mi>σ</mi><mi>j</mi><mi>y</mi></msubsup><mo>+</mo><msub><mi>h</mi><mi>z</mi></msub><msubsup><mi>σ</mi><mi>j</mi><mi>z</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\hat{\mathcal{H}}_{XYZ} = \sum_{(j,k)\in E} (J_{x} \sigma_j^{x} \sigma_{k}^{x} + J_{y} \sigma_j^{y} \sigma_{k}^{y} + J_{z} \sigma_j^{z} \sigma_{k}^{z}) + \sum_{j\in V} (h_{x} \sigma_j^{x} + h_{y} \sigma_j^{y} + h_{z} \sigma_j^{z})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.566em;vertical-align:-1.516em"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathcal" style="margin-right:0.00965em">H</span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0097em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em">X</span><span class="mord mathnormal mtight" style="margin-right:0.22222em">Y</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">Z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.809em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.4231em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3987em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.22222em">V</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4304em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.4231em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span>
<p>Where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(V,E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mclose">)</span></span></span></span> is the graph of the coupling map provided.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Get a qubit operator describing the Heisenberg XYZ model</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">hamiltonian </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_xyz_hamiltonian</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    coupling_map</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    coupling_constants</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    ext_magnetic_field</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hamiltonian</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SparsePauliOp([&#x27;IIIIIIIXXI&#x27;, &#x27;IIIIIIIYYI&#x27;, &#x27;IIIIIIIZZI&#x27;, &#x27;IIIIIXXIII&#x27;, &#x27;IIIIIYYIII&#x27;, &#x27;IIIIIZZIII&#x27;, &#x27;IIIXXIIIII&#x27;, &#x27;IIIYYIIIII&#x27;, &#x27;IIIZZIIIII&#x27;, &#x27;IXXIIIIIII&#x27;, &#x27;IYYIIIIIII&#x27;, &#x27;IZZIIIIIII&#x27;, &#x27;IIIIIIIIXX&#x27;, &#x27;IIIIIIIIYY&#x27;, &#x27;IIIIIIIIZZ&#x27;, &#x27;IIIIIIXXII&#x27;, &#x27;IIIIIIYYII&#x27;, &#x27;IIIIIIZZII&#x27;, &#x27;IIIIXXIIII&#x27;, &#x27;IIIIYYIIII&#x27;, &#x27;IIIIZZIIII&#x27;, &#x27;IIXXIIIIII&#x27;, &#x27;IIYYIIIIII&#x27;, &#x27;IIZZIIIIII&#x27;, &#x27;XXIIIIIIII&#x27;, &#x27;YYIIIIIIII&#x27;, &#x27;ZZIIIIIIII&#x27;, &#x27;IIIIIIIIIX&#x27;, &#x27;IIIIIIIIIY&#x27;, &#x27;IIIIIIIIIZ&#x27;, &#x27;IIIIIIIIXI&#x27;, &#x27;IIIIIIIIYI&#x27;, &#x27;IIIIIIIIZI&#x27;, &#x27;IIIIIIIXII&#x27;, &#x27;IIIIIIIYII&#x27;, &#x27;IIIIIIIZII&#x27;, &#x27;IIIIIIXIII&#x27;, &#x27;IIIIIIYIII&#x27;, &#x27;IIIIIIZIII&#x27;, &#x27;IIIIIXIIII&#x27;, &#x27;IIIIIYIIII&#x27;, &#x27;IIIIIZIIII&#x27;, &#x27;IIIIXIIIII&#x27;, &#x27;IIIIYIIIII&#x27;, &#x27;IIIIZIIIII&#x27;, &#x27;IIIXIIIIII&#x27;, &#x27;IIIYIIIIII&#x27;, &#x27;IIIZIIIIII&#x27;, &#x27;IIXIIIIIII&#x27;, &#x27;IIYIIIIIII&#x27;, &#x27;IIZIIIIIII&#x27;, &#x27;IXIIIIIIII&#x27;, &#x27;IYIIIIIIII&#x27;, &#x27;IZIIIIIIII&#x27;, &#x27;XIIIIIIIII&#x27;, &#x27;YIIIIIIIII&#x27;, &#x27;ZIIIIIIIII&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              coeffs=[0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j])</span><br></span></code></pre></div></div>
<p>From the qubit operator, we can generate a quantum circuit which models its time evolution.
Once again, the <a href="https://docs.quantum.ibm.com/api/qiskit-addon-utils/problem-generators" target="_blank" rel="noopener noreferrer" class="">qiskit_addon_utils.problem_generators</a> module comes to the rescue with a handy function do just that:</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">circuit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_time_evolution_circuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    hamiltonian</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    synthesis</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">LieTrotter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reps</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> style</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;iqp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scale</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.6</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="925" height="421" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-2-optimize-problem-for-quantum-hardware-execution">Step 2: Optimize problem for quantum hardware execution<a href="#step-2-optimize-problem-for-quantum-hardware-execution" class="hash-link" aria-label="Direktang link sa Step 2: Optimize problem for quantum hardware execution" title="Direktang link sa Step 2: Optimize problem for quantum hardware execution" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-circuit-slices-to-backpropagate">Create circuit slices to backpropagate<a href="#create-circuit-slices-to-backpropagate" class="hash-link" aria-label="Direktang link sa Create circuit slices to backpropagate" title="Direktang link sa Create circuit slices to backpropagate" translate="no">​</a></h4>
<p>Remember, the <code>backpropagate</code> function will backpropagate entire circuit slices at a time, so the choice of how to slice can have an impact on how well backpropagation performs for a given problem. Here, we will group gates of the same type into slices using the <a href="https://docs.quantum.ibm.com/api/qiskit-addon-utils/slicing#slice_by_gate_types" target="_blank" rel="noopener noreferrer" class="">slice_by_gate_types</a> function.</p>
<p>For a more detailed discussion on circuit slicing, check out this <a href="https://qiskit.github.io/qiskit-addon-utils/how_tos/create_circuit_slices.html" target="_blank" rel="noopener noreferrer" class="">how-to guide</a> of the <a href="https://github.com/Qiskit/qiskit-addon-utils" target="_blank" rel="noopener noreferrer" class="">qiskit-addon-utils</a> package.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">slices </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> slice_by_gate_types</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Separated the circuit into </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">slices</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> slices.&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Separated the circuit into 18 slices.</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="constrain-how-large-the-operator-may-grow-during-backpropagation">Constrain how large the operator may grow during backpropagation<a href="#constrain-how-large-the-operator-may-grow-during-backpropagation" class="hash-link" aria-label="Direktang link sa Constrain how large the operator may grow during backpropagation" title="Direktang link sa Constrain how large the operator may grow during backpropagation" translate="no">​</a></h4>
<p>During backpropagation, the number of terms in the operator will generally approach <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>4</mn><mi>N</mi></msup></mrow><annotation encoding="application/x-tex">4^N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span></span></span></span></span></span></span></span> quickly, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span> is the number of qubits. When two terms in the operator do not commute qubit-wise, we need separate circuits to obtain the expectation values corresponding to them. For example, if we have a 2-qubit observable <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo>=</mo><mn>0.1</mn><mi>X</mi><mi>X</mi><mo>+</mo><mn>0.3</mn><mi>I</mi><mi>Z</mi><mo>−</mo><mn>0.5</mn><mi>I</mi><mi>X</mi></mrow><annotation encoding="application/x-tex">O = 0.1 XX + 0.3 IZ - 0.5 IX</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord">0.1</span><span class="mord mathnormal" style="margin-right:0.07847em">XX</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord">0.3</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">0.5</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span>, then since <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>X</mi><mi>X</mi><mo separator="true">,</mo><mi>I</mi><mi>X</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">[XX,IX] = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em">XX</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, measurement in a single basis is sufficient to calculate the expectation values for these two terms. However, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">IZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mord mathnormal" style="margin-right:0.07153em">Z</span></span></span></span> anti-commutes with the other two terms. So we need a separate basis measurement to calculate the expectation value of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">IZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mord mathnormal" style="margin-right:0.07153em">Z</span></span></span></span>. In other words, we need two, instead of one, circuit to calculate <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><mi>O</mi><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\langle O \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">⟨</span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mclose">⟩</span></span></span></span>. As the number of terms in the operator increase, there is a possibility that the required number of circuit executions also increase.</p>
<p>The size of the operator can be bounded by specifying the <code>operator_budget</code> kwarg of the <code>backpropagate</code> function, which accepts an <a href="https://docs.quantum.ibm.com/api/qiskit-addon-obp/utils-simplify#operatorbudget" target="_blank" rel="noopener noreferrer" class="">OperatorBudget</a> instance.</p>
<p>To control the amount of extra resources (time) allocated, we restrict the maximum number of qubit-wise commuting Pauli groups that the backpropagated observable is allowed to have. Here we specify that backpropagation should stop when the number of qubit-wise commuting Pauli groups in the operator grows past 8.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">op_budget </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> OperatorBudget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_qwc_groups</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="backpropagate-slices-from-the-circuit">Backpropagate slices from the circuit<a href="#backpropagate-slices-from-the-circuit" class="hash-link" aria-label="Direktang link sa Backpropagate slices from the circuit" title="Direktang link sa Backpropagate slices from the circuit" translate="no">​</a></h4>
<p>First we specify the observable to be <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>Z</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">⟨</mo><msub><mi>Z</mi><mi>i</mi></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">M_Z = \frac{1}{N} \sum_{i=1}^N \langle Z_i \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">⟩</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span> being the number of qubits. We will backpropagate slices from the time-evolution circuit until the terms in the observable can no longer be combined into eight or fewer qubit-wise commuting Pauli groups.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">observable </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SparsePauliOp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_sparse_list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> num_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    num_qubits</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">num_qubits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">observable</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SparsePauliOp([&#x27;IIIIIIIIIZ&#x27;, &#x27;IIIIIIIIZI&#x27;, &#x27;IIIIIIIZII&#x27;, &#x27;IIIIIIZIII&#x27;, &#x27;IIIIIZIIII&#x27;, &#x27;IIIIZIIIII&#x27;, &#x27;IIIZIIIIII&#x27;, &#x27;IIZIIIIIII&#x27;, &#x27;IZIIIIIIII&#x27;, &#x27;ZIIIIIIIII&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              coeffs=[0.1+0.j, 0.1+0.j, 0.1+0.j, 0.1+0.j, 0.1+0.j, 0.1+0.j, 0.1+0.j, 0.1+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.1+0.j, 0.1+0.j])</span><br></span></code></pre></div></div>
<p>Below you will see that we backpropagated six slices, and the terms were combined into six and not eight groups. This implies that backpropagating one more slice would cause the number of Pauli groups to exceed eight. We can verify that this is the case by inspecting the returned metadata. Also note that in this portion the circuit transformation is exact.  That is, no terms of the new observable <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mtext>’</mtext></mrow><annotation encoding="application/x-tex">O’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord">’</span></span></span></span> were truncated. The backpropagated circuit and the backpropagated operator gives the exact outcome as the original circuit and operator.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Backpropagate slices onto the observable</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_obs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> remaining_slices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metadata </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> backpropagate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    observable</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> slices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> operator_budget</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">op_budget</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Recombine the slices remaining after backpropagation</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> combine_slices</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remaining_slices</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Backpropagated </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_backpropagated_slices</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> slices.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;New observable has </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">bp_obs</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">paulis</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> terms, which can be combined into </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">bp_obs</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">group_commuting</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">qubit_wise</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation boolean" style="color:#36acaa">True</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> groups.&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Note that backpropagating one more slice would result in </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">backpropagation_history</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation operator" style="color:#393A34">-</span><span class="token string-interpolation interpolation number" style="color:#36acaa">1</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_paulis</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> terms &quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;across </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">backpropagation_history</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation operator" style="color:#393A34">-</span><span class="token string-interpolation interpolation number" style="color:#36acaa">1</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_qwc_groups</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> groups.&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The remaining circuit after backpropagation looks as follows:&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fold</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scale</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.6</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Backpropagated 6 slices.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New observable has 60 terms, which can be combined into 6 groups.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Note that backpropagating one more slice would result in 114 terms across 12 groups.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The remaining circuit after backpropagation looks as follows:</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="654" height="421" class="img_ev3q"></p>
<p>Next, we will specify the same problem with the same constraints on the size of the output observable. However, this time, we allot an error budget to each slice using the <a href="https://docs.quantum.ibm.com/api/qiskit-addon-obp/utils-truncating#setup_budget" target="_blank" rel="noopener noreferrer" class="">setup_budget</a> function. Pauli terms with small coefficients will be truncated from each slice until the error budget is filled, and leftover budget will be added to the following slice&#x27;s budget. Note that in this case, the transformation due to backpropagation is approximate since some of the terms in the operator are truncated.</p>
<p>In order to enable this truncation, we need to setup our error budget like so:</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">truncation_error_budget </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> setup_budget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_error_per_slice</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.005</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>Note that by allocating <code>5e-3</code> error per slice for truncation, we are able to remove 1 more slice from the circuit, while remaining within the original budget of eight commuting Pauli groups in the observable. By default, <code>backpropagate</code> uses the L1 norm of the truncated coefficients to bound the total error incurred from truncation. For other options refer to the <a href="https://qiskit.github.io/qiskit-addon-obp/how_tos/bound_error_using_p_norm.html" target="_blank" rel="noopener noreferrer" class="">how-to guide on specifying the p_norm</a>.</p>
<p>In this particular example where we have backpropagated seven slices, the total truncation error should not exceed <code>(5e-3 error/slice) * (7 slices) = 3.5e-2</code>.
For further discussion on distributing an error budget across your slices, check out <a href="https://qiskit.github.io/qiskit-addon-obp/how_tos/truncate_operator_terms.html" target="_blank" rel="noopener noreferrer" class="">this how-to guide</a>.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Run the same experiment but truncate observable terms with small coefficients</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_obs_trunc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> remaining_slices_trunc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metadata </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> backpropagate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    observable</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    slices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    operator_budget</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">op_budget</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    truncation_error_budget</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">truncation_error_budget</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Recombine the slices remaining after backpropagation</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit_trunc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> combine_slices</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    remaining_slices_trunc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> include_barriers</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Backpropagated </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_backpropagated_slices</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> slices.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;New observable has </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">bp_obs_trunc</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">paulis</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> terms, which can be combined into </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">bp_obs_trunc</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">group_commuting</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">qubit_wise</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation boolean" style="color:#36acaa">True</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> groups.\n&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;After truncation, the error in our observable is bounded by </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">accumulated_error</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.3e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Note that backpropagating one more slice would result in </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">backpropagation_history</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation operator" style="color:#393A34">-</span><span class="token string-interpolation interpolation number" style="color:#36acaa">1</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_paulis</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> terms &quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;across </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">backpropagation_history</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation operator" style="color:#393A34">-</span><span class="token string-interpolation interpolation number" style="color:#36acaa">1</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_qwc_groups</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> groups.&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The remaining circuit after backpropagation looks as follows:&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit_trunc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scale</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.6</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Backpropagated 7 slices.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New observable has 82 terms, which can be combined into 8 groups.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">After truncation, the error in our observable is bounded by 3.266e-02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Note that backpropagating one more slice would result in 114 terms across 12 groups.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The remaining circuit after backpropagation looks as follows:</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="577" height="421" class="img_ev3q"></p>
<p>We note that truncation allows us to backpropagate further without increase in the number of commuting groups in the observable.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="now-that-we-have-our-reduced-ansatz-and-expanded-observables-we-can-transpile-our-experiments-to-the-backend">Now that we have our reduced ansatz and expanded observables, we can transpile our experiments to the backend.<a href="#now-that-we-have-our-reduced-ansatz-and-expanded-observables-we-can-transpile-our-experiments-to-the-backend" class="hash-link" aria-label="Direktang link sa Now that we have our reduced ansatz and expanded observables, we can transpile our experiments to the backend." title="Direktang link sa Now that we have our reduced ansatz and expanded observables, we can transpile our experiments to the backend." translate="no">​</a></h4>
<p>Here we will use a 127-qubit IBM® quantum computer to demonstrate how to transpile to a QPU backend.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">service </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QiskitRuntimeService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">backend </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> service</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">least_busy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    operational</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> simulator</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> min_num_qubits</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">127</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_preset_pass_manager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">backend</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> optimization_level</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transpile original experiment</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">circuit_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">observable_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> observable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit_isa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transpile backpropagated experiment</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_obs_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bp_obs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit_isa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transpile the backpropagated experiment with truncated observable terms</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit_trunc_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit_trunc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_obs_trunc_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bp_obs_trunc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit_trunc_isa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>We create the <a href="/guides/primitive-input-output">Primitive Unified Bloc (PUB)</a> for each of the three cases.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit_isa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> observable_isa</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_pub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit_isa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bp_obs_isa</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_trunc_pub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit_trunc_isa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bp_obs_trunc_isa</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-3-execute-using-qiskit-primitives">Step 3: Execute using Qiskit primitives<a href="#step-3-execute-using-qiskit-primitives" class="hash-link" aria-label="Direktang link sa Step 3: Execute using Qiskit primitives" title="Direktang link sa Step 3: Execute using Qiskit primitives" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="calculate-expectation-value">Calculate expectation value<a href="#calculate-expectation-value" class="hash-link" aria-label="Direktang link sa Calculate expectation value" title="Direktang link sa Calculate expectation value" translate="no">​</a></h4>
<p>Finally, we can run the backpropagated experiments and compare them with the full experiment using the noiseless <a href="https://docs.quantum.ibm.com/api/qiskit/qiskit.primitives.StatevectorEstimator" target="_blank" rel="noopener noreferrer" class="">StatevectorEstimator</a>.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ideal_estimator </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Estimator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run the experiments using Estimator primitive to obtain the exact outcome</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">result_exact </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    ideal_estimator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> observable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Exact expectation value: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">result_exact</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Exact expectation value: 0.8871244838989416</span><br></span></code></pre></div></div>
<p>We shall use <a href="/guides/configure-error-mitigation">resilience_level</a> = 2 for this example.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> EstimatorOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">default_precision </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.011</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">resilience_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">estimator </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> EstimatorV2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pub</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bp_pub</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bp_trunc_pub</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-4-post-process-and-return-result-to-desired-classical-format">Step 4: Post-process and return result to desired classical format<a href="#step-4-post-process-and-return-result-to-desired-classical-format" class="hash-link" aria-label="Direktang link sa Step 4: Post-process and return result to desired classical format" title="Direktang link sa Step 4: Post-process and return result to desired classical format" translate="no">​</a></h3>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">result_no_bp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">result_bp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">result_bp_trunc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">std_no_bp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stds</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">std_bp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stds</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">std_bp_trunc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stds</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Expectation value without backpropagation: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">result_no_bp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> ± </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">std_no_bp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Backpropagated expectation value: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">result_bp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> ± </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">std_bp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Backpropagated expectation value with truncation: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">result_bp_trunc</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> ± </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">std_bp_trunc</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Expectation value without backpropagation: 0.8033194665993642</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Backpropagated expectation value: 0.8599808781259016</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Backpropagated expectation value with truncation: 0.8868736004169483</span><br></span></code></pre></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">methods </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;No backpropagation&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Backpropagation&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Backpropagation w/ truncation&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">values </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">result_no_bp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result_bp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result_bp_trunc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">stds </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">std_no_bp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std_bp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std_bp_trunc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gca</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">methods</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;#a56eff&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> width</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> edgecolor</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;#8a3ffc&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">axhline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result_exact</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_ylim</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.92</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.895</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Exact result&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_ylabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&quot;$M_Z$&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fontsize</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Text(0, 0.5, &#x27;$M_Z$&#x27;)</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="629" height="413" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="part-b-scale-it-up">Part B: Scale it up!<a href="#part-b-scale-it-up" class="hash-link" aria-label="Direktang link sa Part B: Scale it up!" title="Direktang link sa Part B: Scale it up!" translate="no">​</a></h2>
<p>Let us now use Operator Backpropagation to study the dynamics of the Hamiltonian of a 50-qubit Heisenberg Spin Chain.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-1-map-classical-inputs-to-a-quantum-problem-1">Step 1: Map classical inputs to a quantum problem<a href="#step-1-map-classical-inputs-to-a-quantum-problem-1" class="hash-link" aria-label="Direktang link sa Step 1: Map classical inputs to a quantum problem" title="Direktang link sa Step 1: Map classical inputs to a quantum problem" translate="no">​</a></h3>
<p>We consider a 50-qubit Hamiltonian <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi mathvariant="script">H</mi><mo>^</mo></mover><mrow><mi>X</mi><mi>Y</mi><mi>Z</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{\mathcal{H}}_{XYZ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0968em;vertical-align:-0.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathcal" style="margin-right:0.00965em">H</span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0097em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em">X</span><span class="mord mathnormal mtight" style="margin-right:0.22222em">Y</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">Z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> for the scaled up problem with the same values for the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> coefficients as in the small-scale example. The observable <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>Z</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">⟨</mo><msub><mi>Z</mi><mi>i</mi></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">M_Z = \frac{1}{N} \sum_{i=1}^N \langle Z_i \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">⟩</span></span></span></span> is also the same as before. This problem is beyond classical brute-force simulation.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">num_qubits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">layout </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Instantiate a CouplingMap object</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">coupling_map </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CouplingMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">graphviz_draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">coupling_map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">graph</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> method</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;circo&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="8315" height="59" class="img_ev3q"></p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">hamiltonian </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_xyz_hamiltonian</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    coupling_map</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    coupling_constants</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    ext_magnetic_field</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hamiltonian</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SparsePauliOp([&#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXI&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYI&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZI&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXX&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYY&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZ&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIYYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;XXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;YYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;ZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIX&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIY&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZ&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXI&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYI&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZI&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IYIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;XIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;YIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;ZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              coeffs=[0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.78539816+0.j, 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.57079633+0.j, 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.39269908+0.j, 0.78539816+0.j, 1.57079633+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.04719755+0.j, 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.52359878+0.j, 0.34906585+0.j, 1.04719755+0.j, 0.52359878+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.34906585+0.j])</span><br></span></code></pre></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">observable </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SparsePauliOp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_sparse_list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> num_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    num_qubits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">observable</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SparsePauliOp([&#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZ&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZI&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;ZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              coeffs=[0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j, 0.02+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.02+0.j])</span><br></span></code></pre></div></div>
<p>For this scaled up problem we have considered the time of evolution as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.2</mn></mrow><annotation encoding="application/x-tex">0.2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.2</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">4</span></span></span></span> trotter steps. The problem is selected so that it is beyond classical brute-force simulation, but can be simulated by tensor network method. This allows us to verify the outcome obtained via backpropagation on a quantum computer with the ideal outcome.</p>
<p>The ideal expectation value for this problem, as obtained via tensor network simulation, is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≃</mo><mn>0.89</mn></mrow><annotation encoding="application/x-tex">\simeq 0.89</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4637em"></span><span class="mrel">≃</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.89</span></span></span></span>.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">circuit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_time_evolution_circuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    hamiltonian</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    synthesis</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">LieTrotter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reps</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> style</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;iqp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fold</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scale</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.6</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="/assets/images/b10d16cf-95da-42c0-9b47-b2e5a8516c82-0-5157e109ca93b652a7b4ed045dfcb703.avif" width="1783" height="1966" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-2-optimize-problem-for-quantum-hardware-execution-1">Step 2: Optimize problem for quantum hardware execution<a href="#step-2-optimize-problem-for-quantum-hardware-execution-1" class="hash-link" aria-label="Direktang link sa Step 2: Optimize problem for quantum hardware execution" title="Direktang link sa Step 2: Optimize problem for quantum hardware execution" translate="no">​</a></h3>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">slices </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> slice_by_gate_types</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Separated the circuit into </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">slices</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> slices.&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Separated the circuit into 36 slices.</span><br></span></code></pre></div></div>
<p>We specify the <code>max_error_per_slice</code> to be 0.005 as before. However, since the number of slices for this large-scale problem is much higher than the small scale problem, allowing an error of 0.005 per slice may end up creating a large overall backpropagation error. We can bound this by specifying <code>max_error_total</code> which bounds the total backpropagation error, and we set its value to 0.03 (which is roughly the same as in the small-scale example).</p>
<p>For this large-scale example, we allow a higher value for the number of commuting groups, and set it to 15.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">op_budget </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> OperatorBudget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_qwc_groups</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">truncation_error_budget </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> setup_budget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    max_error_total</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.03</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max_error_per_slice</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.005</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>Let us first obtain the backpropagated circuit and observable without any truncation.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_obs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> remaining_slices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metadata </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> backpropagate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    observable</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> slices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> operator_budget</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">op_budget</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> combine_slices</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remaining_slices</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Backpropagated </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_backpropagated_slices</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> slices.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;New observable has </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">bp_obs</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">paulis</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> terms, which can be combined into </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">bp_obs</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">group_commuting</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">qubit_wise</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation boolean" style="color:#36acaa">True</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> groups.&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Note that backpropagating one more slice would result in </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">backpropagation_history</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation operator" style="color:#393A34">-</span><span class="token string-interpolation interpolation number" style="color:#36acaa">1</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_paulis</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> terms &quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;across </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">backpropagation_history</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation operator" style="color:#393A34">-</span><span class="token string-interpolation interpolation number" style="color:#36acaa">1</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_qwc_groups</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> groups.&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The remaining circuit after backpropagation looks as follows:&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fold</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scale</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.6</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Backpropagated 7 slices.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New observable has 634 terms, which can be combined into 12 groups.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Note that backpropagating one more slice would result in 1246 terms across 27 groups.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The remaining circuit after backpropagation looks as follows:</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="/assets/images/164e2f00-25b6-4cf1-98f8-8b2886f007ee-1-a3bd011b8cd375fb5369a32935846e61.avif" width="1436" height="1966" class="img_ev3q"></p>
<p>Now allowing for truncation, we obtain:</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_obs_trunc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> remaining_slices_trunc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metadata </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> backpropagate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    observable</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    slices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    operator_budget</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">op_budget</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    truncation_error_budget</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">truncation_error_budget</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Recombine the slices remaining after backpropagation</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit_trunc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> combine_slices</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    remaining_slices_trunc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> include_barriers</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Backpropagated </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_backpropagated_slices</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> slices.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;New observable has </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">bp_obs_trunc</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">paulis</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> terms, which can be combined into </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">bp_obs_trunc</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">group_commuting</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">qubit_wise</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation boolean" style="color:#36acaa">True</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> groups.\n&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;After truncation, the error in our observable is bounded by </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">accumulated_error</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.3e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Note that backpropagating one more slice would result in </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">backpropagation_history</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation operator" style="color:#393A34">-</span><span class="token string-interpolation interpolation number" style="color:#36acaa">1</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_paulis</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> terms &quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;across </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">metadata</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">backpropagation_history</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation operator" style="color:#393A34">-</span><span class="token string-interpolation interpolation number" style="color:#36acaa">1</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_qwc_groups</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> groups.&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The remaining circuit after backpropagation looks as follows:&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit_trunc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fold</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scale</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.6</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Backpropagated 10 slices.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New observable has 646 terms, which can be combined into 14 groups.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">After truncation, the error in our observable is bounded by 2.998e-02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Note that backpropagating one more slice would result in 1226 terms across 29 groups.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The remaining circuit after backpropagation looks as follows:</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="/assets/images/c05a85bc-e5ca-4e02-8c96-98b28811f335-1-555baae87e1dc7483a36973c336efecc.avif" width="1320" height="1966" class="img_ev3q"></p>
<p>We note that allowing truncation leads to the backpropagation of three more slices. We can verify the 2-qubit depth of the original circuit, the backpropagated circuit, and the backpropagated circuit with truncation after transpilation.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Transpile original experiment</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">circuit_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">observable_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> observable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit_isa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transpile the backpropagated experiment</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_obs_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bp_obs_trunc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit_isa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transpile the backpropagated experiment with truncated observable terms</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_circuit_trunc_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit_trunc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bp_obs_trunc_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bp_obs_trunc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit_trunc_isa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;2-qubit depth of original circuit: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">circuit_isa</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">depth</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation keyword" style="color:#00009f">lambda</span><span class="token string-interpolation interpolation"> x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">operation</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_qubits</span><span class="token string-interpolation interpolation operator" style="color:#393A34">==</span><span class="token string-interpolation interpolation number" style="color:#36acaa">2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;2-qubit depth of backpropagated circuit: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">bp_circuit_isa</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">depth</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation keyword" style="color:#00009f">lambda</span><span class="token string-interpolation interpolation"> x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">operation</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_qubits</span><span class="token string-interpolation interpolation operator" style="color:#393A34">==</span><span class="token string-interpolation interpolation number" style="color:#36acaa">2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;2-qubit depth of backpropagated circuit with truncation: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">bp_circuit_trunc_isa</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">depth</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation keyword" style="color:#00009f">lambda</span><span class="token string-interpolation interpolation"> x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">operation</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_qubits</span><span class="token string-interpolation interpolation operator" style="color:#393A34">==</span><span class="token string-interpolation interpolation number" style="color:#36acaa">2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2-qubit depth of original circuit: 48</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2-qubit depth of backpropagated circuit: 40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2-qubit depth of backpropagated circuit with truncation: 36</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-3-execute-using-qiskit-primitives-1">Step 3: Execute using Qiskit primitives<a href="#step-3-execute-using-qiskit-primitives-1" class="hash-link" aria-label="Direktang link sa Step 3: Execute using Qiskit primitives" title="Direktang link sa Step 3: Execute using Qiskit primitives" translate="no">​</a></h3>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pubs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit_isa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> observable_isa</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit_isa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bp_obs_isa</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bp_circuit_trunc_isa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bp_obs_trunc_isa</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span></span><br></span></code></pre></div></div></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> EstimatorOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">default_precision </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.01</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">resilience_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">resilience</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zne</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">noise_factors </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">resilience</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zne</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">extrapolator </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;linear&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">estimator </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> EstimatorV2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pubs</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-4-post-process-and-return-result-to-desired-classical-format-1">Step 4: Post-process and return result to desired classical format<a href="#step-4-post-process-and-return-result-to-desired-classical-format-1" class="hash-link" aria-label="Direktang link sa Step 4: Post-process and return result to desired classical format" title="Direktang link sa Step 4: Post-process and return result to desired classical format" translate="no">​</a></h3>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">result_no_bp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">result_bp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">result_bp_trunc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Expectation value without backpropagation: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">result_no_bp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Backpropagated expectation value: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">result_bp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Backpropagated expectation value with truncation: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">result_bp_trunc</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Expectation value without backpropagation: 0.7887194658035515</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Backpropagated expectation value: 0.9532818300978584</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Backpropagated expectation value with truncation: 0.8913400398926913</span><br></span></code></pre></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">methods </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;No backpropagation&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Backpropagation&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Backpropagation w/ truncation&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">values </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">result_no_bp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result_bp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result_bp_trunc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gca</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">methods</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;#a56eff&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> width</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> edgecolor</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;#8a3ffc&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">axhline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.89</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_ylim</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.98</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.895</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Exact result&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_ylabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&quot;$M_Z$&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fontsize</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Text(0, 0.5, &#x27;$M_Z$&#x27;)</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,AAAAHGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZgAAAYRtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAANGlsb2MAAAAAREAAAgACAAAAAAGoAAEAAAAAAAAALwABAAAAAAHXAAEAAAAAAAALvwAAADhpaW5mAAAAAAACAAAAFWluZmUCAAAAAAEAAGF2MDEAAAAAFWluZmUCAAAAAAIAAGF2MDEAAAAAw2lwcnAAAACdaXBjbwAAABNjb2xybmNseAABAA0ABoAAAAAMYXYxQ4EBHAAAAAAUaXNwZQAAAAAAAAJ1AAABnQAAAA5waXhpAAAAAAEIAAAAOGF1eEMAAAAAdXJuOm1wZWc6bXBlZ0I6Y2ljcDpzeXN0ZW1zOmF1eGlsaWFyeTphbHBoYQAAAAAMYXYxQ4EBDAAAAAAQcGl4aQAAAAADCAgIAAAAHmlwbWEAAAAAAAAAAgABBAGGAwcAAgSCAwSFAAAAGmlyZWYAAAAAAAAADmF1eGwAAgABAAEAAAv2bWRhdBIACgcYZidM4wqAMiISAAooQLYY0zp885zACdkZsAbt7pOmtaFRLh0mo8bByklEEgAKChhmJ0zjBAQ0GhAyrhdMgAK0fS2bGnWTqlD3Ayty84W4O4LwWuPvAj81B2WBXsBLp81azv0nWcfgCSPceY29+HBpO5L9OdxEdZRWbOLgS01GyKJ3Jxc9wzdSFp0aFP+LaGOxx9fWQNrb3Y18SJNYG9BBum9uiXqU5c2B8a+9O4+/ZMd35PUfsKz64zD8zuld/Z7p2xNlR8NKHHdjUZVRcF9sVg10w6pIdjMxMcTc6ECTjZenPDhFeEqP39CMg3Xm9XQrrLdWPnYC1pb14iIgu2bm7UJI9q1LjW4iUFNvQdbyIW2MKmMISefTLEjP6iM2UmzE1buQRhidN0J/975/btz/Nb76SxHk2JfI9VUlIFLsMETCkV9d9dJVwAAaJBpeGRfmsVMEkYfwMJVS0gsPhDnH+GZGMpWr8ccMbm2/iz0dT/7dToaVQFBgeo2S4a1OxzP5DxPq7+OL9WV7s4155GXxMhK35a9/jdF++V/kstdGm1LdZk+q2vUUtZjcLxu1K8G8cKJY2PwAI6bgRLjGN/RoaSTnZor2OSQb0BHJ2SBkArLDNHCkKEZV3vksbxD/d0Plz/NWJ9mnFbLrxOd5xU7qOZhaVKbG9P63LmodHjsUnndCD/BCJHFd5mrwv6TeTn1e3uTFDgZb6IBRtf3FpaQB+SLa7FUE7omyRydT/mmz3AEfU7RCxt3elIEdY+6ZeLQhkjn08Ieng5LUaUalcoUR5wwwrFL2CikWSZ4fgPhpWywMGH6agOCV274vX8b8f/fDoqA9ZrPurqH7HYHoUg0NznSa6yVsM/+EburGnR+uDfJn83knkW2WPi75S+31GbVQ1yD67WE3UiCZYtHd4WDA02EXDB42FUmboyGN+EQECUz+eRTRIC/f2nqXsLJ+YFXTYair1/IuH8XuFFGVYU7AW38qAbqTkvk8Phs6B/Itl9zp78dBcNgdS147i//rX1S1lo5hLQ1Ym78Hpq1/ugXYUg0DnHXx7q86s3+on3FSiyVPKwZOBWqEtId35Z2H3Iu1zsPCk8Z4xWzr8oaiD2qkrMHzhW/OuwEOctYXALy3obDZxDtobbYCPi0kMPbhUVqgHNxIELd0pZKv6/c1MJaFCCxQbDr+ZbMjz+xDBgtGYG9cceCvKdG38XVMjfaczGVNypNn2VT5gLvEKCDcCN1eeKFD224t+eriSVuHWLdFoEWvI/u0qZdcC9kofc8BiN867v2q6oSsvx8SQuLmTLSL6Iz78HqRvtQyxI/FjGHoEd+yYDSuKybFNvTvUsFj+o7kANoiyA0+0yCZKAwE9KQ6xNntPL0NNIm8WSSAReO+i7ocFE8ERgOyntOR5IBbobHDevZqp6iPxXqvmyVs5fop6gzINAsQCFFLVaiN8dLaIE/x/5CvtuwnGx8G0BOMB2xHQcs8j+ArIPpG4VXilsmfHQwkNX6WX6vyuGx/VFf4ZIr0MDNNTYMvkQgIbac6utfIPsvSt2MWrgBhzG7KbBcE/FVKt1xC9wNsaHKhwPZHQPnuMgVL2JpAGdsdCoxeV+UzCsRf919w46G9uHpWa9p7JgIfnr8wNJyaiTHijKfTrU1A8meE6x3JBWGTJPyzMqy1DyLM8L0/2KdgVn1KFMQtb0G4Anz+tMxem5zXvhVDZRpzCR6Qo5pCXNC4TM8rfXExyzrbccc36eG/NiDMq+rmi5/e1pxcWMkFk5kXESKehcSYk9jjrUbm1NBOXPRfM22zJgvG/QGfZ2gUe9eKXHgSGgoTR9mjBx2gr6vsNToKYuNL1naUSplP/HEh3nCRnbEJi01a+dPrkHbiYXjpT7RdCOULu+d18BuVbYevTRd5qkVozlq2fmjw231MrQiiIOBHnnQbHBQGddpiNzBZUnO+IYtYoNBnF2hr/aSAzzhdpIUbrFwuCRHZmOCphePamvkWvjU3o6d+Cx7pVBokAS8UeHFyBgmO/pN5CwgSEun7SvfNaa5eW715hw/ZKorSTRxjWIfafOJHVyhII9f4Fplh6UrUDt1KWeOTUCKeGyC0Xg+kqXoFU8bLUA6IP8v0/HQw5HnBx2/zbRI3PCqz1vbGnwdBswP77n/BJplDuj30+esj5zvvtUb1UVo1mlpDqK21/4joQV9sH6s1tBf4ee4stSHXu1A7xY09AG/pjXTT/OYF+AN1PMl2W2sfmpo/H2mSirQClAZDXUc6a3AmcYAFnd5DY0t8fAGq2wwUfs2sLsIHdfKV3inZDzYgi3HJ10rvuvhHDnRmgJe2sRMIpQRZm/tlQXuYqot62c/mdKNEENfmYBOwb5ryzZkcvxwtaVhkHZ2LL3/mSzHFMVpBZuIWvP2hCkK0X/vdezAh1LD7xKa0TgyJZYvY5RNIF8t7GBzUh0SVwAfHFGeMPgv2NVPJonmvs0JpOFZ1statU5kl3+SCKTY6P8ikXtZJPHOouns1PWpbNNkvPtzOlmvUeZsN6EskvXP8Xm7oJoN52y053wvGBOWD97A3Yus7L840SFLCnB8fESUDTQcLlsY/UeVJEiwze9gFubzxd+Ls2Jp1fVBdO6VuFxrN8IPjMLXnp6j1Gh4YKUFIgxZXF/PJyCMELxMZ0IW+bs/AHw+2uKHb9Iu9ZU50jsE7xbqHtPgGaMfgTP4xrjC26L0sgrkm4i1YUCGrr8oQFokAw4ZkIiiVuzMtnSIW7UHo46lCX4S0ERgarSVdjNVfFY1zcVqSW8UTOrgdtaSSUuUOfHoKxa5rgdMDyqtwFOxAmVbVwmOMtvYWHrgAtS6GVidNpgeBHqSbhLi4qNKs7Fkev6XWDg8d7iDfX3TgQYMlLcZMgfJCeeNweoCRNZXC1BkoolzAYX/ZTl/bHbJ+0K7uvdF49ogb07ytBNS0kSRSGx69U86VQy+qimtBL1pPHFmtDv3GW28u22RyICv+KIalCp9hUSeMGOtbKvd3HMw/OU825GmRLDPBZ1o2qpeRiP2pF4AdcFLvXbVr9kfO8fBdvzwDi3KJGg+/acqkQWT0Dqe2pFfiJwedn/FcgblWTDLMXUpe3zubjmGQcLaGoSMkzrsXZ505liG5Xes8T7H/amZo+NIp4kDUm3nRQobO9rBwGXfAoPGbXJkINMmYaRVF7+Fx9sfW+EV8YaAV4+EE7f5xFMxbnpEziqebc7DwCMbVKrUIgW5VuhiohRwua2zJgkjGeGWbuF/kZ1GO8BzJdSOoZVZYbD9PLg+ALZzfTp3BAva/FODCyW8fIqIbNw+ogtyQXkiO1lbo3PtBVPnbq5J6EYr72Z2zfdFe5/cbHQQnr7uJcAGDFTHXB9EJOE/bj7TnnXlJB9ejhvdq3S9erZM+MOYyUPvdYHGewVVUTo5bAZLXGwMwQFnygcldgYSd/fbPooynbNADs44HJ1CuwOJ6BWNeBG97/nhasiGZLUNL3f+5Pp8KVc0TkaXoZJ13kwla9NTcykqadH/e/JB4KnCUTDqIBdhqpy9JU9xGWavkMFFrXDSlOA9GQR6Phh7yifjJvxCJLIOk9FuK0ItlfyjkxEaspZ5NLUwk2nPkMc17GJJSHk9638LT/C5P+jbHQN6iLhBXkhL8i9/Or7ERZj15+5ItEBExjiE6jC3Hle9Pkll4mFYh3AXG7MqW2T40rcM+c7eFlMhSXWhGmJ7dhZwghFpnRDGELzzzkC6JwIme0lOCZh3/z1CrAJ5D4UZAovTeS16kOG0eiY1eeMRsvwqP/8S/MUzXtlr2c1Sd5mtB3KG+v43VEPeW3zpWbBHW/4hUeU5wjZHLRIBaLrINtnzNq1YXBekZUbcJHp9+Rj6Shl9TNO1wB8UIPD/FjPuS6h1gmQ+DAJPUMFRQjqRiTrHobGa9ixcrybtAk4wAgEgABvC9U1tch+fPaxGxRlRWFvsjYnmx3saG+Dg9bYqXQ/KvfShH1ix23LJSs3TEFNa+kXfiuWLJ4UgCeyo9NweUMoFbLQBfgf3DvVU9D+NY/Nf/dWa+/vH+UnMa8xv1gTTZQxF/aHvyUCtLb5ADkOl2QA==" width="629" height="413" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="tutorial-survey">Tutorial survey<a href="#tutorial-survey" class="hash-link" aria-label="Direktang link sa Tutorial survey" title="Direktang link sa Tutorial survey" translate="no">​</a></h2>
<p>Please take this short survey to provide feedback on this tutorial. Your insights will help us improve our content offerings and user experience.</p>
<p><a href="https://your.feedback.ibm.com/jfe/form/SV_6LpyEKfDKBjqsWW" target="_blank" rel="noopener noreferrer" class="">Link to survey</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><div class="dq-edit-bookmark-row"><a href="https://github.com/JanLahmann/doQumentation/tree/main/docs/tutorials/operator-back-propagation.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>I-edit ang pahinang ito</a><button class="dq-bookmark-button" title="Bookmark this page" aria-label="Bookmark this page"><span class="dq-bookmark-button__icon" aria-hidden="true">☆</span>Bookmark</button></div></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Mga pahina ng dokumentasyon"><a class="pagination-nav__link pagination-nav__link--prev" href="/tutorials/approximate-quantum-compilation-for-time-evolution"><div class="pagination-nav__sublabel">Nakaraan</div><div class="pagination-nav__label">Approximate quantum compilation para sa mga time evolution circuit</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/tutorials/wire-cutting"><div class="pagination-nav__sublabel">Susunod</div><div class="pagination-nav__label">Wire cutting for expectation values estimation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a></li><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li><li><a href="#setup" class="table-of-contents__link toc-highlight">Setup</a></li><li><a href="#part-i-small-scale-heisenberg-spin-chain" class="table-of-contents__link toc-highlight">Part I: Small-scale Heisenberg spin chain</a><ul><li><a href="#step-1-map-classical-inputs-to-a-quantum-problem" class="table-of-contents__link toc-highlight">Step 1: Map classical inputs to a quantum problem</a></li><li><a href="#step-2-optimize-problem-for-quantum-hardware-execution" class="table-of-contents__link toc-highlight">Step 2: Optimize problem for quantum hardware execution</a></li><li><a href="#step-3-execute-using-qiskit-primitives" class="table-of-contents__link toc-highlight">Step 3: Execute using Qiskit primitives</a></li><li><a href="#step-4-post-process-and-return-result-to-desired-classical-format" class="table-of-contents__link toc-highlight">Step 4: Post-process and return result to desired classical format</a></li></ul></li><li><a href="#part-b-scale-it-up" class="table-of-contents__link toc-highlight">Part B: Scale it up!</a><ul><li><a href="#step-1-map-classical-inputs-to-a-quantum-problem-1" class="table-of-contents__link toc-highlight">Step 1: Map classical inputs to a quantum problem</a></li><li><a href="#step-2-optimize-problem-for-quantum-hardware-execution-1" class="table-of-contents__link toc-highlight">Step 2: Optimize problem for quantum hardware execution</a></li><li><a href="#step-3-execute-using-qiskit-primitives-1" class="table-of-contents__link toc-highlight">Step 3: Execute using Qiskit primitives</a></li><li><a href="#step-4-post-process-and-return-result-to-desired-classical-format-1" class="table-of-contents__link toc-highlight">Step 4: Post-process and return result to desired classical format</a></li></ul></li><li><a href="#tutorial-survey" class="table-of-contents__link toc-highlight">Tutorial survey</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">doQumentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/features">Mga Tampok</a></li><li class="footer__item"><a class="footer__link-item" href="/jupyter-settings">Settings</a></li><li class="footer__item"><a href="https://github.com/JanLahmann/doQumentation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">RasQberry</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://rasqberry.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">RasQberry<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/JanLahmann/RasQberry-Two" target="_blank" rel="noopener noreferrer" class="footer__link-item">RasQberry GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">IBM Quantum &amp; Qiskit</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://quantum.cloud.ibm.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBM Quantum<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://quantum.cloud.ibm.com/docs/en/guides" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dokumentasyon ng Qiskit<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/Qiskit/documentation" target="_blank" rel="noopener noreferrer" class="footer__link-item">Qiskit Docs GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://qisk.it/join-slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Qiskit Slack<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Ang nilalaman ng <a href="https://github.com/Qiskit/documentation">Dokumentasyon ng Qiskit</a> © IBM Corp. Ang code ay lisensyado sa ilalim ng Apache 2.0; ang nilalaman (mga tutorial, kurso, media) sa ilalim ng CC BY-SA 4.0.<br>Ang IBM, IBM Quantum at Qiskit ay mga tatak ng IBM Corporation.<br>Ang doQumentation ay bahagi ng proyektong <a href="https://rasqberry.org/">RasQberry</a> at hindi nauugnay, sinusuportahan, o sponsoran ng IBM Corporation.</div></div></div></footer></div>
</body>
</html>