<!doctype html>
<html lang="tl" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-learning/courses/quantum-chem-with-vqe/ground-state" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Ground state energies | doQumentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tl.doqumentation.org/img/rasqberry-social-card.png"><meta data-rh="true" name="twitter:image" content="https://tl.doqumentation.org/img/rasqberry-social-card.png"><meta data-rh="true" property="og:url" content="https://tl.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state"><meta data-rh="true" property="og:locale" content="tl"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" property="og:locale:alternate" content="de"><meta data-rh="true" property="og:locale:alternate" content="es"><meta data-rh="true" property="og:locale:alternate" content="uk"><meta data-rh="true" property="og:locale:alternate" content="fr"><meta data-rh="true" property="og:locale:alternate" content="it"><meta data-rh="true" property="og:locale:alternate" content="pt"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" property="og:locale:alternate" content="ar"><meta data-rh="true" property="og:locale:alternate" content="he"><meta data-rh="true" property="og:locale:alternate" content="swg"><meta data-rh="true" property="og:locale:alternate" content="bad"><meta data-rh="true" property="og:locale:alternate" content="bar"><meta data-rh="true" property="og:locale:alternate" content="ksh"><meta data-rh="true" property="og:locale:alternate" content="nds"><meta data-rh="true" property="og:locale:alternate" content="gsw"><meta data-rh="true" property="og:locale:alternate" content="sax"><meta data-rh="true" property="og:locale:alternate" content="bln"><meta data-rh="true" property="og:locale:alternate" content="aut"><meta data-rh="true" name="docusaurus_locale" content="tl"><meta data-rh="true" name="docsearch:language" content="tl"><meta data-rh="true" property="og:type" content="website"><meta data-rh="true" property="og:site_name" content="doQumentation"><meta data-rh="true" name="twitter:title" content="doQumentation"><meta data-rh="true" name="twitter:description" content="Open-source frontend for IBM Quantum tutorials, courses, and documentation with live code execution."><meta data-rh="true" name="theme-color" content="#161616"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ground state energies | doQumentation"><meta data-rh="true" name="description" content="Combine the Hamiltonian, ansatz, and classical optimizer to estimate the ground state of a simple molecule."><meta data-rh="true" property="og:description" content="Combine the Hamiltonian, ansatz, and classical optimizer to estimate the ground state of a simple molecule."><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://tl.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state"><link data-rh="true" rel="alternate" href="https://doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="en"><link data-rh="true" rel="alternate" href="https://de.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="de"><link data-rh="true" rel="alternate" href="https://es.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="es"><link data-rh="true" rel="alternate" href="https://uk.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="uk"><link data-rh="true" rel="alternate" href="https://fr.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="fr"><link data-rh="true" rel="alternate" href="https://it.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="it"><link data-rh="true" rel="alternate" href="https://pt.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="pt"><link data-rh="true" rel="alternate" href="https://ja.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="ja"><link data-rh="true" rel="alternate" href="https://tl.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="tl"><link data-rh="true" rel="alternate" href="https://ar.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="ar"><link data-rh="true" rel="alternate" href="https://he.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="he"><link data-rh="true" rel="alternate" href="https://swg.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="swg"><link data-rh="true" rel="alternate" href="https://bad.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="bad"><link data-rh="true" rel="alternate" href="https://bar.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="bar"><link data-rh="true" rel="alternate" href="https://ksh.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="ksh"><link data-rh="true" rel="alternate" href="https://nds.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="nds"><link data-rh="true" rel="alternate" href="https://gsw.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="gsw"><link data-rh="true" rel="alternate" href="https://sax.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="sax"><link data-rh="true" rel="alternate" href="https://bln.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="bln"><link data-rh="true" rel="alternate" href="https://aut.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="aut"><link data-rh="true" rel="alternate" href="https://doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Quantum chemistry gamit ang VQE","item":"https://tl.doqumentation.org/learning/courses/quantum-chem-with-vqe/"},{"@type":"ListItem","position":2,"name":"Ground state energies","item":"https://tl.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state"}]}</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large">
<script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","name":"doQumentation","url":"https://doqumentation.org","logo":"https://doqumentation.org/img/logo.svg","description":"Open-source frontend for IBM Quantum tutorials, courses, and documentation with live code execution.","sameAs":["https://github.com/JanLahmann/doQumentation"]}</script>
<script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"doQumentation","description":"doQumentation adds a feature-rich, user-friendly, open-source frontend to IBM Quantum tutorials, courses, and documentation.","url":"https://doqumentation.org","isPartOf":{"@type":"WebSite","name":"doQumentation","url":"https://doqumentation.org"}}</script>
<script type="application/ld+json">{"@context":"https://schema.org","@type":"SoftwareApplication","name":"doQumentation","applicationCategory":"EducationalApplication","operatingSystem":"Web, Docker, Raspberry Pi","description":"Open-source frontend for IBM Quantum documentation with live Jupyter code execution, simulator mode, and offline support.","url":"https://doqumentation.org","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"license":"https://www.apache.org/licenses/LICENSE-2.0"}</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<script src="https://unpkg.com/thebelab@0.4.0/lib/index.js" async></script><link rel="stylesheet" href="/assets/css/styles.28eec7f1.css">
<script src="/assets/js/runtime~main.d8ec7e94.js" defer="defer"></script>
<script src="/assets/js/main.a5e97228.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Lumaktaw sa pangunahing nilalaman"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Lumaktaw sa pangunahing nilalaman</a></div><nav aria-label="Pangunahing nabigasyon" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="I-toggle ang navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="doQumentation Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="doQumentation Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">doQumentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/tutorials">Mga Tutorial</a><a class="navbar__item navbar__link" href="/guides">Mga Gabay</a><a class="navbar__item navbar__link" href="/learning/courses/basics-of-quantum-information">Mga Kurso</a><a class="navbar__item navbar__link" href="/learning/modules/computer-science">Mga Modyul</a><a href="https://quantum.cloud.ibm.com/docs/en/api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Sanggunian ng API<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link navbar-locale-dropdown"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Filipino</a><ul class="dropdown__menu"><li><a href="https://doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="https://de.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="de">Deutsch</a></li><li><a href="https://es.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="https://uk.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="uk">Українська (Ukrainian)</a></li><li><a href="https://fr.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">Français</a></li><li><a href="https://it.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="it">Italiano</a></li><li><a href="https://pt.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li><li><a href="https://ja.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語 (Japanese)</a></li><li><a href="/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="tl">Filipino</a></li><li><a href="https://ar.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">العربية (Arabic)</a></li><li><a href="https://he.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="he">עברית (Hebrew)</a></li><li><a href="https://swg.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="swg">Schwäbisch</a></li><li><a href="https://bad.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="bad">Badisch</a></li><li><a href="https://bar.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="bar">Boarisch</a></li><li><a href="https://ksh.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ksh">Kölsch</a></li><li><a href="https://nds.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="nds">Plattdüütsch</a></li><li><a href="https://gsw.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="gsw">Schwiizerdütsch</a></li><li><a href="https://sax.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="sax">Säggssch</a></li><li><a href="https://bln.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="bln">Berlinerisch</a></li><li><a href="https://aut.doqumentation.org/learning/courses/quantum-chem-with-vqe/ground-state" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="aut">Österreichisch</a></li></ul></div><a class="navbar__item navbar__link header-settings-link" aria-label="Settings" href="/jupyter-settings">Settings</a><a href="https://github.com/JanLahmann/doQumentation" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="System mode" aria-label="Magpalipat-lipat sa pagitan ng madilim at maliwanag na view (kasalukuyang System mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Maghanap" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Bumalik sa itaas" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Sidebar ng dokumentasyon" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/"><span title="Home" class="linkLabel_WmDU">Home</span></a></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/tutorials"><span title="Mga Tutorial" class="categoryLinkLabel_W154">Mga Tutorial</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga Tutorial&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/guides"><span title="Mga Gabay" class="categoryLinkLabel_W154">Mga Gabay</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga Gabay&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/learning/courses/basics-of-quantum-information"><span title="Mga Kurso" class="categoryLinkLabel_W154">Mga Kurso</span></a></div><ul class="menu__list"><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/basics-of-quantum-information"><span title="Mga pangunahing kaalaman sa quantum information" class="categoryLinkLabel_W154">Mga pangunahing kaalaman sa quantum information</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga pangunahing kaalaman sa quantum information&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/foundations-of-quantum-error-correction"><span title="Mga pundasyon ng quantum error correction" class="categoryLinkLabel_W154">Mga pundasyon ng quantum error correction</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga pundasyon ng quantum error correction&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/fundamentals-of-quantum-algorithms"><span title="Mga pangunahing kaalaman sa mga quantum algorithm" class="categoryLinkLabel_W154">Mga pangunahing kaalaman sa mga quantum algorithm</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga pangunahing kaalaman sa mga quantum algorithm&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/general-formulation-of-quantum-information"><span title="Pangkalahatang formulasyon ng quantum information" class="categoryLinkLabel_W154">Pangkalahatang formulasyon ng quantum information</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Pangkalahatang formulasyon ng quantum information&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/integrating-quantum-and-high-performance-computing"><span title="Pagsasama ng quantum at high-performance computing" class="categoryLinkLabel_W154">Pagsasama ng quantum at high-performance computing</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Pagsasama ng quantum at high-performance computing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-business-foundations"><span title="Mga pundasyon ng quantum sa negosyo" class="categoryLinkLabel_W154">Mga pundasyon ng quantum sa negosyo</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga pundasyon ng quantum sa negosyo&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/learning/courses/quantum-chem-with-vqe"><span title="Quantum chemistry gamit ang VQE" class="categoryLinkLabel_W154">Quantum chemistry gamit ang VQE</span></a><button aria-label="I-collapse ang kategorya ng sidebar na &#x27;Quantum chemistry gamit ang VQE&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/quantum-chem-with-vqe/introduction"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/quantum-chem-with-vqe/hamiltonian-construction"><span title="Hamiltonians" class="linkLabel_WmDU">Hamiltonians</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/quantum-chem-with-vqe/ansatz"><span title="Ansatz" class="linkLabel_WmDU">Ansatz</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/quantum-chem-with-vqe/classical-optimizers"><span title="Molecular geometry" class="linkLabel_WmDU">Molecular geometry</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/learning/courses/quantum-chem-with-vqe/ground-state"><span title="Ground state energies" class="linkLabel_WmDU">Ground state energies</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/quantum-chem-with-vqe/geometry"><span title="Molecular geometry" class="linkLabel_WmDU">Molecular geometry</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/quantum-chem-with-vqe/exam"><span title="Exam | Quantum chemistry with VQE" class="linkLabel_WmDU">Exam | Quantum chemistry with VQE</span></a></li></div></ul></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-computing-in-practice"><span title="Quantum computing sa kasanayan" class="categoryLinkLabel_W154">Quantum computing sa kasanayan</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Quantum computing sa kasanayan&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-diagonalization-algorithms"><span title="Mga quantum diagonalization algorithm" class="categoryLinkLabel_W154">Mga quantum diagonalization algorithm</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga quantum diagonalization algorithm&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-machine-learning"><span title="Quantum machine learning" class="categoryLinkLabel_W154">Quantum machine learning</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Quantum machine learning&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-safe-cryptography"><span title="Praktikal na panimula sa quantum-safe cryptography" class="categoryLinkLabel_W154">Praktikal na panimula sa quantum-safe cryptography</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Praktikal na panimula sa quantum-safe cryptography&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/utility-scale-quantum-computing"><span title="Utility-scale quantum computing" class="categoryLinkLabel_W154">Utility-scale quantum computing</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Utility-scale quantum computing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/variational-algorithm-design"><span title="Disenyo ng variational algorithm" class="categoryLinkLabel_W154">Disenyo ng variational algorithm</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Disenyo ng variational algorithm&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div></ul></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/learning/modules/computer-science"><span title="Mga Modyul" class="categoryLinkLabel_W154">Mga Modyul</span></a></div></li></div></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Mga Kurso</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/learning/courses/quantum-chem-with-vqe"><span>Quantum chemistry gamit ang VQE</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Ground state energies</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sa pahinang ito</button></div><div class="theme-doc-markdown markdown">
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Hindi pa naisalin</div><div class="admonitionContent_BuS1"><p>Ang pahinang ito ay hindi pa naisalin. Nakikita mo ang orihinal na bersyon sa Ingles.</p></div></div>
<!-- -->
<!-- -->
<header><h1>Bringing it all together with Qiskit Runtime</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direktang link sa Summary" title="Direktang link sa Summary" translate="no">​</a></h2>
<p>Victoria Lipinska gives a final recap of what we have learned so far.</p>
<div style="margin:1rem 0"><div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:8px"><iframe src="https://video.ibm.com/embed/recorded/132414925" title="Victoria Lipinska gives an overview of what we have learned so far, combining the Hamiltonian, ansatz, and classical optimizer elements into a VQE calculation." style="position:absolute;top:0;left:0;width:100%;height:100%;border:0" allowfullscreen="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" loading="lazy"></iframe></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="references">References<a href="#references" class="hash-link" aria-label="Direktang link sa References" title="Direktang link sa References" translate="no">​</a></h3>
<p>The following articles are referenced in the above video.</p>
<ul>
<li class=""><a href="https://arxiv.org/pdf/1812.09976.pdf" target="_blank" rel="noopener noreferrer" class="">Quantum Chemistry in the Age of Quantum Computing, Cao, et al.</a></li>
<li class=""><a href="https://arxiv.org/pdf/1808.10402.pdf" target="_blank" rel="noopener noreferrer" class="">Quantum computational chemistry, McArdle, et al.</a></li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="vqe-with-qiskit-patterns">VQE with Qiskit patterns<a href="#vqe-with-qiskit-patterns" class="hash-link" aria-label="Direktang link sa VQE with Qiskit patterns" title="Direktang link sa VQE with Qiskit patterns" translate="no">​</a></h2>
<p>We have all the necessary components for a VQE calculation:</p>
<ul>
<li class="">Hamiltonian</li>
<li class="">Ansatz</li>
<li class="">Classical optimizer</li>
</ul>
<p>Now we just have to bring them together in the Qiskit patterns framework.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-1-map-classical-inputs-to-a-quantum-problem">Step 1: Map classical inputs to a quantum problem<a href="#step-1-map-classical-inputs-to-a-quantum-problem" class="hash-link" aria-label="Direktang link sa Step 1: Map classical inputs to a quantum problem" title="Direktang link sa Step 1: Map classical inputs to a quantum problem" translate="no">​</a></h2>
<p>As stated previously, we will assume here that a suitably formatted Hamiltonian of interest has already been generated. If you have questions about that, see the <a class="" href="/learning/courses/quantum-chem-with-vqe/hamiltonian-construction">lesson on Hamiltonians</a> for guidance. The code block below sets up the components explained in previous lessons. Here we have chosen to model H2 because its Hamiltonian is compact enough to write out.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># General imports</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">quantum_info </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SparsePauliOp</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Hamiltonian obtained from a previous lesson</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">H </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SparsePauliOp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;IIII&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;IIIZ&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;IZII&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;IIZI&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;ZIII&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;IZIZ&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;IIZZ&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;ZIIZ&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;IZZI&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;ZZII&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;ZIZI&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;YYYY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;XXYY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;YYXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;XXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    coeffs</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.09820182</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.1740751</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.1740751</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.2242933</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.2242933</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.16891402</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.1210099</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.16631441</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.16631441</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.1210099</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.17504456</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.04530451</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.04530451</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.04530451</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token number" style="color:#36acaa">0.04530451</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0j</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">nuclear_repulsion </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.7199689944489797</span></span><br></span></code></pre></div></div></div></div>
<p>We select an efficient_su2 circuit, and the optimizer COBYLA, to start.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Pre-defined ansatz circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">library </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> efficient_su2</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># SciPy minimizer routine</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> scipy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">optimize </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> minimize</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Plotting functions</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Random initial state and efficient_su2 ansatz</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ansatz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> efficient_su2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">H</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">num_qubits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> su2_gates</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;rx&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> entanglement</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;linear&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reps</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">x0 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ansatz</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">num_parameters</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ansatz</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decompose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depth</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ansatz</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decompose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">5</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="434" height="303" class="img_ev3q"></p>
<p>Now we construct our cost function. This is obviously related to the Hamiltonian, but differs in that the Hamiltonian is an operator, and we want a function that returns the expectation value of that operator, using Estimator. Of course, it accomplishes this by using the ansatz and the variational parameters, so all these show up as arguments. Below, we define slightly different versions for use on real hardware or simulators.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cost_func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ansatz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> H</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> estimator</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    pub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ansatz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">H</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pubs</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pub</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    energy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> energy</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># def cost_func_sim(params, ansatz, H, estimator):</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#    energy = estimator.run(ansatz, H, parameter_values=params).result().values[0]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#    return energy</span></span><br></span></code></pre></div></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-2-optimize-problem-for-quantum-execution">Step 2: Optimize problem for quantum execution.<a href="#step-2-optimize-problem-for-quantum-execution" class="hash-link" aria-label="Direktang link sa Step 2: Optimize problem for quantum execution." title="Direktang link sa Step 2: Optimize problem for quantum execution." translate="no">​</a></h2>
<p>We want our code to run as efficiently as possible on the hardware we use. So we must select a backend to begin the optimization step. The code below selects the least busy backend available to you.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># To run on hardware, select the backend with the fewest number of jobs in the queue</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_ibm_runtime </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> QiskitRuntimeService</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">service </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QiskitRuntimeService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">channel</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;ibm_quantum_platform&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">backend </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> service</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">least_busy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">operational</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> simulator</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span></span><br></span></code></pre></div></div></div></div>
<p>Optimizing the circuit for running on a real backend is a rich and critical topic. But it is not specific to VQE. For now, we will simply remind you of two important terms:</p>
<ul>
<li class=""><strong><a href="https://docs.quantum.ibm.com/api/qiskit/transpiler#preset-pass-managers" target="_blank" rel="noopener noreferrer" class="">optimization_level</a></strong>: This describes how well the circuit is tailored to the layout of the backend selected. The lowest optimization level just does the bare minimum needed to get the circuit running on the device; it maps the circuit qubits to the device qubits and adds swap gates to allow all two-qubit operations. The highest optimization level is much smarter and uses lots of tricks to reduce the overall gate count. Since multi-qubit gates have high error rates and qubits decohere over time, the shorter circuits should give better results.</li>
<li class=""><strong><a href="https://docs.quantum.ibm.com/api/qiskit/qiskit.transpiler.passes.PadDynamicalDecoupling" target="_blank" rel="noopener noreferrer" class="">Dynamical Decoupling</a></strong>: We can apply a sequence of gates to idling qubits. This cancels out some unwanted interactions with the environment.
Consult the linked documentation for more information on optimizing circuits. The code below generates a mass manager using preset pass managers from <code>qiskit.transpiler</code>.</li>
</ul>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transpiler </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> PassManager</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transpiler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">preset_passmanagers </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> generate_preset_pass_manager</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transpiler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">passes </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    ALAPScheduleAnalysis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    PadDynamicalDecoupling</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    ConstrainedReschedule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">library </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> XGate</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> backend</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">target</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_preset_pass_manager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> optimization_level</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">scheduling </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PassManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        ALAPScheduleAnalysis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        ConstrainedReschedule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            acquire_alignment</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">acquire_alignment</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            pulse_alignment</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pulse_alignment</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            target</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        PadDynamicalDecoupling</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            target</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            dd_sequence</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">XGate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> XGate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            pulse_alignment</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pulse_alignment</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use the pass manager and draw the resulting circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ansatz_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ansatz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ansatz_isa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> idle_wires</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> style</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;iqp&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="1633" height="315" class="img_ev3q"></p>
<p>We must similarly apply device layout characteristics to the Hamiltonian.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">hamiltonian_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> H</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ansatz_isa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">hamiltonian_isa</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SparsePauliOp([&#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIZIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIZII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIZII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYYYII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIYYXXII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXYYII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXXII&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              coeffs=[-0.09820182+0.j, -0.1740751 +0.j, -0.1740751 +0.j,  0.2242933 +0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.2242933 +0.j,  0.16891402+0.j,  0.1210099 +0.j,  0.16631441+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.16631441+0.j,  0.1210099 +0.j,  0.17504456+0.j,  0.04530451+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.04530451+0.j,  0.04530451+0.j,  0.04530451+0.j])</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-3-execute-using-qiskit-primitives">Step 3: Execute using Qiskit Primitives.<a href="#step-3-execute-using-qiskit-primitives" class="hash-link" aria-label="Direktang link sa Step 3: Execute using Qiskit Primitives." title="Direktang link sa Step 3: Execute using Qiskit Primitives." translate="no">​</a></h2>
<p>Before we execute on the selected hardware, it is a good idea to use a simulator for cursory debugging, and sometimes for estimates of error. For those reasons, we briefly show how to run VQE on a simulator. But it is critical to note that <strong>no classical computer, simulator, or GPU</strong> can accurately simulate the full functionality of a highly-entangled 127-qubit quantum computer. In the present era of quantum utility, simulators will have limited use.</p>
<p>Recall that for each choice of parameters in the variational circuit, an expectation value must be calculated (since that is the value to be minimized). As you may have already guessed, the most efficient way to do that is using the Qiskit primitive, Estimator. We&#x27;ll start by using a local simulator, which will require that we use the local version of Estimator called BackendEstimator.</p>
<p>Keeping the real backend we used for optimization, we can import a model of the noise behavior of that device to then use with the local simulator of our choice. Here, we will use the aer_simulator_statevector.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># We will start by using a local simulator</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_aer </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> AerSimulator</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Import an estimator, this time from qiskit (we will import from Runtime for real hardware)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">primitives </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BackendEstimatorV2</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># generate a simulator that mimics the real quantum system</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">backend_sim </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AerSimulator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_backend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">estimator </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> BackendEstimatorV2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">backend</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend_sim</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>It is finally time to implement VQE, minimizing the cost function using the selected Hamiltonian, ansatz, classical optimizer, and our BackendEstimator, based on the real backend we selected for subsequent use. Note that here we have chosen a relatively small number for the maximum iterations. This is because we are merely using the simulator to debug. VQE optimization steps often require hundreds of iterations to converge.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> minimize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    cost_func</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    x0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    args</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ansatz_isa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hamiltonian_isa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> estimator</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    method</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;cobyla&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    options</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;maxiter&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;disp&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">getattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fun&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> nuclear_repulsion</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Return from COBYLA because the objective function has been evaluated MAXFUN times.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Number of function values = 10   Least value of F = -0.11556938907226563</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The corresponding X is:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4.11796514 4.52126324 0.69570423 4.12781503 6.55507846 1.80713073</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.9645473  6.23812214]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-0.8355383835212453</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> message: Return from COBYLA because the objective function has been evaluated MAXFUN times.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> success: False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  status: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     fun: -0.11556938907226563</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       x: [ 4.118e+00  4.521e+00  6.957e-01  4.128e+00  6.555e+00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            1.807e+00  9.645e-01  6.238e+00]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nfev: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   maxcv: 0.0</span><br></span></code></pre></div></div>
<p>This code evaluated correctly, though it did not converge, which we expected. We will proceed running the calculation on real hardware, and then discuss the outputs. For real backends, we will use the Qiskit Runtime Estimator. We will want to execute this inside a Qiskit Runtime session and we will generally want to specify options for that session.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_ibm_runtime </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> QiskitRuntimeService</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Session</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_ibm_runtime </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> EstimatorV2 </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> Estimator</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_ibm_runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> EstimatorOptions</span></span><br></span></code></pre></div></div></div></div>
<p>Among other things, using a session means our job will only wait in the queue once, to begin. Subsequent iterations of the classical optimizer will not be queued. In the session, we can set resilience and optimization levels. These tools are important enough that we include a brief review of each and their importance in VQE, with links to learn more:</p>
<ul>
<li class="">Runtime sessions: VQE is inherently iterative, with the classical optimizer selecting new variational parameters, and thus new gates being used, in each subsequent trial. Without using sessions, this could result in additional queue time between each trial circuit. Encapsulating the VQE calculation inside a session results in only one initial queue prior to the job&#x27;s start, but no additional queue time between variational steps. This strategy was already used in the previous lesson&#x27;s example, but may play an even more important role when varying geometry. For more about sessions, review the  <a class="" href="/guides/execution-modes">execution modes documentation</a>.</li>
<li class="">Estimator&#x27;s built-in optimization: In Estimator there are built-in options for optimizing a calculation. In many contexts (Estimator included), settings are limited to 0 and 1, with 0 indicating no optimization, and 1 (the default) indicating some optimization of your circuit to hardware selected. Some other contexts allow settings of  0, 1, 2, or 3. For more on the specific methods used in different settings, see the <a href="https://docs.quantum.ibm.com/api/qiskit-ibm-runtime/options-estimator-options" target="_blank" rel="noopener noreferrer" class="">documentation</a>. Here, we will actually set optimization to 0, and use &#x27;skip_transpilation = true&#x27;, because we have already transpiled our circuit using the pass manager above, in the optimization section.</li>
<li class="">Estimator&#x27;s built-in resilience: As with optimization, Estimator has built-in settings for resilience against errors, corresponding to different approaches to error mitigation. To learn about resilience level settings, refer to the  <a class="" href="/guides/configure-error-mitigation">documentation</a>.</li>
</ul>
<p>It is worth noting that error mitigation plays a nuanced role in the convergence of a VQE calculation. The classical optimizer is searching parameter space for those parameters that minimize the energy. When you are very far from the optimal parameters, a steep gradient may be apparent to the classical optimizer even in the presence of errors. But as the calculation converges and you approach the optimal values, the gradient becomes smaller, and more easily washed out by errors. How much error mitigation do you want to use? At what points in the convergence? These are choices you must make for your particular use case.</p>
<p>For this first hardware run, we have set resilience to 0 to facilitate a relatively fast run. For any serious application, you will want to use error mitigation. Note that in the cell below there are two sets of options: (1) options for the Runtime session, which we have named &quot;session_options&quot;, and (2) options for the classical optimizer, simply called &quot;options&quot; here.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">estimator_options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> EstimatorOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">resilience_level</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> default_shots</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> Session</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">backend</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    estimator </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Estimator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">estimator_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> minimize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        cost_func</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        x0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        args</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ansatz_isa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hamiltonian_isa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> estimator</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        method</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;cobyla&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        options</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;maxiter&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;disp&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Return from COBYLA because the objective function has been evaluated MAXFUN times.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Number of function values = 10   Least value of F = -0.11691688904</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The corresponding X is:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[5.11796514 5.52126324 0.69570423 5.12781503 6.55507846 1.80713073</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1.9645473  6.23812214]</span><br></span></code></pre></div></div>
<p>You can view the progress of your job on the IBM Quantum® Platform under <a href="https://quantum.cloud.ibm.com/workloads" target="_blank" rel="noopener noreferrer" class="">Workloads</a>.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">getattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fun&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> nuclear_repulsion</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-0.8368858834889796</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> message: Return from COBYLA because the objective function has been evaluated MAXFUN times.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> success: False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  status: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     fun: -0.11691688904</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       x: [ 5.118e+00  5.521e+00  6.957e-01  5.128e+00  6.555e+00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            1.807e+00  1.965e+00  6.238e+00]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nfev: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   maxcv: 0.0</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-4-post-process-return-result-in-classical-format">Step 4: Post-process, return result in classical format.<a href="#step-4-post-process-return-result-in-classical-format" class="hash-link" aria-label="Direktang link sa Step 4: Post-process, return result in classical format." title="Direktang link sa Step 4: Post-process, return result in classical format." translate="no">​</a></h2>
<p>Let&#x27;s take a moment to ensure we understand these outputs. The &quot;<strong>fun</strong>&quot; output is the <strong>minimum</strong> value we obtained for the cost function (not necessarily the last value calculated). This is the total energy, including the positive nuclear repulsion, which is why we also defined electron_energy.</p>
<p>In the case above, we have a message that the maximum number of function evaluations was exceeded, and that the number of function evaluations (<strong>nfev</strong>) was 10. This simply means that other criteria for convergence of the optimization were not met; in other words, there is no reason to think we found the ground state energy. This is also the meaning of <strong>success</strong> being &quot;False&quot;.</p>
<p>Finally, we have <strong>x</strong>. This is the vector of variational parameters. These are the parameters used in the calculation that yielded the minimum cost function (energy expectation value). These eight values correspond to the eight rotation angles in those gates in the ansatz that take variable rotation angles.</p>
<p>Congratulations! You have run a VQE calculation on an IBM Quantum QPU!</p>
<p>In the next lesson, we will see how to adjust this workstream to include variables in your Hamiltonian. In the context of quantum chemistry problems, this might mean varying geometry to determine shapes of molecules or binding sites.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> qiskit</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> qiskit_ibm_runtime</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">version</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_version_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">qiskit_ibm_runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">version</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_version_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2.1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0.40.1</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><div class="dq-edit-bookmark-row"><a href="https://github.com/JanLahmann/doQumentation/tree/main/docs/learning/courses/quantum-chem-with-vqe/ground-state.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>I-edit ang pahinang ito</a><button class="dq-bookmark-button" title="I-bookmark ang pahinang ito" aria-label="I-bookmark ang pahinang ito"><span class="dq-bookmark-button__icon" aria-hidden="true">☆</span>Bookmark</button></div></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Mga pahina ng dokumentasyon"><a class="pagination-nav__link pagination-nav__link--prev" href="/learning/courses/quantum-chem-with-vqe/classical-optimizers"><div class="pagination-nav__sublabel">Nakaraan</div><div class="pagination-nav__label">Molecular geometry</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/learning/courses/quantum-chem-with-vqe/geometry"><div class="pagination-nav__sublabel">Susunod</div><div class="pagination-nav__label">Molecular geometry</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a><ul><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></li><li><a href="#vqe-with-qiskit-patterns" class="table-of-contents__link toc-highlight">VQE with Qiskit patterns</a></li><li><a href="#step-1-map-classical-inputs-to-a-quantum-problem" class="table-of-contents__link toc-highlight">Step 1: Map classical inputs to a quantum problem</a></li><li><a href="#step-2-optimize-problem-for-quantum-execution" class="table-of-contents__link toc-highlight">Step 2: Optimize problem for quantum execution.</a></li><li><a href="#step-3-execute-using-qiskit-primitives" class="table-of-contents__link toc-highlight">Step 3: Execute using Qiskit Primitives.</a></li><li><a href="#step-4-post-process-return-result-in-classical-format" class="table-of-contents__link toc-highlight">Step 4: Post-process, return result in classical format.</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">doQumentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/features">Mga Tampok</a></li><li class="footer__item"><a class="footer__link-item" href="/jupyter-settings">Settings</a></li><li class="footer__item"><a href="https://github.com/JanLahmann/doQumentation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">RasQberry</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://rasqberry.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">RasQberry<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/JanLahmann/RasQberry-Two" target="_blank" rel="noopener noreferrer" class="footer__link-item">RasQberry GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">IBM Quantum &amp; Qiskit</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://quantum.cloud.ibm.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBM Quantum Platform<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://ibm.com/quantum" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBM Quantum<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://quantum.cloud.ibm.com/docs/en/guides" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dokumentasyon ng Qiskit<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/Qiskit/documentation" target="_blank" rel="noopener noreferrer" class="footer__link-item">Qiskit Docs GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://qisk.it/join-slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Qiskit Slack<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Ang nilalaman ng <a href="https://github.com/Qiskit/documentation">Dokumentasyon ng Qiskit</a> © IBM Corp. Ang code ay lisensyado sa ilalim ng Apache 2.0; ang nilalaman (mga tutorial, kurso, media) sa ilalim ng CC BY-SA 4.0.<br>Ang IBM, IBM Quantum at Qiskit ay mga tatak ng IBM Corporation.<br>Ang doQumentation ay bahagi ng proyektong <a href="https://rasqberry.org/">RasQberry</a> at hindi nauugnay, sinusuportahan, o sponsoran ng IBM Corporation.</div></div></div></footer></div>
</body>
</html>