<!doctype html>
<html lang="tl" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-learning/courses/utility-scale-quantum-computing/utility-ii" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Utility II | doQumentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tl.doqumentation.org/img/rasqberry-social-card.png"><meta data-rh="true" name="twitter:image" content="https://tl.doqumentation.org/img/rasqberry-social-card.png"><meta data-rh="true" property="og:url" content="https://tl.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii"><meta data-rh="true" property="og:locale" content="tl"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" property="og:locale:alternate" content="de"><meta data-rh="true" property="og:locale:alternate" content="es"><meta data-rh="true" property="og:locale:alternate" content="uk"><meta data-rh="true" property="og:locale:alternate" content="fr"><meta data-rh="true" property="og:locale:alternate" content="it"><meta data-rh="true" property="og:locale:alternate" content="pt"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" property="og:locale:alternate" content="ar"><meta data-rh="true" property="og:locale:alternate" content="he"><meta data-rh="true" name="docusaurus_locale" content="tl"><meta data-rh="true" name="docsearch:language" content="tl"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Utility II | doQumentation"><meta data-rh="true" name="description" content="This notebook follows the methods and techniques of lesson 7. Our goal is to numerically solve the time-dependent Schrödinger equation."><meta data-rh="true" property="og:description" content="This notebook follows the methods and techniques of lesson 7. Our goal is to numerically solve the time-dependent Schrödinger equation."><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://tl.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii"><link data-rh="true" rel="alternate" href="https://doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="en"><link data-rh="true" rel="alternate" href="https://de.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="de"><link data-rh="true" rel="alternate" href="https://es.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="es"><link data-rh="true" rel="alternate" href="https://uk.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="uk"><link data-rh="true" rel="alternate" href="https://fr.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="fr"><link data-rh="true" rel="alternate" href="https://it.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="it"><link data-rh="true" rel="alternate" href="https://pt.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="pt"><link data-rh="true" rel="alternate" href="https://ja.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="ja"><link data-rh="true" rel="alternate" href="https://tl.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="tl"><link data-rh="true" rel="alternate" href="https://ar.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="ar"><link data-rh="true" rel="alternate" href="https://he.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="he"><link data-rh="true" rel="alternate" href="https://doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Utility-scale quantum computing","item":"https://tl.doqumentation.org/learning/courses/utility-scale-quantum-computing/"},{"@type":"ListItem","position":2,"name":"Utility II","item":"https://tl.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii"}]}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<script src="https://unpkg.com/thebelab@0.4.0/lib/index.js" async></script><link rel="stylesheet" href="/assets/css/styles.9884e938.css">
<script src="/assets/js/runtime~main.81f0038b.js" defer="defer"></script>
<script src="/assets/js/main.36451ee5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Lumaktaw sa pangunahing nilalaman"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Lumaktaw sa pangunahing nilalaman</a></div><nav aria-label="Pangunahing nabigasyon" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="I-toggle ang navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="doQumentation Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="doQumentation Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">doQumentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/tutorials">Mga Tutorial</a><a class="navbar__item navbar__link" href="/guides">Mga Gabay</a><a class="navbar__item navbar__link" href="/learning/courses/basics-of-quantum-information">Mga Kurso</a><a class="navbar__item navbar__link" href="/learning/modules/computer-science">Mga Modyul</a><a href="https://quantum.cloud.ibm.com/docs/en/api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Sanggunian ng API<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link navbar-locale-dropdown"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Filipino</a><ul class="dropdown__menu"><li><a href="https://doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="https://de.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="de">Deutsch</a></li><li><a href="https://es.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="https://uk.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="uk">Українська</a></li><li><a href="https://fr.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">Français</a></li><li><a href="https://it.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="it">Italiano</a></li><li><a href="https://pt.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li><li><a href="https://ja.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="tl">Filipino</a></li><li><a href="https://ar.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">العربية</a></li><li><a href="https://he.doqumentation.org/learning/courses/utility-scale-quantum-computing/utility-ii" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="he">עברית</a></li></ul></div><a class="navbar__item navbar__link header-settings-link" aria-label="Settings" href="/jupyter-settings">Settings</a><a href="https://github.com/JanLahmann/doQumentation" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="System mode" aria-label="Magpalipat-lipat sa pagitan ng madilim at maliwanag na view (kasalukuyang System mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Maghanap" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Bumalik sa itaas" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Sidebar ng dokumentasyon" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/"><span title="Home" class="linkLabel_WmDU">Home</span></a></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/tutorials"><span title="Mga Tutorial" class="categoryLinkLabel_W154">Mga Tutorial</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga Tutorial&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/guides"><span title="Mga Gabay" class="categoryLinkLabel_W154">Mga Gabay</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga Gabay&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/learning/courses/basics-of-quantum-information"><span title="Mga Kurso" class="categoryLinkLabel_W154">Mga Kurso</span></a></div><ul class="menu__list"><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/basics-of-quantum-information"><span title="Mga pangunahing kaalaman sa quantum information" class="categoryLinkLabel_W154">Mga pangunahing kaalaman sa quantum information</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga pangunahing kaalaman sa quantum information&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/foundations-of-quantum-error-correction"><span title="Mga pundasyon ng quantum error correction" class="categoryLinkLabel_W154">Mga pundasyon ng quantum error correction</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga pundasyon ng quantum error correction&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/fundamentals-of-quantum-algorithms"><span title="Mga pangunahing kaalaman sa mga quantum algorithm" class="categoryLinkLabel_W154">Mga pangunahing kaalaman sa mga quantum algorithm</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga pangunahing kaalaman sa mga quantum algorithm&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/general-formulation-of-quantum-information"><span title="Pangkalahatang formulasyon ng quantum information" class="categoryLinkLabel_W154">Pangkalahatang formulasyon ng quantum information</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Pangkalahatang formulasyon ng quantum information&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/integrating-quantum-and-high-performance-computing"><span title="Pagsasama ng quantum at high-performance computing" class="categoryLinkLabel_W154">Pagsasama ng quantum at high-performance computing</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Pagsasama ng quantum at high-performance computing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-business-foundations"><span title="Mga pundasyon ng quantum sa negosyo" class="categoryLinkLabel_W154">Mga pundasyon ng quantum sa negosyo</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga pundasyon ng quantum sa negosyo&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-chem-with-vqe"><span title="Quantum chemistry gamit ang VQE" class="categoryLinkLabel_W154">Quantum chemistry gamit ang VQE</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Quantum chemistry gamit ang VQE&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-computing-in-practice"><span title="Quantum computing sa kasanayan" class="categoryLinkLabel_W154">Quantum computing sa kasanayan</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Quantum computing sa kasanayan&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-diagonalization-algorithms"><span title="Mga quantum diagonalization algorithm" class="categoryLinkLabel_W154">Mga quantum diagonalization algorithm</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Mga quantum diagonalization algorithm&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-machine-learning"><span title="Quantum machine learning" class="categoryLinkLabel_W154">Quantum machine learning</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Quantum machine learning&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/quantum-safe-cryptography"><span title="Praktikal na panimula sa quantum-safe cryptography" class="categoryLinkLabel_W154">Praktikal na panimula sa quantum-safe cryptography</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Praktikal na panimula sa quantum-safe cryptography&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/learning/courses/utility-scale-quantum-computing"><span title="Utility-scale quantum computing" class="categoryLinkLabel_W154">Utility-scale quantum computing</span></a><button aria-label="I-collapse ang kategorya ng sidebar na &#x27;Utility-scale quantum computing&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/introduction"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/bits-gates-and-circuits"><span title="Bits, gates, and circuits" class="linkLabel_WmDU">Bits, gates, and circuits</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/teleportation"><span title="Teleportation" class="linkLabel_WmDU">Teleportation</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/grovers-algorithm"><span title="Grover algorithm" class="linkLabel_WmDU">Grover algorithm</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/quantum-phase-estimation"><span title="Quantum phase estimation" class="linkLabel_WmDU">Quantum phase estimation</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/variational-quantum-algorithms"><span title="Variational quantum algorithms" class="linkLabel_WmDU">Variational quantum algorithms</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/quantum-simulation"><span title="Quantum simulation" class="linkLabel_WmDU">Quantum simulation</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/classical-simulation"><span title="Lesson 08 Classical simulation" class="linkLabel_WmDU">Lesson 08 Classical simulation</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/hardware"><span title="Hardware" class="linkLabel_WmDU">Hardware</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/quantum-circuit-optimization"><span title="Quantum circuit optimization" class="linkLabel_WmDU">Quantum circuit optimization</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/error-mitigation"><span title="Error mitigation" class="linkLabel_WmDU">Error mitigation</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/utility-i"><span title="Utility I" class="linkLabel_WmDU">Utility I</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/utility-ii"><span title="Utility II" class="linkLabel_WmDU">Utility II</span></a></li></div><div class="dq-sidebar-link"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/courses/utility-scale-quantum-computing/utility-iii"><span title="Utility III" class="linkLabel_WmDU">Utility III</span></a></li></div></ul></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/learning/courses/variational-algorithm-design"><span title="Disenyo ng variational algorithm" class="categoryLinkLabel_W154">Disenyo ng variational algorithm</span></a><button aria-label="I-expand ang kategorya ng sidebar na &#x27;Disenyo ng variational algorithm&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></div></ul></li></div><div class="dq-sidebar-category"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/learning/modules/computer-science"><span title="Mga Modyul" class="categoryLinkLabel_W154">Mga Modyul</span></a></div></li></div></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Mga Kurso</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/learning/courses/utility-scale-quantum-computing"><span>Utility-scale quantum computing</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Utility II</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sa pahinang ito</button></div><div class="theme-doc-markdown markdown">
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Hindi pa naisalin</div><div class="admonitionContent_BuS1"><p>Ang pahinang ito ay hindi pa naisalin. Nakikita mo ang orihinal na bersyon sa Ingles.</p></div></div>
<!-- -->
<!-- -->
<header><h1>Utility-scale experiment II</h1></header>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>tala</div><div class="admonitionContent_BuS1"><p>Yukio Kawashima (12 July 2024)</p><p><a href="https://ibm.ent.box.com/s/bipgoms7gr6b6vhkoc1uw6oi4wsanfoq" target="_blank" rel="noopener noreferrer" class="">Download the pdf</a> of the original lecture. Note that some code snippets might become deprecated since these are static images.</p><p><em>Approximate QPU time to run this experiment is 2 m 30 s.</em></p><p>(Note that this notebook used texts, illustration, and codes from a now-deprecated <a href="https://github.com/qiskit-community/qiskit-algorithms/blob/main/docs/tutorials/13_trotterQRTE.ipynb" target="_blank" rel="noopener noreferrer" class="">tutorial notebook</a> for Qiskit Algorithms.)</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-introduction-and-review-of-time-evolution">1. Introduction and review of time-evolution<a href="#1-introduction-and-review-of-time-evolution" class="hash-link" aria-label="Direktang link sa 1. Introduction and review of time-evolution" title="Direktang link sa 1. Introduction and review of time-evolution" translate="no">​</a></h2>
<p>This notebook follows the methods and techniques of lesson 7. Our goal is to numerically solve the time-dependent Schrödinger equation. As discussed in lesson 7, Trotterization consists in the successive application of a quantum gate or gates, chosen to approximate the time evolution of a system for a time slice. We repeat that discussion here for convenience. Feel free to skip to the code cells below if you have recently reviewed lesson 7.</p>
<p>Following from the Schrödinger equation, the time evolution of a system initially in the state <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>ψ</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\vert\psi(0)\rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">ψ</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)⟩</span></span></span></span> takes the form:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>ψ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">⟩</mo><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mi>H</mi><mi>t</mi></mrow></msup><mi mathvariant="normal">∣</mi><mi>ψ</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo stretchy="false">⟩</mo><mtext>,</mtext></mrow><annotation encoding="application/x-tex">\vert \psi(t) \rangle = e^{-i H t} \vert \psi(0) \rangle \text{,}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">ψ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)⟩</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">ψ</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)⟩</span><span class="mord text"><span class="mord">,</span></span></span></span></span></span>
<p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span> is the time-independent Hamiltonian governing the system. We consider a Hamiltonian that can be written as a weighted sum of Pauli terms <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><msub><mo>∑</mo><mi>j</mi></msub><msub><mi>a</mi><mi>j</mi></msub><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">H=\sum_j a_j P_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1858em;vertical-align:-0.4358em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span>, with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">P_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> representing a tensor product of Pauli terms acting on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span> qubits. In particular, these Pauli terms might commute with one another, or they might not. Given a state at time <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, how do we obtain the system&#x27;s state at a later time <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>ψ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">|\psi(t)\rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">ψ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)⟩</span></span></span></span> using a quantum computer? The exponential of an operator can be most easily understood through its Taylor series:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mi>H</mi><mi>t</mi></mrow></msup><mo>=</mo><mn>1</mn><mo>−</mo><mi>i</mi><mi>H</mi><mi>t</mi><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>H</mi><mn>2</mn></msup><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">e^{-i H t} = 1-iHt-\frac{1}{2}H^2t^2+...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.1056em"></span><span class="mord">...</span></span></span></span></span>
<p>Some very basic exponentials, like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mi>i</mi><mi>Z</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{iZ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">Z</span></span></span></span></span></span></span></span></span></span></span></span> can be implemented easily on quantum computers using a compact set of quantum gates. Most Hamiltonians of interest will not have just a single term, but will instead have many terms. Note what happens if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><msub><mi>H</mi><mn>1</mn></msub><mo>+</mo><msub><mi>H</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">H = H_1+H_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mi>H</mi><mi>t</mi></mrow></msup><mo>=</mo><mn>1</mn><mo>−</mo><mi>i</mi><mo stretchy="false">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo>+</mo><msub><mi>H</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>t</mi><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo>+</mo><msub><mi>H</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">e^{-i H t} = 1-i(H_1+H_2)t-\frac{1}{2}(H_1+H_2)^2t^2+...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">i</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.1056em"></span><span class="mord">...</span></span></span></span></span>
<p>When <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">H_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">H_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> commute, we have the familiar case (which is also true for numbers, and variables <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">a</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span> below):</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mi>t</mi></mrow></msup><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mi>a</mi><mi>t</mi></mrow></msup><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mi>b</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{-i (a+b) t} = e^{-i a t}e^{-i b t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">b</span><span class="mclose mtight">)</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8991em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">ia</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"> −</span><span class="mord mathnormal mtight">ib</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>But when operators do not commute, terms cannot be rearranged in the Taylor series to simplify in this way. Thus, expressing complicated Hamiltonians in quantum gates is a challenge.</p>
<p>One solution is to consider very small time <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span>, such that the first-order term in the Taylor expansion dominates. Under that assumption:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mo stretchy="false">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo>+</mo><msub><mi>H</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>t</mi></mrow></msup><mo>≈</mo><mn>1</mn><mo>−</mo><mi>i</mi><mo stretchy="false">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo>+</mo><msub><mi>H</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>t</mi><mo>≈</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>i</mi><msub><mi>H</mi><mn>1</mn></msub><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>i</mi><msub><mi>H</mi><mn>2</mn></msub><mi>t</mi><mo stretchy="false">)</mo><mo>≈</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><msub><mi>H</mi><mn>1</mn></msub><mi>t</mi></mrow></msup><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><msub><mi>H</mi><mn>2</mn></msub><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{-i (H_1+H_2) t} \approx 1-i(H_1+H_2)t \approx (1-i H_1 t)(1-i H_2 t) \approx e^{-i H_1 t}e^{-i H_2 t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">i</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8913em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>Of course, we might need to evolve our state for a longer time. That is accomplished by using many such small steps in time. This process is called Trotterization:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>ψ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">⟩</mo><mo>≈</mo><msup><mrow><mo fence="true">(</mo><munder><mo>∏</mo><mi>j</mi></munder><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><msub><mi>a</mi><mi>j</mi></msub><msub><mi>P</mi><mi>j</mi></msub><mi>t</mi><mi mathvariant="normal">/</mi><mi>r</mi></mrow></msup><mo fence="true">)</mo></mrow><mi>r</mi></msup><mi mathvariant="normal">∣</mi><mi>ψ</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo stretchy="false">⟩</mo><mtext>,</mtext></mrow><annotation encoding="application/x-tex">\vert \psi(t) \rangle \approx \left(\prod_j e^{-i a_j P_j t/r} \right)^r \vert\psi(0) \rangle \text{,}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">ψ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)⟩</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:3.2181em;vertical-align:-1.4138em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mord mathnormal mtight">t</span><span class="mord mtight">/</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size4">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.8043em"><span style="top:-4.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">ψ</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)⟩</span><span class="mord text"><span class="mord">,</span></span></span></span></span></span>
<p>Here <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi mathvariant="normal">/</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">t/r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">t</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span> is the time slice (evolution step) that we are choosing. As a result, a gate to be applied <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span> times is created. A smaller timestep leads to a more accurate approximation. However, this also leads to deeper circuits which, in practice, leads to more error accumulation (a non-negligible concern on near-term quantum devices).</p>
<p>Today, we will study the time evolution of the <a href="https://en.wikipedia.org/wiki/Ising_model" target="_blank" rel="noopener noreferrer" class="">Ising model</a> on linear lattices of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">N=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">N=6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">6</span></span></span></span> sites. These lattices consist of an array of spins <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> that interact only with their nearest neighbors. These spins can have two orientations: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>↑</mo></mrow><annotation encoding="application/x-tex">\uparrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mrel">↑</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>↓</mo></mrow><annotation encoding="application/x-tex">\downarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mrel">↓</span></span></span></span>, which correspond to a magnetization of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">+</span><span class="mord">1</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">−</span><span class="mord">1</span></span></span></span> respectively.</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo>=</mo><mo>−</mo><mi>J</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></munderover><msub><mi>Z</mi><mi>i</mi></msub><msub><mi>Z</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>h</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>X</mi><mi>i</mi></msub><mtext>,</mtext></mrow><annotation encoding="application/x-tex">H = - J \sum_{i=0}^{N-2} Z_i Z_{i+1} - h \sum_{i=0}^{N-1} X_i  \text{,}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span><span class="mbin mtight">  −</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">,</span></span></span></span></span></span>
<p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span></span></span> describes the interaction energy, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> the magnitude of an external field (in the x-direction above, but we will modify this). Let us write this expression using Pauli matrices, and considering that the external field has an angle <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span> with respect to the transversal direction,</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo>=</mo><mo>−</mo><mi>J</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></munderover><msub><mi>Z</mi><mi>i</mi></msub><msub><mi>Z</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>h</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mo stretchy="false">(</mo><mi>sin</mi><mo>⁡</mo><mi>α</mi><msub><mi>Z</mi><mi>i</mi></msub><mo>+</mo><mi>cos</mi><mo>⁡</mo><mi>α</mi><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mtext>.</mtext></mrow><annotation encoding="application/x-tex">H = -J \sum_{i=0}^{N-2} Z_i Z_{i+1} -h \sum_{i=0}^{N-1} (\sin\alpha Z_i + \cos\alpha X_i) \text{.}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord text"><span class="mord">.</span></span></span></span></span></span>
<p>This Hamiltonian is useful in that it allows us to easily study the effects of an external field. In the computational basis, the system will be encoded as follows:</p>
<table><thead><tr><th style="text-align:center">Quantum state</th><th style="text-align:center">Spin representation</th></tr></thead><tbody><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∣</mo><mn>0000</mn><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\lvert 0 0 0 0 \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">∣</span><span class="mord">0000</span><span class="mclose">⟩</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>↑</mo><mo>↑</mo><mo>↑</mo><mo>↑</mo></mrow><annotation encoding="application/x-tex">\uparrow\uparrow\uparrow\uparrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mrel">↑↑↑↑</span></span></span></span></td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∣</mo><mn>1000</mn><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\lvert 1 0 0 0 \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">∣</span><span class="mord">1000</span><span class="mclose">⟩</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>↓</mo><mo>↑</mo><mo>↑</mo><mo>↑</mo></mrow><annotation encoding="application/x-tex">\downarrow\uparrow\uparrow\uparrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mrel">↓↑↑↑</span></span></span></span></td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>…</mo></mrow><annotation encoding="application/x-tex">\ldots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.123em"></span><span class="minner">…</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>…</mo></mrow><annotation encoding="application/x-tex">\ldots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.123em"></span><span class="minner">…</span></span></span></span></td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∣</mo><mn>1111</mn><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\lvert 1 1 1 1 \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">∣</span><span class="mord">1111</span><span class="mclose">⟩</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>↓</mo><mo>↓</mo><mo>↓</mo><mo>↓</mo></mrow><annotation encoding="application/x-tex">\downarrow\downarrow\downarrow\downarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mrel">↓↓↓↓</span></span></span></span></td></tr></tbody></table>
<p>We will start investigating the time evolution of such a quantum system. More specifically, we will visualize the time-evolution of certain properties of the system like magnetization.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Check the version of Qiskit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> qiskit</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__version__</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;2.0.2&#x27;</span><br></span></code></pre></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Import the qiskit library</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> warnings</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> QuantumRegister</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">library </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> PauliEvolutionGate</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">quantum_info </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SparsePauliOp</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">synthesis </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> LieTrotter</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transpiler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">preset_passmanagers </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> generate_preset_pass_manager</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_aer </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> AerSimulator</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> qiskit_ibm_runtime </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> QiskitRuntimeService</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Estimator</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">warnings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filterwarnings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ignore&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-defining-the-transverse-field-ising-hamiltonian">2. Defining the transverse-field Ising Hamiltonian<a href="#2-defining-the-transverse-field-ising-hamiltonian" class="hash-link" aria-label="Direktang link sa 2. Defining the transverse-field Ising Hamiltonian" title="Direktang link sa 2. Defining the transverse-field Ising Hamiltonian" translate="no">​</a></h2>
<p>We here consider the 1-D transverse-field Ising model.</p>
<p>First, we will create a function that takes in the system parameters <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span>, and returns our Hamiltonian as a <code>SparsePauliOp</code>. A <a href="https://docs.quantum.ibm.com/api/qiskit/qiskit.quantum_info.SparsePauliOp" target="_blank" rel="noopener noreferrer" class="">SparsePauliOp</a> is a sparse representation of an operator in terms of weighted <a href="https://docs.quantum.ibm.com/api/qiskit/qiskit.quantum_info.Pauli" target="_blank" rel="noopener noreferrer" class="">Pauli</a> terms.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="21-activity-1">2.1 Activity 1<a href="#21-activity-1" class="hash-link" aria-label="Direktang link sa 2.1 Activity 1" title="Direktang link sa 2.1 Activity 1" translate="no">​</a></h3>
<p>Construct a function to build a transverse-field Ising Hamiltonian (see the equation above) with arguments of &quot;the number of qubits&quot;, &quot;J parameter&quot;, and &quot;h parameter&quot;. Try this on your own using previous examples. Scroll down for the solution.</p>
<p><strong>Solution:</strong></p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_hamiltonian</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nqubits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> J</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># List of Hamiltonian terms as 3-tuples containing</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (1) the Pauli string,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (2) the qubit indices corresponding to the Pauli string,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (3) the coefficient.</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    ZZ_tuples </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ZZ&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">J</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nqubits </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    X_tuples </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;X&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">h</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nqubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># We create the Hamiltonian as a SparsePauliOp, via the method</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># `from_sparse_list`, and multiply by the interaction term.</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    hamiltonian </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SparsePauliOp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_sparse_list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ZZ_tuples</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">X_tuples</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_qubits</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nqubits</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> hamiltonian</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">simplify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>We will start investigating the time evolution of a quantum system, while keeping track of magnetization.
We here compare the results of the Statevector and Matrix Product State simulators.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="define-the-hamiltonian">Define the Hamiltonian<a href="#define-the-hamiltonian" class="hash-link" aria-label="Direktang link sa Define the Hamiltonian" title="Direktang link sa Define the Hamiltonian" translate="no">​</a></h4>
<p>The system that we now consider has a size of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">N=20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">20</span></span></span></span>.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">n_qubits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">hamiltonian </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_hamiltonian</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nqubits</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">n_qubits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> J</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> h</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">hamiltonian</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SparsePauliOp([&#x27;IIIIIIIIIIIIIIIIIIZZ&#x27;, &#x27;IIIIIIIIIIIIIIIIIZZI&#x27;, &#x27;IIIIIIIIIIIIIIIIZZII&#x27;, &#x27;IIIIIIIIIIIIIIIZZIII&#x27;, &#x27;IIIIIIIIIIIIIIZZIIII&#x27;, &#x27;IIIIIIIIIIIIIZZIIIII&#x27;, &#x27;IIIIIIIIIIIIZZIIIIII&#x27;, &#x27;IIIIIIIIIIIZZIIIIIII&#x27;, &#x27;IIIIIIIIIIZZIIIIIIII&#x27;, &#x27;IIIIIIIIIZZIIIIIIIII&#x27;, &#x27;IIIIIIIIZZIIIIIIIIII&#x27;, &#x27;IIIIIIIZZIIIIIIIIIII&#x27;, &#x27;IIIIIIZZIIIIIIIIIIII&#x27;, &#x27;IIIIIZZIIIIIIIIIIIII&#x27;, &#x27;IIIIZZIIIIIIIIIIIIII&#x27;, &#x27;IIIZZIIIIIIIIIIIIIII&#x27;, &#x27;IIZZIIIIIIIIIIIIIIII&#x27;, &#x27;IZZIIIIIIIIIIIIIIIII&#x27;, &#x27;ZZIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIX&#x27;, &#x27;IIIIIIIIIIIIIIIIIIXI&#x27;, &#x27;IIIIIIIIIIIIIIIIIXII&#x27;, &#x27;IIIIIIIIIIIIIIIIXIII&#x27;, &#x27;IIIIIIIIIIIIIIIXIIII&#x27;, &#x27;IIIIIIIIIIIIIIXIIIII&#x27;, &#x27;IIIIIIIIIIIIIXIIIIII&#x27;, &#x27;IIIIIIIIIIIIXIIIIIII&#x27;, &#x27;IIIIIIIIIIIXIIIIIIII&#x27;, &#x27;IIIIIIIIIIXIIIIIIIII&#x27;, &#x27;IIIIIIIIIXIIIIIIIIII&#x27;, &#x27;IIIIIIIIXIIIIIIIIIII&#x27;, &#x27;IIIIIIIXIIIIIIIIIIII&#x27;, &#x27;IIIIIIXIIIIIIIIIIIII&#x27;, &#x27;IIIIIXIIIIIIIIIIIIII&#x27;, &#x27;IIIIXIIIIIIIIIIIIIII&#x27;, &#x27;IIIXIIIIIIIIIIIIIIII&#x27;, &#x27;IIXIIIIIIIIIIIIIIIII&#x27;, &#x27;IXIIIIIIIIIIIIIIIIII&#x27;, &#x27;XIIIIIIIIIIIIIIIIIII&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              coeffs=[-1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -1.+0.j, -1.+0.j, -1.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j])</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="set-the-parameters-of-the-time-evolution-simulation">Set the parameters of the time-evolution simulation<a href="#set-the-parameters-of-the-time-evolution-simulation" class="hash-link" aria-label="Direktang link sa Set the parameters of the time-evolution simulation" title="Direktang link sa Set the parameters of the time-evolution simulation" translate="no">​</a></h4>
<p>Here we will consider the Lie–Trotter (first order).</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">num_timesteps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolution_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">dt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> evolution_time </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> num_timesteps</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">product_formula_lt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> LieTrotter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="prepare-the-quantum-circuit-initial-state">Prepare the quantum circuit (Initial state)<a href="#prepare-the-quantum-circuit-initial-state" class="hash-link" aria-label="Direktang link sa Prepare the quantum circuit (Initial state)" title="Direktang link sa Prepare the quantum circuit (Initial state)" translate="no">​</a></h4>
<p>Create an initial state. We will start from the ground state, which is a ferromagnetic state (all up or all down). Here, we use an example of all ups (which is all &#x27;0&#x27;).</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">initial_circuit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">initial_circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">prepare_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;00000000000000000000&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Change reps and see the difference when you decompose the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">initial_circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decompose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reps</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="158" height="1333" class="img_ev3q"></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="prepare-the-quantum-circuit-2-single-circuit-for-time-evolution">Prepare the quantum circuit 2 (Single circuit for time evolution)<a href="#prepare-the-quantum-circuit-2-single-circuit-for-time-evolution" class="hash-link" aria-label="Direktang link sa Prepare the quantum circuit 2 (Single circuit for time evolution)" title="Direktang link sa Prepare the quantum circuit 2 (Single circuit for time evolution)" translate="no">​</a></h4>
<p>We here construct a circuit for a single time step using Lie–Trotter.
The Lie product formula (first order) is implemented in the <a href="https://docs.quantum.ibm.com/api/qiskit/qiskit.synthesis.LieTrotter" target="_blank" rel="noopener noreferrer" class="">LieTrotter</a> class. A first-order formula consists of the approximation stated in the introduction, where the matrix exponential of a sum is approximated by a product of matrix exponentials:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>e</mi><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>+</mo><msub><mi>H</mi><mn>2</mn></msub></mrow></msup><mo>≈</mo><msup><mi>e</mi><msub><mi>H</mi><mn>1</mn></msub></msup><msup><mi>e</mi><msub><mi>H</mi><mn>2</mn></msub></msup></mrow><annotation encoding="application/x-tex">e^{H_1+H_2} \approx e^{H_1} e^{H_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8913em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>Let us count the operations for this circuit.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">single_step_evolution_gates_lt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PauliEvolutionGate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    hamiltonian</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> synthesis</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">product_formula_lt</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">single_step_evolution_lt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">single_step_evolution_lt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    single_step_evolution_gates_lt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> single_step_evolution_lt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qubits</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&quot;&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Trotter step with Lie-Trotter</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">-----------------------------</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Depth: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">single_step_evolution_lt</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">depth</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Gate count: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">single_step_evolution_lt</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Nonlocal gate count: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">single_step_evolution_lt</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_nonlocal_gates</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Gate breakdown: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;, &quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">join</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string-interpolation interpolation">k</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation string-interpolation interpolation">upper</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation interpolation string-interpolation string" style="color:#e3116c">: </span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string-interpolation interpolation">v</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation interpolation string-interpolation string" style="color:#e3116c">&quot;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">for</span><span class="token string-interpolation interpolation"> k</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> v </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">in</span><span class="token string-interpolation interpolation"> single_step_evolution_lt</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">count_ops</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">items</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">single_step_evolution_lt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decompose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reps</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fold</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Trotter step with Lie-Trotter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Depth: 58</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gate count: 77</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nonlocal gate count: 38</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gate breakdown: CX: 38, U3: 20, U1: 19</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="/assets/images/dbc253b8-17a1-4cb7-aede-bddfa59fab8a-1-535163c519bc670426bb4a685d2a0096.avif" width="5083" height="1344" class="img_ev3q"></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="set-the-operators-to-be-measured">Set the operators to be measured<a href="#set-the-operators-to-be-measured" class="hash-link" aria-label="Direktang link sa Set the operators to be measured" title="Direktang link sa Set the operators to be measured" translate="no">​</a></h4>
<p>Let us define a <em>magnetization operator</em> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>Z</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">\sum_i Z_i  / N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span>.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">magnetization </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    SparsePauliOp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_sparse_list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_qubits</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">n_qubits</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> n_qubits</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;magnetization : &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> magnetization</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">magnetization :  SparsePauliOp([&#x27;IIIIIIIIIIIIIIIIIIIZ&#x27;, &#x27;IIIIIIIIIIIIIIIIIIZI&#x27;, &#x27;IIIIIIIIIIIIIIIIIZII&#x27;, &#x27;IIIIIIIIIIIIIIIIZIII&#x27;, &#x27;IIIIIIIIIIIIIIIZIIII&#x27;, &#x27;IIIIIIIIIIIIIIZIIIII&#x27;, &#x27;IIIIIIIIIIIIIZIIIIII&#x27;, &#x27;IIIIIIIIIIIIZIIIIIII&#x27;, &#x27;IIIIIIIIIIIZIIIIIIII&#x27;, &#x27;IIIIIIIIIIZIIIIIIIII&#x27;, &#x27;IIIIIIIIIZIIIIIIIIII&#x27;, &#x27;IIIIIIIIZIIIIIIIIIII&#x27;, &#x27;IIIIIIIZIIIIIIIIIIII&#x27;, &#x27;IIIIIIZIIIIIIIIIIIII&#x27;, &#x27;IIIIIZIIIIIIIIIIIIII&#x27;, &#x27;IIIIZIIIIIIIIIIIIIII&#x27;, &#x27;IIIZIIIIIIIIIIIIIIII&#x27;, &#x27;IIZIIIIIIIIIIIIIIIII&#x27;, &#x27;IZIIIIIIIIIIIIIIIIII&#x27;, &#x27;ZIIIIIIIIIIIIIIIIIII&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              coeffs=[0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j, 0.05+0.j])</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="perform-time-evolution-simulation">Perform time-evolution simulation<a href="#perform-time-evolution-simulation" class="hash-link" aria-label="Direktang link sa Perform time-evolution simulation" title="Direktang link sa Perform time-evolution simulation" translate="no">​</a></h4>
<p>We will monitor the magnetization (expectation value of the magnetization operator). We will use Statevector and MPS simulators and compare the results.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Step 1. Map the problem</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initiate the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initial_circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">num_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Start from the initial spin configuration</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initial_circuit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> evolved_state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Define backend (simulator)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">backend_mps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AerSimulator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">method</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;matrix_product_state&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">backend_sv </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AerSimulator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">method</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;statevector&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set Runtime Estimator</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">estimator_mps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Estimator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend_mps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">estimator_sv </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Estimator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend_sv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 2. Optimize</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set pass manager</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pm_mps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_preset_pass_manager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optimization_level</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> backend</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend_mps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pm_sv </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_preset_pass_manager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optimization_level</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> backend</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend_sv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transpile initial circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state_mps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm_mps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state_sv </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm_sv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Apply layout to the operator</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">magnetization_mps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> magnetization</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_mps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">magnetization_sv </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> magnetization</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_sv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_mps_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_sv_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 3. Run the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Estimate expectation values for t=0.0: MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator_mps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_mps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">magnetization_mps</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Get estimated expectation values: MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Collect data: MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_mps_list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Estimate expectation values for t=0.0: Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator_sv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_sv</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">magnetization_sv</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Get estimated expectation values: Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Collect data: Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_sv_list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Start time evolution</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> n </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_timesteps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 1. Map the problem</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Expand the circuit to describe delta-t</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evolved_state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">single_step_evolution_lt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> evolved_state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 2. Optimize</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Transpile the circuit: MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evolved_state_mps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm_mps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Apply the physical layout of the qubits to the operator: MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    magnetization_mps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> magnetization</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_mps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 3. Run the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Estimate expectation values at delta-t: MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    job </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator_mps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_mps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">magnetization_mps</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Get estimated expectation values: MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Collect data: MPS</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    mag_mps_list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 2. Optimize</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Transpile the circuit: Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evolved_state_sv </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm_sv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Apply the physical layout of the qubits to the operator: Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    magnetization_sv </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> magnetization</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_sv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 3. Run the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Estimate expectation values at delta-t: Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    job </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator_sv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_sv</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">magnetization_sv</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Get estimated expectation values: Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Collect data: Statevector</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    mag_sv_list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transform the list of expectation values (at each time step) to arrays</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_mps_array </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mag_mps_list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_sv_array </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mag_sv_list</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="plot-the-time-evolution-of-the-observables">Plot the time evolution of the observables<a href="#plot-the-time-evolution-of-the-observables" class="hash-link" aria-label="Direktang link sa Plot the time evolution of the observables" title="Direktang link sa Plot the time evolution of the observables" translate="no">​</a></h4>
<p>We plot the expectation values we measured against time. Confirm that the results from statevector and matrix product space simulators agree.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 4. Post-processing</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">fig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subplots</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sharex</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">times </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linspace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> evolution_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_timesteps </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># includes initial state</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    times</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mag_mps_array</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;MPS&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> marker</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> c</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;darkmagenta&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ls</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lw</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.8</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    times</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mag_sv_array</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;SV&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> marker</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> c</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;darkmagenta&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ls</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lw</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.8</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_ylabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;MPS&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_ylabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Statevector&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_xlabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Time&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">fig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">suptitle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Observable evolution&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Text(0.5, 0.98, &#x27;Observable evolution&#x27;)</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="578" height="480" class="img_ev3q"></p>
<p>We will start investigating the time evolution of a quantum system, while keeping track of properties.
We here compare the results of the Matrix Product State simulator and the actual quantum device.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="22-activity-2">2.2 Activity 2<a href="#22-activity-2" class="hash-link" aria-label="Direktang link sa 2.2 Activity 2" title="Direktang link sa 2.2 Activity 2" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="define-the-hamiltonian-1">Define the Hamiltonian<a href="#define-the-hamiltonian-1" class="hash-link" aria-label="Direktang link sa Define the Hamiltonian" title="Direktang link sa Define the Hamiltonian" translate="no">​</a></h4>
<p>The system that we now consider has a size of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>70</mn></mrow><annotation encoding="application/x-tex">N=70</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">70</span></span></span></span>. Note that the other conditions are the same from the 20-qubit problem. Try this on your own; scroll down for the solution.</p>
<p><strong>Solution:</strong></p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Set the number of qubits</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">n_qubits2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">70</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Construct the Hamiltonian by calling the function you made in Activity 1</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">hamiltonian2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_hamiltonian</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nqubits</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">n_qubits2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> J</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> h</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">hamiltonian2</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SparsePauliOp([&#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZ&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZI&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;ZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIX&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXI&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;XIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              coeffs=[-1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j, -1.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,  5.+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.+0.j,  5.+0.j,  5.+0.j])</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="23-activity-3">2.3 Activity 3<a href="#23-activity-3" class="hash-link" aria-label="Direktang link sa 2.3 Activity 3" title="Direktang link sa 2.3 Activity 3" translate="no">​</a></h3>
<p>Create an initial state. We will start from the ground state, which is a ferromagnetic state (all up or all down). Here, we use an example of all ups (which is all &#x27;0&#x27;). Try this on your own; scroll down for the solution.</p>
<p><strong>Solution:</strong></p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Initiate the (quantum)circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">initial_circuit2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_qubits2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use QuantumCircuit.prepare_state() to define the initial state</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">initial_circuit2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">prepare_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;0000000000000000000000000000000000000000000000000000000000000000000000&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Change reps and see the difference when you decompose the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">initial_circuit2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decompose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reps</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="158" height="4552" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="24-activity-4">2.4 Activity 4<a href="#24-activity-4" class="hash-link" aria-label="Direktang link sa 2.4 Activity 4" title="Direktang link sa 2.4 Activity 4" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="prepare-the-quantum-circuit-2-single-circuit-for-time-evolution-for-the-70-qubit-problem">Prepare the quantum circuit 2 (Single circuit for time evolution) for the 70-qubit problem<a href="#prepare-the-quantum-circuit-2-single-circuit-for-time-evolution-for-the-70-qubit-problem" class="hash-link" aria-label="Direktang link sa Prepare the quantum circuit 2 (Single circuit for time evolution) for the 70-qubit problem" title="Direktang link sa Prepare the quantum circuit 2 (Single circuit for time evolution) for the 70-qubit problem" translate="no">​</a></h4>
<p>We here construct a circuit for a single time step using Lie–Trotter.
Exactly as in the 20-qubit case, the Lie product formula (first order) is implemented in the <a href="https://docs.quantum.ibm.com/api/qiskit/qiskit.synthesis.LieTrotter" target="_blank" rel="noopener noreferrer" class="">LieTrotter</a> class. Again, the first-order formula consists of the approximation stated above:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>e</mi><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>+</mo><msub><mi>H</mi><mn>2</mn></msub></mrow></msup><mo>≈</mo><msup><mi>e</mi><msub><mi>H</mi><mn>1</mn></msub></msup><msup><mi>e</mi><msub><mi>H</mi><mn>2</mn></msub></msup></mrow><annotation encoding="application/x-tex">e^{H_1+H_2} \approx e^{H_1} e^{H_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8913em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>Try this yourself, building from the example of the 20-qubit case. As before, count the operations for this circuit.</p>
<p><strong>Solution:</strong></p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Construct the gates using PauliEvolutionGate()</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">single_step_evolution_gates_lt2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PauliEvolutionGate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    hamiltonian2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> synthesis</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">LieTrotter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initiate the quantum circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">single_step_evolution_lt2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_qubits2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Append the gates defined above</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">single_step_evolution_lt2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    single_step_evolution_gates_lt2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> single_step_evolution_lt2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qubits</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&quot;&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Trotter step with Lie-Trotter</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">-----------------------------</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Depth: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">single_step_evolution_lt2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">depth</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Gate count: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">single_step_evolution_lt2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Nonlocal gate count: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">single_step_evolution_lt2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_nonlocal_gates</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Gate breakdown: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;, &quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">join</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string-interpolation interpolation">k</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation string-interpolation interpolation">upper</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation interpolation string-interpolation string" style="color:#e3116c">: </span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string-interpolation interpolation">v</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation interpolation string-interpolation string" style="color:#e3116c">&quot;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">for</span><span class="token string-interpolation interpolation"> k</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> v </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">in</span><span class="token string-interpolation interpolation"> single_step_evolution_lt2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">count_ops</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">items</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">single_step_evolution_lt2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decompose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reps</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fold</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Trotter step with Lie-Trotter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Depth: 208</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gate count: 277</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nonlocal gate count: 138</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gate breakdown: CX: 138, U3: 70, U1: 69</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="/assets/images/4f3385fc-d214-4405-8e37-eefe45cee98c-1-8cdbf513a36ed5f466807f4fbd95843c.avif" width="17960" height="4563" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="25-activity-5">2.5 Activity 5<a href="#25-activity-5" class="hash-link" aria-label="Direktang link sa 2.5 Activity 5" title="Direktang link sa 2.5 Activity 5" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="set-the-operators-to-be-measured-1">Set the operators to be measured<a href="#set-the-operators-to-be-measured-1" class="hash-link" aria-label="Direktang link sa Set the operators to be measured" title="Direktang link sa Set the operators to be measured" translate="no">​</a></h4>
<p>We define a <em>magnetization operator</em> exactly analogous to the one from the 20-qubit case: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>Z</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">\sum_i Z_i  / N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span>. Try this yourself by modifying the 20-qubit solution.</p>
<p><strong>Solution:</strong></p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Define the magnetization operator in SparsePauliOp</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">magnetization2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    SparsePauliOp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_sparse_list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_qubits2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_qubits</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">n_qubits2</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> n_qubits2</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;magnetization : &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> magnetization2</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">magnetization :  SparsePauliOp([&#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZ&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZI&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IIZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;IZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;, &#x27;ZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              coeffs=[0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j, 0.01428571+0.j,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0.01428571+0.j, 0.01428571+0.j])</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="26-activity-6">2.6 Activity 6<a href="#26-activity-6" class="hash-link" aria-label="Direktang link sa 2.6 Activity 6" title="Direktang link sa 2.6 Activity 6" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="perform-time-evolution-simulation-1">Perform time-evolution simulation<a href="#perform-time-evolution-simulation-1" class="hash-link" aria-label="Direktang link sa Perform time-evolution simulation" title="Direktang link sa Perform time-evolution simulation" translate="no">​</a></h4>
<p>We will monitor the magnetization (expectation value of the magnetization operator). We will use the MPS simulator to get the reference value to compare the results computed from the hardware. You have used the MPS simulator before in this tutorial. Modify that example where necessary to fit this new calculation.</p>
<p><strong>Solution:</strong></p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Step 1. Map the problem</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initiate the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initial_circuit2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">num_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Start from the initial spin configuration</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initial_circuit2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> evolved_state2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Define backend (MPs simulator)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">backend_mps2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AerSimulator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">method</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;matrix_product_state&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initiate Runtime Estimator</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">estimator_mps2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Estimator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend_mps2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 2. Optimize</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initiate pass manager</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pm_mps2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_preset_pass_manager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optimization_level</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> backend</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend_mps2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transpile</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state_mps2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm_mps2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Apply qubit layout to the observable to measure</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">magnetization_mps2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> magnetization2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_mps2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initiate list</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_mps_list2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 3. Run the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Estimate expectation values for t=0.0</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator_mps2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_mps2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">magnetization_mps2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Get estimated expectation values</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Append to list</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_mps_list2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Start time evolution</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> n </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_timesteps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 1. Map the problem</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Expand the circuit to describe delta-t</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evolved_state2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">single_step_evolution_lt2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> evolved_state2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 2. Optimize</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Transpile the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evolved_state_mps2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pm_mps2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Apply the physical layout of the qubits to the operator</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    magnetization_mps2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> magnetization2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_mps2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 3. Run the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Estimate expectation values at delta-t</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    job </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator_mps2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_mps2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">magnetization_mps2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Get estimated expectation values</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Append to list</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    mag_mps_list2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transform the list of expectation values (at each time step) to arrays</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_mps_array2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mag_mps_list2</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>As in all previous lessons, we will implement the Qiskit patterns framework. The lesson up to this point has been focused on creating the correct quantum circuits to describe our problem. This is effectively Step 1.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-2-optimize-for-target-hardware">Step 2: Optimize for target hardware<a href="#step-2-optimize-for-target-hardware" class="hash-link" aria-label="Direktang link sa Step 2: Optimize for target hardware" title="Direktang link sa Step 2: Optimize for target hardware" translate="no">​</a></h4>
<p>We start by defining the target backend.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">service </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QiskitRuntimeService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">backend </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> service</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">least_busy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">operational</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> simulator</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;ibm_kingston&#x27;</span><br></span></code></pre></div></div>
<p>We transpile the circuits and gather them in a list. This might take a few minutes.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pm_hw </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_preset_pass_manager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optimization_level</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> backend</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">circuit_isa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 1. Map the problem</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state_hw </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initial_circuit2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">num_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state_hw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initial_circuit2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> evolved_state_hw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 2. Optimize</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">circuit_isa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pm_hw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_hw</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> n </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_timesteps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 1. Map the problem</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evolved_state_hw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">single_step_evolution_lt2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> evolved_state_hw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 2. Optimize</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    circuit_isa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pm_hw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_hw</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-3-execute-on-target-hardware">Step 3: Execute on target hardware<a href="#step-3-execute-on-target-hardware" class="hash-link" aria-label="Direktang link sa Step 3: Execute on target hardware" title="Direktang link sa Step 3: Execute on target hardware" translate="no">​</a></h4>
<p>We will define the Runtime Estimator and construct the list of PUBs. We must also apply the layout to the operators to be measured.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Step 2. Optimize</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">estimator_hw </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Estimator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pub_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> circuit </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> circuit_isa</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    temp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> magnetization2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    pub_list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>We are now ready to run the job.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator_hw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pub_list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">job_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">job_id</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">d147hfdqf56g0081sxs0</span><br></span></code></pre></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># check job status</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;DONE&#x27;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-4-post-process-results">Step 4: Post-process results<a href="#step-4-post-process-results" class="hash-link" aria-label="Direktang link sa Step 4: Post-process results" title="Direktang link sa Step 4: Post-process results" translate="no">​</a></h4>
<p>We will first get the results.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> service</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">job</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">job_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pub_result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>Now we must extract the expectation values from these results.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_hw_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> res </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> pub_result</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    mag_hw_list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>We will use this for comparison below. First, let us see if we can optimize our circuits even further.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-solution-using-a-real-quantum-computer-ii">3. Solution using a real quantum computer II<a href="#3-solution-using-a-real-quantum-computer-ii" class="hash-link" aria-label="Direktang link sa 3. Solution using a real quantum computer II" title="Direktang link sa 3. Solution using a real quantum computer II" translate="no">​</a></h2>
<p>Let us return to Qiskit patterns step 1, and see if we can reduce the depth of our circuit.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="31-step-1-map-the-problem-to-quantum-circuits-and-operators">3.1 Step 1. Map the problem to quantum circuits and operators<a href="#31-step-1-map-the-problem-to-quantum-circuits-and-operators" class="hash-link" aria-label="Direktang link sa 3.1 Step 1. Map the problem to quantum circuits and operators" title="Direktang link sa 3.1 Step 1. Map the problem to quantum circuits and operators" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="activity-7">Activity 7<a href="#activity-7" class="hash-link" aria-label="Direktang link sa Activity 7" title="Direktang link sa Activity 7" translate="no">​</a></h4>
<p>Construct a time-evolution circuit. Use your knowledge from previous lessons to try to reduce the depth of the circuit.</p>
<p><strong>Solution:</strong></p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># Define J</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">J </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Define h</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">h </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5.0</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create instruction for rotation around ZZ:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initiate the circuit (use 2 qubits)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Rzz_circ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add Rzz gate (do not forget to multiply the angle by 2.0)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Rzz_circ</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">J </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> dt </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transform the QuantumCircuit to instruction (QuantumCircuit.to_instruction())</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Rzz_instr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Rzz_circ</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_instruction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">label</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;RZZ&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create instruction for rotation around X:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initiate the circuit (use 1 qubit)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Rx_circ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add Rx gate (do not forget to multiply the angle by 2.0)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Rx_circ</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rx</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">h </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> dt </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transform the QuantumCircuit to instruction (QuantumCircuit.to_instruction())</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Rx_instr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Rx_circ</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_instruction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">label</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;RX&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Define the interaction list</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">interaction_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_qubits2 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_qubits2 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># linear chain</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Define the registers</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">qr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumRegister</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_qubits2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initiate the circuit</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">single_step_evolution_sh </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">qr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Construct the Rzz gates</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">interaction_list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> interaction </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        single_step_evolution_sh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Rzz_instr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> interaction</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Construct the Rx gates</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_qubits2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    single_step_evolution_sh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Rx_instr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&quot;&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Trotter step with Lie-Trotter</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">-----------------------------</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Depth: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">single_step_evolution_sh</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">depth</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Gate count: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">single_step_evolution_sh</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Nonlocal gate count: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">single_step_evolution_sh</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">num_nonlocal_gates</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">Gate breakdown: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;, &quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">join</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string-interpolation interpolation">k</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation string-interpolation interpolation">upper</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation interpolation string-interpolation string" style="color:#e3116c">: </span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string-interpolation interpolation">v</span><span class="token string-interpolation interpolation string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation interpolation string-interpolation string" style="color:#e3116c">&quot;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">for</span><span class="token string-interpolation interpolation"> k</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> v </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">in</span><span class="token string-interpolation interpolation"> single_step_evolution_sh</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">decompose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">reps</span><span class="token string-interpolation interpolation operator" style="color:#393A34">=</span><span class="token string-interpolation interpolation number" style="color:#36acaa">3</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">count_ops</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">items</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token string-interpolation string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">single_step_evolution_sh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decompose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reps</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mpl&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Trotter step with Lie-Trotter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Depth: 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gate count: 277</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nonlocal gate count: 138</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gate breakdown: CX: 138, U3: 70, U1: 69</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="/assets/images/769902d2-acce-4252-8c44-cba3cc0f9be5-1-8d224afb6496c4d361c07cb6668f51f6.avif" width="591" height="4552" class="img_ev3q"></p>
<p>This was very successful. We can now proceed with the remaining Qiskit patterns steps.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="32-step-2-optimize-for-target-hardware">3.2 Step 2. Optimize for target hardware<a href="#32-step-2-optimize-for-target-hardware" class="hash-link" aria-label="Direktang link sa 3.2 Step 2. Optimize for target hardware" title="Direktang link sa 3.2 Step 2. Optimize for target hardware" translate="no">​</a></h3>
<p>Transpile the circuits and gather them in a list. Once again, this might take a few minutes.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pm_hw2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_preset_pass_manager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">backend</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> optimization_level</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">circuit_isa2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 1. Map the problem</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state_hw2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> QuantumCircuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initial_circuit2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">num_qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">evolved_state_hw2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initial_circuit2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> evolved_state_hw2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 2. Optimize</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">circuit_isa2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pm_hw2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_hw2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> n </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_timesteps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 1. Map the problem</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evolved_state_hw2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">single_step_evolution_sh</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> evolved_state_hw2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qubits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Step 2. Optimize</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    circuit_isa2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pm_hw2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evolved_state_hw2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>Define the Runtime Estimator and construct the list of PUBs.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">estimator_hw2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Estimator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pub_list2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> circuit </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> circuit_isa2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    temp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> magnetization2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">circuit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    pub_list2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="33-step-3-execute-on-target-hardware">3.3 Step 3. Execute on target hardware<a href="#33-step-3-execute-on-target-hardware" class="hash-link" aria-label="Direktang link sa 3.3 Step 3. Execute on target hardware" title="Direktang link sa 3.3 Step 3. Execute on target hardware" translate="no">​</a></h3>
<p>Run the job.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> estimator_hw2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pub_list2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job2_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">job_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">job2_id</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">d147qqeqf56g0081sye0</span><br></span></code></pre></div></div>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:#999988;font-style:italic"># check job status</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;DONE&#x27;</span><br></span></code></pre></div></div>
<p>Get the results.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">job2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> service</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">job</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">job2_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pub_result2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> job2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="34-step-4-post-processing">3.4 Step 4. Post-processing<a href="#34-step-4-post-processing" class="hash-link" aria-label="Direktang link sa 3.4 Step 4. Post-processing" title="Direktang link sa 3.4 Step 4. Post-processing" translate="no">​</a></h3>
<p>Extract the expectation values from the results.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_hw_list2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> res </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> pub_result2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    evs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evs</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    mag_hw_list2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evs</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>Transform the list into numpy arrays for plotting.</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_hw_array </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mag_hw_list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">mag_hw_array2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mag_hw_list2</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<p>Now let us plot the results and compare the hardware (default and shallow circuit) results with the MPS simulator. How does the error in the real hardware influence the results?</p>
<div class="executable-code"><div class="executable-code__code" style="display:block"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">fig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subplots</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sharex</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">times </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linspace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> evolution_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_timesteps </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># includes initial state</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    times</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mag_mps_array2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;MPS&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> marker</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> c</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;darkmagenta&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ls</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lw</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.8</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    times</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mag_hw_array</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;HW&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> marker</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> c</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;darkmagenta&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ls</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lw</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.8</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    times</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mag_hw_array2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;HW2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> marker</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> c</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;darkmagenta&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ls</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lw</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.8</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_ylabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;MPS&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_ylabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;HW&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_ylabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;HW2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_xlabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Time&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">fig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">suptitle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Observable evolution&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Text(0.5, 0.98, &#x27;Observable evolution&#x27;)</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Output of the previous code cell" src="data:image/avif;base64,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" width="554" height="480" class="img_ev3q"></p>
<p>Congratulations! You have moved one step further in your utility-scale quantum journey. There is only one lesson left!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><div class="dq-edit-bookmark-row"><a href="https://github.com/JanLahmann/doQumentation/tree/main/docs/learning/courses/utility-scale-quantum-computing/utility-ii.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>I-edit ang pahinang ito</a><button class="dq-bookmark-button" title="Bookmark this page" aria-label="Bookmark this page"><span class="dq-bookmark-button__icon" aria-hidden="true">☆</span>Bookmark</button></div></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Mga pahina ng dokumentasyon"><a class="pagination-nav__link pagination-nav__link--prev" href="/learning/courses/utility-scale-quantum-computing/utility-i"><div class="pagination-nav__sublabel">Nakaraan</div><div class="pagination-nav__label">Utility I</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/learning/courses/utility-scale-quantum-computing/utility-iii"><div class="pagination-nav__sublabel">Susunod</div><div class="pagination-nav__label">Utility III</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-introduction-and-review-of-time-evolution" class="table-of-contents__link toc-highlight">1. Introduction and review of time-evolution</a></li><li><a href="#2-defining-the-transverse-field-ising-hamiltonian" class="table-of-contents__link toc-highlight">2. Defining the transverse-field Ising Hamiltonian</a><ul><li><a href="#21-activity-1" class="table-of-contents__link toc-highlight">2.1 Activity 1</a></li><li><a href="#22-activity-2" class="table-of-contents__link toc-highlight">2.2 Activity 2</a></li><li><a href="#23-activity-3" class="table-of-contents__link toc-highlight">2.3 Activity 3</a></li><li><a href="#24-activity-4" class="table-of-contents__link toc-highlight">2.4 Activity 4</a></li><li><a href="#25-activity-5" class="table-of-contents__link toc-highlight">2.5 Activity 5</a></li><li><a href="#26-activity-6" class="table-of-contents__link toc-highlight">2.6 Activity 6</a></li></ul></li><li><a href="#3-solution-using-a-real-quantum-computer-ii" class="table-of-contents__link toc-highlight">3. Solution using a real quantum computer II</a><ul><li><a href="#31-step-1-map-the-problem-to-quantum-circuits-and-operators" class="table-of-contents__link toc-highlight">3.1 Step 1. Map the problem to quantum circuits and operators</a></li><li><a href="#32-step-2-optimize-for-target-hardware" class="table-of-contents__link toc-highlight">3.2 Step 2. Optimize for target hardware</a></li><li><a href="#33-step-3-execute-on-target-hardware" class="table-of-contents__link toc-highlight">3.3 Step 3. Execute on target hardware</a></li><li><a href="#34-step-4-post-processing" class="table-of-contents__link toc-highlight">3.4 Step 4. Post-processing</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">doQumentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/features">Mga Tampok</a></li><li class="footer__item"><a class="footer__link-item" href="/jupyter-settings">Settings</a></li><li class="footer__item"><a href="https://github.com/JanLahmann/doQumentation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">RasQberry</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://rasqberry.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">RasQberry<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/JanLahmann/RasQberry-Two" target="_blank" rel="noopener noreferrer" class="footer__link-item">RasQberry GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">IBM Quantum &amp; Qiskit</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://quantum.cloud.ibm.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBM Quantum<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://quantum.cloud.ibm.com/docs/en/guides" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dokumentasyon ng Qiskit<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/Qiskit/documentation" target="_blank" rel="noopener noreferrer" class="footer__link-item">Qiskit Docs GitHub<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://qisk.it/join-slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Qiskit Slack<svg width="13.5" height="13.5" aria-label="(magbubukas sa bagong tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Ang nilalaman ng <a href="https://github.com/Qiskit/documentation">Dokumentasyon ng Qiskit</a> © IBM Corp. Ang code ay lisensyado sa ilalim ng Apache 2.0; ang nilalaman (mga tutorial, kurso, media) sa ilalim ng CC BY-SA 4.0.<br>Ang IBM, IBM Quantum at Qiskit ay mga tatak ng IBM Corporation.<br>Ang doQumentation ay bahagi ng proyektong <a href="https://rasqberry.org/">RasQberry</a> at hindi nauugnay, sinusuportahan, o sponsoran ng IBM Corporation.</div></div></div></footer></div>
</body>
</html>